<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.6.0" />
  <title></title>
</head>
<body>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fabs%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20dp%3Dkind%280%2E0d0%29%0D%0A%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%20%3D%20%2D1%0D%0A%20%20%20%20%20%20real%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20x%20%3D%20%2D1%2E0%0D%0A%20%20%20%20%20%20complex%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20z%20%3D%20%28%2D3%2E0%2C%2D4%2E0%29%0D%0A%20%20%20%20%20%20doubleprecision%20%20%20%3A%3A%20rr%20%3D%20%2D45%2E78%5Fdp%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%20%20%21%20some%20formats%0D%0A%20%20%20%20%20%20%20%20%20frmt%20%20%3D%20%20%27%281x%2Ca15%2C1x%2C%22%20In%3A%20%22%2Cg0%2C%20%20%20%20%20%20%20%20%20%20%20%20T51%2C%22%20Out%3A%20%22%2Cg0%29%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20frmtc%20%3D%20%27%281x%2Ca15%2C1x%2C%22%20In%3A%20%28%22%2Cg0%2C%22%2C%22%2Cg0%2C%22%29%22%2CT51%2C%22%20Out%3A%20%22%2Cg0%29%27%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20g%20%20%20%20%20%3D%20%27%28%2A%28g0%2C1x%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20any%20integer%2C%20real%2C%20or%20complex%20type%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20frmt%29%20%20%27integer%20%20%20%20%20%20%20%20%20%27%2C%20%20i%2C%20abs%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20frmt%29%20%20%27real%20%20%20%20%20%20%20%20%20%20%20%20%27%2C%20%20x%2C%20abs%28x%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20frmt%29%20%20%27doubleprecision%20%27%2C%20rr%2C%20abs%28rr%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20frmtc%29%20%27complex%20%20%20%20%20%20%20%20%20%27%2C%20%20z%2C%20abs%28z%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20You%20can%20take%20the%20absolute%20value%20of%20any%20value%20whose%20positive%20value%0D%0A%20%20%20%20%20%20%20%20%21%20is%20representable%20with%20the%20same%20type%20and%20kind%2E%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%20%27abs%20range%20test%20%3A%20%27%2C%20abs%28huge%280%29%29%2C%20abs%28%2Dhuge%280%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%20%27abs%20range%20test%20%3A%20%27%2C%20abs%28huge%280%2E0%29%29%2C%20abs%28%2Dhuge%280%2E0%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%20%27abs%20range%20test%20%3A%20%27%2C%20abs%28tiny%280%2E0%29%29%2C%20abs%28%2Dtiny%280%2E0%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20A%20dusty%20corner%20is%20that%20abs%28%2Dhuge%280%29%2D1%29%20of%20an%20integer%20would%20be%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20a%20representable%20negative%20value%20on%20most%20machines%20but%20result%20in%20a%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20positive%20value%20out%20of%20range%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20g%29%20%27%20abs%20is%20elemental%3A%27%2C%20abs%28%5B20%2C%20%200%2C%20%20%2D1%2C%20%20%2D3%2C%20%20100%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20COMPLEX%20input%20produces%20REAL%20output%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20g%29%27%20complex%20input%20produces%20real%20output%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20abs%28cmplx%2830%2E0%5Fdp%2C40%2E0%5Fdp%2Ckind%3Ddp%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20dusty%20corner%3A%20%22kind%3Ddp%22%20is%20required%20or%20the%20value%20returned%20by%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20CMPLX%28%29%20is%20a%20default%20real%20instead%20of%20double%20precision%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20the%20returned%20value%20for%20complex%20input%20can%20be%20thought%20of%20as%20the%0D%0A%20%20%20%20%20%20%20%20%21%20distance%20from%20the%20origin%20%3C0%2C0%3E%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20g%29%20%27%20distance%20of%20%28%27%2C%20z%2C%20%27%29%20from%20zero%20is%27%2C%20abs%28%20z%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20g%29%20%27%20so%20beware%20of%20overflow%20with%20complex%20values%27%0D%0A%20%20%20%20%20%20%20%20%20%20%21write%28%2A%2C%20g%29%20abs%28cmplx%28%20huge%280%2E0%29%2C%20huge%280%2E0%29%20%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20g%29%20%27%20because%20the%20biggest%20default%20real%20is%27%2Chuge%280%2E0%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fabs%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> abs
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_abs
      implicit none
      integer,parameter :: dp=kind(0.0d0)

      integer           :: i = -1
      real              :: x = -1.0
      complex           :: z = (-3.0,-4.0)
      doubleprecision   :: rr = -45.78_dp

      character(len=*),parameter :: &
         ! some formats
         frmt  =  '(1x,a15,1x," In: ",g0,            T51," Out: ",g0)', &
         frmtc = '(1x,a15,1x," In: (",g0,",",g0,")",T51," Out: ",g0)',  &
         g     = '(*(g0,1x))'

        ! basic usage
          ! any integer, real, or complex type
          write(*, frmt)  'integer         ',  i, abs(i)
          write(*, frmt)  'real            ',  x, abs(x)
          write(*, frmt)  'doubleprecision ', rr, abs(rr)
          write(*, frmtc) 'complex         ',  z, abs(z)

        ! You can take the absolute value of any value whose positive value
        ! is representable with the same type and kind.
          write(*, *) 'abs range test : ', abs(huge(0)), abs(-huge(0))
          write(*, *) 'abs range test : ', abs(huge(0.0)), abs(-huge(0.0))
          write(*, *) 'abs range test : ', abs(tiny(0.0)), abs(-tiny(0.0))
          ! A dusty corner is that abs(-huge(0)-1) of an integer would be
          ! a representable negative value on most machines but result in a
          ! positive value out of range.

        ! elemental
          write(*, g) ' abs is elemental:', abs([20,  0,  -1,  -3,  100])

        ! COMPLEX input produces REAL output
          write(*, g)' complex input produces real output', &
          & abs(cmplx(30.0_dp,40.0_dp,kind=dp))
          ! dusty corner: "kind=dp" is required or the value returned by
          ! CMPLX() is a default real instead of double precision

        ! the returned value for complex input can be thought of as the
        ! distance from the origin <0,0>
          write(*, g) ' distance of (', z, ') from zero is', abs( z )
          write(*, g) ' so beware of overflow with complex values'
          !write(*, g) abs(cmplx( huge(0.0), huge(0.0) ))
          write(*, g) ' because the biggest default real is',huge(0.0)

      end program demo_abs
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fachar%0D%0A%20%20%20%20%20%20use%2Cintrinsic%3A%3Aiso%5Ffortran%5Fenv%2Conly%3Aint8%2Cint16%2Cint32%2Cint64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20i%3D65%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22decimal%20%20%20%20%20%3D%22%2Ci0%29%27%29i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22character%20%20%20%3D%22%2Ca1%29%27%29achar%28i%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22binary%20%20%20%20%20%20%3D%22%2Cb0%29%27%29achar%28i%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22octal%20%20%20%20%20%20%20%3D%22%2Co0%29%27%29achar%28i%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22hexadecimal%20%3D%22%2Cz0%29%27%29achar%28i%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%288%28i3%2C1x%2Ca%2C1x%29%2C%2F%29%27%29%28i%2Cachar%28i%29%2C%20i%3D32%2C126%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29upper%28%27Mixed%20Case%27%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%20a%20classic%20use%20of%20achar%283%29%20is%20to%20convert%20the%20case%20of%20a%20string%0D%0A%0D%0A%20%20%20%20%20%20pure%20elemental%20function%20upper%28str%29%20result%20%28string%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%24%40%28%23%29%20upper%283f%29%3A%20function%20to%20return%20a%20trimmed%20uppercase%2Donly%20string%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20input%20string%20to%20convert%20to%20all%20uppercase%0D%0A%20%20%20%20%20%20character%28%2A%29%2C%20intent%28in%29%20%20%20%20%20%20%3A%3A%20str%0D%0A%20%20%20%20%20%20%21%20output%20string%20that%20contains%20no%20miniscule%20letters%0D%0A%20%20%20%20%20%20character%28len%28str%29%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20string%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%2C%20iend%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20toupper%20%3D%20iachar%28%27A%27%29%2Diachar%28%27a%27%29%0D%0A%20%20%20%20%20%20%20%20%20iend%3Dlen%5Ftrim%28str%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20initialize%20output%20string%20to%20trimmed%20input%20string%0D%0A%20%20%20%20%20%20%20%20%20string%20%3D%20str%28%3Aiend%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20process%20each%20letter%20in%20the%20string%0D%0A%20%20%20%20%20%20%20%20%20do%20concurrent%20%28i%20%3D%201%3Aiend%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20select%20case%20%28str%28i%3Ai%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20located%20miniscule%20letter%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20case%20%28%27a%27%3A%27z%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20change%20miniscule%20to%20majuscule%20letter%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20string%28i%3Ai%29%20%3D%20achar%28iachar%28str%28i%3Ai%29%29%2Btoupper%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20end%20function%20upper%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fachar%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> achar
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_achar
      use,intrinsic::iso_fortran_env,only:int8,int16,int32,int64
      implicit none
      integer :: i
         i=65
         write(*,'("decimal     =",i0)')i
         write(*,'("character   =",a1)')achar(i)
         write(*,'("binary      =",b0)')achar(i)
         write(*,'("octal       =",o0)')achar(i)
         write(*,'("hexadecimal =",z0)')achar(i)

         write(*,'(8(i3,1x,a,1x),/)')(i,achar(i), i=32,126)

         write(*,'(a)')upper('Mixed Case')
      contains
      ! a classic use of achar(3) is to convert the case of a string

      pure elemental function upper(str) result (string)
      !
      !$@(#) upper(3f): function to return a trimmed uppercase-only string
      !
      ! input string to convert to all uppercase
      character(*), intent(in)      :: str
      ! output string that contains no miniscule letters
      character(len(str))           :: string
      integer                       :: i, iend
      integer,parameter             :: toupper = iachar('A')-iachar('a')
         iend=len_trim(str)
         ! initialize output string to trimmed input string
         string = str(:iend)
         ! process each letter in the string
         do concurrent (i = 1:iend)
             select case (str(i:i))
             ! located miniscule letter
             case ('a':'z')
                ! change miniscule to majuscule letter
                string(i:i) = achar(iachar(str(i:i))+toupper)
             end select
         enddo
      end function upper
      end program demo_achar
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Facos%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2Creal32%2Creal64%2Creal128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%2C%20d2r%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%20x%20%3D%200%2E866%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%27acos%28%27%2Cx%2C%27%29%20is%20%27%2C%20acos%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20acos%28%2D1%29%20should%20be%20PI%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%27for%20reference%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26PI%20%7E%3D%203%2E14159265358979323846264338327950288419716939937510%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20acos%28%2D1%2E0%5Freal64%29%0D%0A%20%20%20%20%20%20%20%20%20%20d2r%3Dacos%28%2D1%2E0%5Freal64%29%2F180%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%2790%20degrees%20is%20%27%2C%20d2r%2A90%2E0%5Freal64%2C%20%27%20radians%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%27elemental%27%2Cacos%28%5B%2D1%2E0%2C%2D0%2E5%2C0%2E0%2C0%2E50%2C1%2E0%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20complex%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27complex%27%2Cacos%28%20%28%2D1%2E0%2C%20%200%2E0%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27complex%27%2Cacos%28%20%28%2D1%2E0%2C%20%2D1%2E0%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27complex%27%2Cacos%28%20%28%200%2E0%2C%20%2D0%2E0%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27complex%27%2Cacos%28%20%28%201%2E0%2C%20%200%2E0%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Facos%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> acos
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_acos
      use, intrinsic :: iso_fortran_env, only : real_kinds,real32,real64,real128
      implicit none
      character(len=*),parameter :: all='(*(g0,1x))'
      real(kind=real64) :: x , d2r

         ! basics
          x = 0.866_real64
          print all,'acos(',x,') is ', acos(x)

         ! acos(-1) should be PI
          print all,'for reference &
          &PI ~= 3.14159265358979323846264338327950288419716939937510'
          write(*,*) acos(-1.0_real64)
          d2r=acos(-1.0_real64)/180.0_real64
          print all,'90 degrees is ', d2r*90.0_real64, ' radians'
         ! elemental
          print all,'elemental',acos([-1.0,-0.5,0.0,0.50,1.0])
         ! complex
          print *,'complex',acos( (-1.0,  0.0) )
          print *,'complex',acos( (-1.0, -1.0) )
          print *,'complex',acos( ( 0.0, -0.0) )
          print *,'complex',acos( ( 1.0,  0.0) )

      end program demo_acos
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Facosh%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%2C%20dimension%283%29%20%3A%3A%20x%20%3D%20%5B%201%2E0d0%2C%202%2E0d0%2C%203%2E0d0%20%5D%0D%0A%20%20%20%20%20%20%20%20%20if%28%20any%28x%2Elt%2E1%29%20%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20%27%20warning%3A%20values%20%3C%201%20are%20present%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20acosh%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Facosh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> acosh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_acosh
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=dp), dimension(3) :: x = [ 1.0d0, 2.0d0, 3.0d0 ]
         if( any(x.lt.1) )then
            write (*,*) ' warning: values < 1 are present'
         endif
         write (*,*) acosh(x)
      end program demo_acosh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fadjustl%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%3A%3A%20str%20%3D%20%27%20%20%20sample%20string%27%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20astr%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20length%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20use%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27original%3A%20%27%2Cstr%0D%0A%20%20%20%20%20%20%20%20%20%20str%3Dadjustl%28str%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27adjusted%3A%20%27%2Cstr%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20a%20fixed%2Dlength%20string%20can%20be%20printed%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20trimmed%20using%20trim%283f%29%20or%20len%5Ftrim%283f%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27trimmed%3A%20%20%27%2Ctrim%28str%29%0D%0A%20%20%20%20%20%20%20%20%20%20length%3Dlen%5Ftrim%28str%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27substring%3A%27%2Cstr%28%3Alength%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20note%20an%20allocatable%20string%20stays%20the%20same%20length%20too%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20and%20is%20not%20trimmed%20by%20just%20an%20adjustl%283f%29%20call%2E%0D%0A%20%20%20%20%20%20%20%20%20%20astr%3D%27%20%20%20%20allocatable%20string%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27original%3A%27%2Castr%0D%0A%20%20%20%20%20%20%20%20%20%20astr%20%3D%20adjustl%28astr%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27adjusted%3A%27%2Castr%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20trim%283f%29%20can%20be%20used%20to%20change%20the%20length%0D%0A%20%20%20%20%20%20%20%20%20%20astr%20%3D%20trim%28astr%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%27trimmed%3A%20%27%2Castr%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fadjustl%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> adjustl
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_adjustl
      implicit none
      character(len=20) :: str = '   sample string'
      character(len=:),allocatable :: astr
      integer :: length

         ! basic use
          write(*,'(a,"[",a,"]")') 'original: ',str
          str=adjustl(str)
          write(*,'(a,"[",a,"]")') 'adjusted: ',str

          ! a fixed-length string can be printed
          ! trimmed using trim(3f) or len_trim(3f)
          write(*,'(a,"[",a,"]")') 'trimmed:  ',trim(str)
          length=len_trim(str)
          write(*,'(a,"[",a,"]")') 'substring:',str(:length)

          ! note an allocatable string stays the same length too
          ! and is not trimmed by just an adjustl(3f) call.
          astr='    allocatable string   '
          write(*,'(a,"[",a,"]")') 'original:',astr
          astr = adjustl(astr)
          write(*,'(a,"[",a,"]")') 'adjusted:',astr
          ! trim(3f) can be used to change the length
          astr = trim(astr)
          write(*,'(a,"[",a,"]")') 'trimmed: ',astr

      end program demo_adjustl
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fadjustr%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%3A%3A%20str%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20a%20short%20number%20line%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29repeat%28%271234567890%27%2C2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20str%20%3D%20%27%20%20sample%20string%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20str%0D%0A%20%20%20%20%20%20%20%20%20str%20%3D%20adjustr%28str%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20str%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29repeat%28%271234567890%27%2C5%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29adjustr%28%5Bcharacter%28len%3D50%29%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%20first%20%20%20%20%20%20%20%20%20%20%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%20%20%20%20second%20%20%20%20%20%20%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%20%20%20%20%20%20%20%20third%20%20%20%20%27%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29repeat%28%271234567890%27%2C5%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fadjustr%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> adjustr
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_adjustr
      implicit none
      character(len=20) :: str
         ! print a short number line
         write(*,'(a)')repeat('1234567890',2)

        ! basic usage
         str = '  sample string '
         write(*,'(a)') str
         str = adjustr(str)
         write(*,'(a)') str

         !
         ! elemental
         !
         write(*,'(a)')repeat('1234567890',5)
         write(*,'(a)')adjustr([character(len=50) :: &
         '  first           ', &
         '     second       ', &
         '         third    ' ])
         write(*,'(a)')repeat('1234567890',5)

      end program demo_adjustr
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Faimag%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28%2A%281x%2Cg0%29%29%27%0D%0A%20%20%20%20%20%20complex%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20z4%0D%0A%20%20%20%20%20%20complex%28kind%3Dreal64%29%20%3A%3A%20z8%0D%0A%20%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%20z4%20%3D%20cmplx%281%2Ee0%2C%202%2Ee0%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27value%3D%27%2Cz4%0D%0A%20%20%20%20%20%20%20%20%20%20print%20g%2C%20%27imaginary%20part%3D%27%2Caimag%28z4%29%2C%27or%27%2C%20z4%25im%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20other%20kinds%20other%20than%20the%20default%20may%20be%20supported%0D%0A%20%20%20%20%20%20%20%20%20%20z8%20%3D%20cmplx%283%2Ee0%5Freal64%2C%204%2Ee0%5Freal64%2Ckind%3Dreal64%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27value%3D%27%2Cz8%0D%0A%20%20%20%20%20%20%20%20%20%20print%20g%2C%20%27imaginary%20part%3D%27%2Caimag%28z8%29%2C%27or%27%2C%20z8%25im%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20an%20elemental%20function%20can%20be%20passed%20an%20array%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%5Bz4%2Cz4%2F2%2E0%2Cz4%2Bz4%2Cz4%2A%2A3%5D%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20aimag%28%5Bz4%2Cz4%2F2%2E0%2Cz4%2Bz4%2Cz4%2A%2A3%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Faimag%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> aimag
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_aimag
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      character(len=*),parameter :: g='(*(1x,g0))'
      complex              :: z4
      complex(kind=real64) :: z8
         ! basics
          z4 = cmplx(1.e0, 2.e0)
          print *, 'value=',z4
          print g, 'imaginary part=',aimag(z4),'or', z4%im

          ! other kinds other than the default may be supported
          z8 = cmplx(3.e0_real64, 4.e0_real64,kind=real64)
          print *, 'value=',z8
          print g, 'imaginary part=',aimag(z8),'or', z8%im

          ! an elemental function can be passed an array
          print *
          print *, [z4,z4/2.0,z4+z4,z4**3]
          print *
          print *, aimag([z4,z4/2.0,z4+z4,z4**3])

      end program demo_aimag
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Faint%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20sp%3D%3Ereal32%2C%20dp%3D%3Ereal64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%3A%3A%20x8%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27basics%3A%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27%20just%20chops%20off%20the%20fractional%20part%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20aint%28%2D2%2E999%29%2C%20aint%28%2D2%2E1111%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27%20if%20%7Cx%7C%20%3C%201%20a%20positive%20zero%20is%20returned%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20aint%28%2D0%2E999%29%2C%20aint%28%200%2E9999%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27%20input%20may%20be%20of%20any%20real%20kind%27%0D%0A%20%20%20%20%20%20%20%20%20x8%20%3D%204%2E3210%5Fdp%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20aint%28%2Dx8%29%2C%20aint%28x8%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%3A%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Caint%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%20%2D2%2E7%2C%20%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%2D1%2E0%2C%20%2D0%2E5%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%200%2E0%2C%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%20%2B0%2E5%2C%20%20%2B1%2E0%2C%20%2B1%2E5%2C%20%2B2%2E0%2C%20%2B2%2E2%2C%20%2B2%2E5%2C%20%2B2%2E7%20%20%5D%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Faint%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> aint
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_aint
      use, intrinsic :: iso_fortran_env, only : sp=>real32, dp=>real64
      implicit none
      real(kind=dp) :: x8
         print *,'basics:'
         print *,' just chops off the fractional part'
         print *,  aint(-2.999), aint(-2.1111)
         print *,' if |x| < 1 a positive zero is returned'
         print *,  aint(-0.999), aint( 0.9999)
         print *,' input may be of any real kind'
         x8 = 4.3210_dp
         print *, aint(-x8), aint(x8)
         print *,'elemental:'
         print *,aint([ &
          &  -2.7,  -2.5, -2.2, -2.0, -1.5, -1.0, -0.5, &
          &  0.0,   &
          &  +0.5,  +1.0, +1.5, +2.0, +2.2, +2.5, +2.7  ])
      end program demo_aint
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fall%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%2Cparameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20logical%20bool%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20%21%20is%20everything%20true%3F%0D%0A%20%20%20%20%20%20%20%20%20bool%20%3D%20all%28%5B%20T%2CT%2CT%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27are%20all%20values%20true%3F%27%2C%20bool%0D%0A%20%20%20%20%20%20%20%20%20bool%20%3D%20all%28%5B%20T%2CF%2CT%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27are%20all%20values%20true%20now%3F%27%2C%20bool%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20compare%20matrices%2C%20even%20by%20a%20dimension%0D%0A%20%20%20%20%20%20%20%20%20ARRAYS%3A%20block%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20a%282%2C3%29%2C%20b%282%2C3%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20set%20everything%20to%20one%20except%20one%20value%20in%20b%0D%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%201%0D%0A%20%20%20%20%20%20%20%20%20%20b%20%3D%201%0D%0A%20%20%20%20%20%20%20%20%20%20b%282%2C2%29%20%3D%202%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20now%20compare%20those%20two%20arrays%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27entire%20array%20%3A%27%2C%20all%28a%20%3D%3D%20%20b%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27compare%20columns%3A%27%2C%20all%28a%20%3D%3D%20%20b%2C%20dim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27compare%20rows%3A%27%2C%20all%28a%20%3D%3D%20%20b%2C%20dim%3D2%29%0D%0A%20%20%20%20%20%20%20%20end%20block%20ARRAYS%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fall%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> all
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_all
      implicit none
      logical,parameter :: T=.true., F=.false.
      logical bool

        ! basic usage
         ! is everything true?
         bool = all([ T,T,T ])
         print *, 'are all values true?', bool
         bool = all([ T,F,T ])
         print *, 'are all values true now?', bool

        ! compare matrices, even by a dimension
         ARRAYS: block
         integer :: a(2,3), b(2,3)
          ! set everything to one except one value in b
          a = 1
          b = 1
          b(2,2) = 2
          ! now compare those two arrays
          print *,'entire array :', all(a ==  b )
          print *,'compare columns:', all(a ==  b, dim=1)
          print *,'compare rows:', all(a ==  b, dim=2)
        end block ARRAYS

      end program demo_all
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fallocated%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dsp%29%2C%20allocatable%20%3A%3A%20x%28%3A%29%0D%0A%20%20%20%20%20%20character%28len%3D256%29%20%3A%3A%20message%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20istat%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20if%28%20allocated%28x%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27do%20things%20if%20allocated%27%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27do%20things%20if%20not%20allocated%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20if%20already%20allocated%2C%20deallocate%0D%0A%20%20%20%20%20%20%20%20%20if%20%28%20allocated%28x%29%20%29%20deallocate%28x%2CSTAT%3Distat%2C%20ERRMSG%3Dmessage%20%29%0D%0A%20%20%20%20%20%20%20%20%20if%28istat%2Ene%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29trim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20only%20if%20not%20allocated%2C%20allocate%0D%0A%20%20%20%20%20%20%20%20%20if%20%28%20%2Enot%2E%20allocated%28x%29%20%29%20allocate%28x%2820%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20allocation%20and%20intent%28out%29%0D%0A%20%20%20%20%20%20%20%20%20call%20intentout%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27note%20it%20is%20deallocated%21%27%2Callocated%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20intentout%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20that%20if%20arr%20has%20intent%28out%29%20and%20is%20allocatable%2C%0D%0A%20%20%20%20%20%20%20%20%20%21%20arr%20is%20deallocated%20on%20entry%0D%0A%20%20%20%20%20%20%20%20%20real%28kind%3Dsp%29%2Cintent%28out%29%2Callocatable%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27note%20it%20was%20allocated%20in%20calling%20program%27%2Callocated%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%20intentout%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fallocated%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> allocated
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_allocated
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=sp), allocatable :: x(:)
      character(len=256) :: message
      integer :: istat
        ! basics
         if( allocated(x)) then
             write(*,*)'do things if allocated'
         else
             write(*,*)'do things if not allocated'
         endif

         ! if already allocated, deallocate
         if ( allocated(x) ) deallocate(x,STAT=istat, ERRMSG=message )
         if(istat.ne.0)then
            write(*,*)trim(message)
            stop
         endif

         ! only if not allocated, allocate
         if ( .not. allocated(x) ) allocate(x(20))

        ! allocation and intent(out)
         call intentout(x)
         write(*,*)'note it is deallocated!',allocated(x)

         contains

         subroutine intentout(arr)
         ! note that if arr has intent(out) and is allocatable,
         ! arr is deallocated on entry
         real(kind=sp),intent(out),allocatable :: arr(:)
             write(*,*)'note it was allocated in calling program',allocated(arr)
         end subroutine intentout

      end program demo_allocated
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fanint%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%2Callocatable%20%3A%3A%20arr%28%3A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27ANINT%20%282%2E783%29%20has%20the%20value%203%2E0%20%3D%3E%27%2C%20anint%282%2E783%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27ANINT%20%28%2D2%2E783%29%20has%20the%20value%20%2D3%2E0%20%3D%3E%27%2C%20anint%28%2D2%2E783%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27by%20default%20the%20kind%20of%20the%20output%20is%20the%20kind%20of%20the%20input%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%281234567890%2E1234567890e0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%281234567890%2E1234567890d0%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27sometimes%20specifying%20the%20result%20kind%20is%20useful%20when%20passing%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27results%20as%20an%20argument%2C%20for%20example%2E%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27do%20you%20know%20why%20the%20results%20are%20different%3F%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%281234567890%2E1234567890%2Ckind%3Dreal64%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%281234567890%2E1234567890d0%2Ckind%3Dreal64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27numbers%20on%20a%20cusp%20are%20always%20the%20most%20troublesome%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%28%5B%20%2D2%2E7%2C%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%2D1%2E0%2C%20%2D0%2E5%2C%200%2E0%20%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27negative%20zero%20is%20processor%20dependent%27%0D%0A%20%20%20%20%20%20%20%20%20arr%3D%5B%200%2E0%2C%200%2E1%2C%200%2E5%2C%201%2E0%2C%201%2E5%2C%202%2E0%2C%202%2E2%2C%202%2E5%2C%202%2E7%20%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20arr%3D%5B%20%2D0%2E0%2C%20%2D0%2E1%2C%20%2D0%2E5%2C%20%2D1%2E0%2C%20%2D1%2E5%2C%20%2D2%2E0%2C%20%2D2%2E2%2C%20%2D2%2E5%2C%20%2D2%2E7%20%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20anint%28arr%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fanint%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> anint
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_anint
      use, intrinsic :: iso_fortran_env, only : real32, real64, real128
      implicit none
      real,allocatable :: arr(:)

        ! basics
         print *, 'ANINT (2.783) has the value 3.0 =>', anint(2.783)
         print *, 'ANINT (-2.783) has the value -3.0 =>', anint(-2.783)

         print *, 'by default the kind of the output is the kind of the input'
         print *, anint(1234567890.1234567890e0)
         print *, anint(1234567890.1234567890d0)

         print *, 'sometimes specifying the result kind is useful when passing'
         print *, 'results as an argument, for example.'
         print *, 'do you know why the results are different?'
         print *, anint(1234567890.1234567890,kind=real64)
         print *, anint(1234567890.1234567890d0,kind=real64)

        ! elemental
         print *, 'numbers on a cusp are always the most troublesome'
         print *, anint([ -2.7, -2.5, -2.2, -2.0, -1.5, -1.0, -0.5, 0.0 ])

         print *, 'negative zero is processor dependent'
         arr=[ 0.0, 0.1, 0.5, 1.0, 1.5, 2.0, 2.2, 2.5, 2.7 ]
         print *, anint(arr)
         arr=[ -0.0, -0.1, -0.5, -1.0, -1.5, -2.0, -2.2, -2.5, -2.7 ]
         print *, anint(arr)

      end program demo_anint
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fany%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%2Cparameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%282%2C3%29%2C%20b%282%2C3%29%0D%0A%20%20%20%20%20%20logical%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20bool%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20bool%20%3D%20any%28%5BF%2CF%2CT%2CF%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cbool%0D%0A%20%20%20%20%20%20%20%20%20bool%20%3D%20any%28%5BF%2CF%2CF%2CF%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cbool%0D%0A%20%20%20%20%20%20%20%20%21%20fill%20two%20integer%20arrays%20with%20values%20for%20testing%0D%0A%20%20%20%20%20%20%20%20%20a%20%3D%201%0D%0A%20%20%20%20%20%20%20%20%20b%20%3D%201%0D%0A%20%20%20%20%20%20%20%20%20b%28%3A%2C2%29%20%3D%202%0D%0A%20%20%20%20%20%20%20%20%20b%28%3A%2C3%29%20%3D%203%0D%0A%20%20%20%20%20%20%20%20%21%20using%20any%283%29%20with%20logical%20expressions%20you%20can%20compare%20two%20arrays%0D%0A%20%20%20%20%20%20%20%20%21%20in%20a%20myriad%20of%20ways%0D%0A%20%20%20%20%20%20%20%20%20%21%20first%2C%20print%20where%20elements%20of%20b%20are%20bigger%20than%20in%20a%0D%0A%20%20%20%20%20%20%20%20%20call%20printl%28%20%27first%20print%20b%20%3E%20a%20%20%20%20%20%20%20%20%20%20%20%20%20%27%2C%20b%20%3E%20a%20%20%20%20%20%20%20%20%20%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20now%20use%20any%28%29%20to%20test%0D%0A%20%20%20%20%20%20%20%20%20call%20printl%28%20%27any%20true%20values%3F%20%20any%28b%20%3E%20a%29%20%20%27%2C%20any%28b%20%3E%20a%20%29%20%20%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printl%28%20%27again%20by%20columns%3F%20any%28b%20%3E%20a%2C1%29%27%2C%20any%28b%20%3E%20a%2C%201%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printl%28%20%27again%20by%20rows%3F%20%20%20%20any%28b%20%3E%20a%2C2%29%27%2C%20any%28b%20%3E%20a%2C%202%29%20%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%20CONVENIENCE%20ROUTINE%2E%20this%20is%20not%20specific%20to%20ANY%28%29%0D%0A%20%20%20%20%20%20subroutine%20printl%28title%2Ca%29%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20stderr%3D%3EERROR%5FUNIT%2C%26%0D%0A%20%20%20%20%20%20%20%26%20stdin%3D%3EINPUT%5FUNIT%2C%26%0D%0A%20%20%20%20%20%20%20%26%20stdout%3D%3EOUTPUT%5FUNIT%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20logical%20scalar%2C%20vector%2C%20or%20matrix%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20row%3D%27%28%22%20%3E%20%5B%20%22%2C%2A%28l1%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20logical%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%28%2E%2E%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%2Cadvance%3D%27no%27%29trim%28title%29%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27%20%3A%20shape%3D%27%2Cshape%28a%29%2C%27%2Crank%3D%27%2Crank%28a%29%2C%27%2Csize%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20get%20size%20and%20shape%20of%20input%0D%0A%20%20%20%20%20%20%20%20%20select%20rank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%280%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%28a%20scalar%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29a%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%281%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%28a%20vector%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29a%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20rank%20%282%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%28a%20matrix%29%20%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28a%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29a%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20rank%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28stderr%2C%2A%29%27%2Aprintl%2A%20did%20not%20expect%20rank%3D%27%2C%20rank%28a%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27shape%3D%27%2C%20shape%28a%29%2C%27size%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27%2Aprintl%2A%20unexpected%20rank%27%0D%0A%20%20%20%20%20%20%20%20%20end%20select%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20printl%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fany%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> any
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_any
      implicit none
      logical,parameter :: T=.true., F=.false.
      integer           :: a(2,3), b(2,3)
      logical           :: bool
        ! basic usage
         bool = any([F,F,T,F])
         print *,bool
         bool = any([F,F,F,F])
         print *,bool
        ! fill two integer arrays with values for testing
         a = 1
         b = 1
         b(:,2) = 2
         b(:,3) = 3
        ! using any(3) with logical expressions you can compare two arrays
        ! in a myriad of ways
         ! first, print where elements of b are bigger than in a
         call printl( 'first print b > a             ', b > a         )
         ! now use any() to test
         call printl( 'any true values?  any(b > a)  ', any(b > a )   )
         call printl( 'again by columns? any(b > a,1)', any(b > a, 1) )
         call printl( 'again by rows?    any(b > a,2)', any(b > a, 2) )
      contains
      ! CONVENIENCE ROUTINE. this is not specific to ANY()
      subroutine printl(title,a)
      use, intrinsic :: iso_fortran_env, only : &
       & stderr=>ERROR_UNIT,&
       & stdin=>INPUT_UNIT,&
       & stdout=>OUTPUT_UNIT
      implicit none

      !@(#) print small 2d logical scalar, vector, or matrix

      character(len=*),parameter   :: all='(*(g0,1x))'
      character(len=*),parameter   :: row='(" > [ ",*(l1:,","))'
      character(len=*),intent(in)  :: title
      logical,intent(in)           :: a(..)
      integer                      :: i
         write(*,*)
         write(*,all,advance='no')trim(title),&
          & ' : shape=',shape(a),',rank=',rank(a),',size=',size(a)
         ! get size and shape of input
         select rank(a)
         rank (0); write(*,'(a)')'(a scalar)'
            write(*,fmt=row,advance='no')a
            write(*,'(" ]")')
         rank (1); write(*,'(a)')'(a vector)'
            do i=1,size(a)
               write(*,fmt=row,advance='no')a(i)
               write(*,'(" ]")')
            enddo
         rank (2); write(*,'(a)')'(a matrix) '
            do i=1,size(a,dim=1)
               write(*,fmt=row,advance='no')a(i,:)
               write(*,'(" ]")')
            enddo
         rank default
            write(stderr,*)'*printl* did not expect rank=', rank(a), &
             & 'shape=', shape(a),'size=',size(a)
            stop '*printl* unexpected rank'
         end select

      end subroutine printl

      end program demo_any
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fasin%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%20value%20to%20convert%20degrees%20to%20radians%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%2Cparameter%20%3A%3A%20D2R%3Dacos%28%2D1%2E0%5Fdp%29%2F180%2E0%5Fdp%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20angle%2C%20rise%2C%20run%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20%20%20%21%20given%20sine%28theta%29%20%3D%201%2E25%20miles%2F50%20miles%20%28opposite%2Fhypotenuse%29%0D%0A%20%20%20%20%20%20%20%20%21%20then%20taking%20the%20arcsine%20of%20both%20sides%20of%20the%20equality%20yields%0D%0A%20%20%20%20%20%20%20%20%21%20theta%20%3D%20arcsine%281%2E25%20miles%2F50%20miles%29%20ie%2E%20arcsine%28opposite%2Fhypotenuse%29%0D%0A%20%20%20%20%20%20%20%20rise%3D1%2E250%5Fdp%0D%0A%20%20%20%20%20%20%20%20run%3D50%2E00%5Fdp%0D%0A%20%20%20%20%20%20%20%20angle%20%3D%20asin%28rise%2Frun%29%0D%0A%20%20%20%20%20%20%20%20print%20all%2C%20%27angle%20of%20incline%28radians%29%20%3D%20%27%2C%20angle%0D%0A%20%20%20%20%20%20%20%20angle%20%3D%20angle%2FD2R%0D%0A%20%20%20%20%20%20%20%20print%20all%2C%20%27angle%20of%20incline%28degrees%29%20%3D%20%27%2C%20angle%0D%0A%0D%0A%20%20%20%20%20%20%20%20print%20all%2C%20%27percent%20grade%3D%27%2Crise%2Frun%2A100%2E0%5Fdp%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fasin%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> asin
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_asin
      use, intrinsic :: iso_fortran_env, only : dp=>real64
      implicit none
      ! value to convert degrees to radians
      real(kind=dp),parameter :: D2R=acos(-1.0_dp)/180.0_dp
      real(kind=dp)           :: angle, rise, run
      character(len=*),parameter :: all='(*(g0,1x))'
        ! given sine(theta) = 1.25 miles/50 miles (opposite/hypotenuse)
        ! then taking the arcsine of both sides of the equality yields
        ! theta = arcsine(1.25 miles/50 miles) ie. arcsine(opposite/hypotenuse)
        rise=1.250_dp
        run=50.00_dp
        angle = asin(rise/run)
        print all, 'angle of incline(radians) = ', angle
        angle = angle/D2R
        print all, 'angle of incline(degrees) = ', angle

        print all, 'percent grade=',rise/run*100.0_dp
      end program demo_asin
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fasinh%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%2C%20dimension%283%29%20%3A%3A%20x%20%3D%20%5B%20%2D1%2E0d0%2C%200%2E0d0%2C%201%2E0d0%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20asinh%28x%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fasinh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> asinh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_asinh
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=dp), dimension(3) :: x = [ -1.0d0, 0.0d0, 1.0d0 ]

         ! elemental
          write (*,*) asinh(x)

      end program demo_asinh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fassociated%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%2C%20target%20%20%3A%3A%20tgt%282%29%20%3D%20%5B1%2E%2C%202%2E%5D%0D%0A%20%20%20%20%20%20real%2C%20pointer%20%3A%3A%20ptr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20ptr%20%3D%3E%20tgt%0D%0A%20%20%20%20%20%20%20%20%20if%20%28associated%28ptr%29%20%20%20%20%20%2Eeqv%2E%20%2Efalse%2E%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20stop%20%27POINTER%20NOT%20ASSOCIATED%27%0D%0A%20%20%20%20%20%20%20%20%20if%20%28associated%28ptr%2Ctgt%29%20%2Eeqv%2E%20%2Efalse%2E%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20stop%20%27POINTER%20NOT%20ASSOCIATED%20TO%20TARGET%27%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fassociated%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> associated
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_associated
      implicit none
      real, target  :: tgt(2) = [1., 2.]
      real, pointer :: ptr(:)
         ptr => tgt
         if (associated(ptr)     .eqv. .false.) &
         & stop 'POINTER NOT ASSOCIATED'
         if (associated(ptr,tgt) .eqv. .false.) &
         & stop 'POINTER NOT ASSOCIATED TO TARGET'
      end program demo_associated
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatan2%0D%0A%20%20%20%20%20%20real%20%3A%3A%20z%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20c%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%21%20ATAN2%20%281%2E5574077%2C%201%2E0%29%20has%20the%20value%201%2E0%20%28approximately%29%2E%0D%0A%20%20%20%20%20%20%20%20z%3Datan2%281%2E5574077%2C%201%2E0%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27radians%3D%27%2Cz%2C%27degrees%3D%27%2Cr2d%28z%29%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%21%20elemental%20arrays%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27elemental%27%2Catan2%28%20%5B10%2E0%2C%2020%2E0%5D%2C%20%5B30%2E0%2C40%2E0%5D%20%29%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%21%20elemental%20arrays%20and%20scalars%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27elemental%27%2Catan2%28%20%5B10%2E0%2C%2020%2E0%5D%2C%2050%2E0%20%29%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%21%20break%20complex%20values%20into%20real%20and%20imaginary%20components%0D%0A%20%20%20%20%20%20%20%21%20%28note%20TAN2%28%29%20can%20take%20a%20complex%20type%20value%20%29%0D%0A%20%20%20%20%20%20%20%20c%3D%280%2E0%2C1%2E0%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27complex%27%2Cc%2Catan2%28%20x%3Dc%25re%2C%20y%3Dc%25im%20%29%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%21%20extended%20sample%20converting%20cartesian%20coordinates%20to%20polar%0D%0A%20%20%20%20%20%20%20%20COMPLEX%5FVALS%3A%20block%0D%0A%20%20%20%20%20%20%20%20real%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20ang%2C%20radius%0D%0A%20%20%20%20%20%20%20%20complex%2Callocatable%20%3A%3A%20vals%28%3A%29%0D%0A%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20vals%3D%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%28%201%2E0%2C%200%2E0%20%29%2C%20%26%20%21%200%0D%0A%20%20%20%20%20%20%20%20%20%20%28%201%2E0%2C%201%2E0%20%29%2C%20%26%20%21%2045%0D%0A%20%20%20%20%20%20%20%20%20%20%28%200%2E0%2C%201%2E0%20%29%2C%20%26%20%21%2090%0D%0A%20%20%20%20%20%20%20%20%20%20%28%2D1%2E0%2C%201%2E0%20%29%2C%20%26%20%21%20135%0D%0A%20%20%20%20%20%20%20%20%20%20%28%2D1%2E0%2C%200%2E0%20%29%2C%20%26%20%21%20180%0D%0A%20%20%20%20%20%20%20%20%20%20%28%2D1%2E0%2C%2D1%2E0%20%29%2C%20%26%20%21%20225%0D%0A%20%20%20%20%20%20%20%20%20%20%28%200%2E0%2C%2D1%2E0%20%29%5D%20%20%20%21%20270%0D%0A%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28vals%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20call%20cartesian%5Fto%5Fpolar%28vals%28i%29%25re%2C%20vals%28i%29%25im%2C%20radius%2Cang%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C101%29vals%28i%29%2Cang%2Cr2d%28ang%29%2Cradius%0D%0A%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20101%20format%28%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%26%20%27X%3D%20%27%2Cf5%2E2%2C%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%26%20%27%20Y%3D%20%27%2Cf5%2E2%2C%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%26%20%27%20ANGLE%3D%20%27%2Cg0%2C%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%26%20T38%2C%27DEGREES%3D%20%27%2Cg0%2E4%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%26%20T54%2C%27DISTANCE%3D%27%2Cg0%29%0D%0A%20%20%20%20%20%20%20endblock%20COMPLEX%5FVALS%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20elemental%20real%20function%20r2d%28radians%29%0D%0A%20%20%20%20%20%20%21%20input%20radians%20to%20convert%20to%20degrees%0D%0A%20%20%20%20%20%20doubleprecision%2Cparameter%20%3A%3A%20DEGREE%3D0%2E017453292519943d0%20%21%20radians%0D%0A%20%20%20%20%20%20real%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20radians%0D%0A%20%20%20%20%20%20%20%20%20r2d%3Dradians%20%2F%20DEGREE%20%21%20do%20the%20conversion%0D%0A%20%20%20%20%20%20end%20function%20r2d%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20subroutine%20cartesian%5Fto%5Fpolar%28x%2Cy%2Cradius%2Cinclination%29%0D%0A%20%20%20%20%20%20%21%20return%20angle%20in%20radians%20in%20range%200%20to%202%2API%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%2Cintent%28in%29%20%20%3A%3A%20x%2Cy%0D%0A%20%20%20%20%20%20real%2Cintent%28out%29%20%3A%3A%20radius%2Cinclination%0D%0A%20%20%20%20%20%20%20%20%20radius%3Dsqrt%28x%2A%2A2%2By%2A%2A2%29%0D%0A%20%20%20%20%20%20%20%20%20if%28radius%2Eeq%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20inclination%3D0%2E0%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20inclination%3Datan2%28y%2Cx%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28inclination%20%3C%200%2E0%29inclination%3Dinclination%2B2%2Aatan2%280%2E0d0%2C%2D1%2E0d0%29%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20subroutine%20cartesian%5Fto%5Fpolar%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatan2%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atan2
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atan2
      real :: z
      complex :: c
       !
       ! basic usage
        ! ATAN2 (1.5574077, 1.0) has the value 1.0 (approximately).
        z=atan2(1.5574077, 1.0)
        write(*,*) 'radians=',z,'degrees=',r2d(z)
       !
       ! elemental arrays
        write(*,*)'elemental',atan2( [10.0, 20.0], [30.0,40.0] )
       !
       ! elemental arrays and scalars
        write(*,*)'elemental',atan2( [10.0, 20.0], 50.0 )
       !
       ! break complex values into real and imaginary components
       ! (note TAN2() can take a complex type value )
        c=(0.0,1.0)
        write(*,*)'complex',c,atan2( x=c%re, y=c%im )
       !
       ! extended sample converting cartesian coordinates to polar
        COMPLEX_VALS: block
        real                :: ang, radius
        complex,allocatable :: vals(:)
        integer             :: i
       !
        vals=[ &
          ( 1.0, 0.0 ), & ! 0
          ( 1.0, 1.0 ), & ! 45
          ( 0.0, 1.0 ), & ! 90
          (-1.0, 1.0 ), & ! 135
          (-1.0, 0.0 ), & ! 180
          (-1.0,-1.0 ), & ! 225
          ( 0.0,-1.0 )]   ! 270
        do i=1,size(vals)
           call cartesian_to_polar(vals(i)%re, vals(i)%im, radius,ang)
           write(*,101)vals(i),ang,r2d(ang),radius
        enddo
        101 format(             &
        & 'X= ',f5.2,           &
        & ' Y= ',f5.2,          &
        & ' ANGLE= ',g0,        &
        & T38,'DEGREES= ',g0.4, &
        & T54,'DISTANCE=',g0)
       endblock COMPLEX_VALS
      !
      contains
      !
      elemental real function r2d(radians)
      ! input radians to convert to degrees
      doubleprecision,parameter :: DEGREE=0.017453292519943d0 ! radians
      real,intent(in)           :: radians
         r2d=radians / DEGREE ! do the conversion
      end function r2d
      !
      subroutine cartesian_to_polar(x,y,radius,inclination)
      ! return angle in radians in range 0 to 2*PI
      implicit none
      real,intent(in)  :: x,y
      real,intent(out) :: radius,inclination
         radius=sqrt(x**2+y**2)
         if(radius.eq.0)then
            inclination=0.0
         else
            inclination=atan2(y,x)
            if(inclination < 0.0)inclination=inclination+2*atan2(0.0d0,-1.0d0)
         endif
      end subroutine cartesian_to_polar
      !
      end program demo_atan2
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatan%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%2Cparameter%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20Deg%5FPer%5FRad%20%3D%2057%2E2957795130823208767981548%5Freal64%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%0D%0A%20%20%20%20%20%20%20%20%20%20x%3D2%2E866%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%20atan%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%20atan%28%202%2E0d0%2C%202%2E0d0%29%2Catan%28%202%2E0d0%2C%202%2E0d0%29%2ADeg%5FPer%5FRad%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%20atan%28%202%2E0d0%2C%2D2%2E0d0%29%2Catan%28%202%2E0d0%2C%2D2%2E0d0%29%2ADeg%5FPer%5FRad%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%20atan%28%2D2%2E0d0%2C%202%2E0d0%29%2Catan%28%2D2%2E0d0%2C%202%2E0d0%29%2ADeg%5FPer%5FRad%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%20atan%28%2D2%2E0d0%2C%2D2%2E0d0%29%2Catan%28%2D2%2E0d0%2C%2D2%2E0d0%29%2ADeg%5FPer%5FRad%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatan%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atan
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atan
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      character(len=*),parameter :: all='(*(g0,1x))'
      real(kind=real64),parameter :: &
       Deg_Per_Rad = 57.2957795130823208767981548_real64
      real(kind=real64) :: x
          x=2.866_real64
          print all, atan(x)

          print all, atan( 2.0d0, 2.0d0),atan( 2.0d0, 2.0d0)*Deg_Per_Rad
          print all, atan( 2.0d0,-2.0d0),atan( 2.0d0,-2.0d0)*Deg_Per_Rad
          print all, atan(-2.0d0, 2.0d0),atan(-2.0d0, 2.0d0)*Deg_Per_Rad
          print all, atan(-2.0d0,-2.0d0),atan(-2.0d0,-2.0d0)*Deg_Per_Rad

      end program demo_atan
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatanh%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%2C%20dimension%283%29%20%3A%3A%20x%20%3D%20%5B%20%2D1%2E0%2C%200%2E0%2C%201%2E0%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20atanh%28x%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatanh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atanh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atanh
      implicit none
      real, dimension(3) :: x = [ -1.0, 0.0, 1.0 ]

         write (*,*) atanh(x)

      end program demo_atanh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fadd%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fadd%20%28atom%5B1%5D%2C%20this%5Fimage%28%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fadd%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_add
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_add
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*]
         call atomic_add (atom[1], this_image())
      end program demo_atomic_add
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fand%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fand%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fand%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_and
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_and
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*]
         call atomic_and(atom[1], int(b'10100011101'))
      end program demo_atomic_and
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fcas%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%28atomic%5Flogical%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%2C%20prev%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fcas%28atom%5B1%5D%2C%20prev%2C%20%2Efalse%2E%2C%20%2Etrue%2E%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fcas%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_cas
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_cas
      use iso_fortran_env
      implicit none
      logical(atomic_logical_kind) :: atom[*], prev
         call atomic_cas(atom[1], prev, .false., .true.)
      end program demo_atomic_cas
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fdefine%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20%20%20%20%20call%20atomic%5Fdefine%28atom%5B1%5D%2C%20this%5Fimage%28%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fdefine%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_define
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_define
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*]
          call atomic_define(atom[1], this_image())
      end program demo_atomic_define
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Ffetch%5Fadd%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%2C%20old%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fadd%28atom%5B1%5D%2C%20this%5Fimage%28%29%2C%20old%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Ffetch%5Fadd%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_fetch_add
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_fetch_add
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*], old
         call atomic_add(atom[1], this_image(), old)
      end program demo_atomic_fetch_add
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Ffetch%5Fand%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%2C%20old%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Ffetch%5Fand%20%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%2C%20old%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Ffetch%5Fand%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_fetch_and
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_fetch_and
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*], old
         call atomic_fetch_and (atom[1], int(b'10100011101'), old)
      end program demo_atomic_fetch_and
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Ffetch%5For%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%2C%20old%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Ffetch%5For%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%2C%20old%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Ffetch%5For%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_fetch_or
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_fetch_or
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*], old
         call atomic_fetch_or(atom[1], int(b'10100011101'), old)
      end program demo_atomic_fetch_or
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Ffetch%5Fxor%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%2C%20old%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Ffetch%5Fxor%20%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%2C%20old%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Ffetch%5Fxor%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_fetch_xor
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_fetch_xor
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*], old
         call atomic_fetch_xor (atom[1], int(b'10100011101'), old)
      end program demo_atomic_fetch_xor
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5For%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5For%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5For%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_or
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_or
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*]
         call atomic_or(atom[1], int(b'10100011101'))
      end program demo_atomic_or
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fref%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%28atomic%5Flogical%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20val%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fref%28%20val%2C%20atom%5B1%5D%20%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28val%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22Obtained%22%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fref%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_ref
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_ref
      use iso_fortran_env
      implicit none
      logical(atomic_logical_kind) :: atom[*]
      logical :: val
         call atomic_ref( val, atom[1] )
         if (val) then
            print *, "Obtained"
         endif
      end program demo_atomic_ref
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fatomic%5Fxor%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28atomic%5Fint%5Fkind%29%20%3A%3A%20atom%5B%2A%5D%0D%0A%20%20%20%20%20%20%20%20%20call%20atomic%5Fxor%28atom%5B1%5D%2C%20int%28b%2710100011101%27%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fatomic%5Fxor%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> atomic_xor
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_atomic_xor
      use iso_fortran_env
      implicit none
      integer(atomic_int_kind) :: atom[*]
         call atomic_xor(atom[1], int(b'10100011101'))
      end program demo_atomic_xor
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20program%20demo%5Fbackspace%0D%0A%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D256%29%20%3A%3A%20line%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D256%29%20%3A%3A%20mssge%0D%0A%20%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20j%0D%0A%20%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20ios%0D%0A%20%20%20%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20iarr%28%3A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20create%20a%20basic%20sequential%20file%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20open%2810%2Cfile%3D%27dem%5Fbackspace%2Etxt%27%29%20%21%20open%20a%20file%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2C30%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20write%20lines%20to%20it%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%2810%2C%27%28a%2Ci3%2C%2A%28i3%29%29%27%29%20%27line%20%27%2Ci%2C%20%28j%2Cj%3D1%2Ci%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20back%20up%20several%20lines%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2C14%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20backspace%2810%2C%20iostat%3Dios%2Ciomsg%3Dmssge%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28ios%2Ene%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28a%29%29%27%29%20%27%2Adem%5Fbackspace%2A%20ERROR%3A%27%2Cmssge%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%2810%2C%27%28a%29%27%29line%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27back%20at%20a%20previous%20record%20%21%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20read%20line%20as%20a%20string%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22string%3D%22%2Ca%29%27%29trim%28line%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20backspace%20so%20can%20read%20again%20as%20numbers%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20backspace%2810%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20read%20part%20of%20a%20line%20numerically%20to%20get%20size%20of%20array%20to%20read%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%2810%2C%27%285x%2Ci3%29%27%29i%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20allocate%28iarr%28i%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20reread%20line%20just%20reading%20array%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20backspace%2810%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%2810%2C%27%288x%2C%2A%28i3%29%29%27%29iarr%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%2C1x%29%29%27%29%27size%3D%27%2Ci%2C%27array%3D%27%2Ciarr%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%21%20Note%3A%20writing%20a%20new%20line%20will%20truncate%20file%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%21%20%20%20%20%20%20%20to%20current%20record%20position%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20close%2810%2Cstatus%3D%27delete%27%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20end%20program%20demo%5Fbackspace%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> backspace
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
         program demo_backspace
         implicit none
         character(len=256) :: line
         character(len=256) :: mssge
         integer            :: i
         integer            :: j
         integer            :: ios
         integer,allocatable :: iarr(:)

            ! create a basic sequential file
            open(10,file='dem_backspace.txt') ! open a file
            do i=1,30                         ! write lines to it
               write(10,'(a,i3,*(i3))') 'line ',i, (j,j=1,i)
            enddo

            ! back up several lines
            do i=1,14
               backspace(10, iostat=ios,iomsg=mssge)
               if(ios.ne.0)then
                       write(*,'(*(a))') '*dem_backspace* ERROR:',mssge
               endif
            enddo
            read(10,'(a)')line
            write(*,*)'back at a previous record !'

            ! read line as a string
            write(*,'("string=",a)')trim(line)

            ! backspace so can read again as numbers
            backspace(10)
            ! read part of a line numerically to get size of array to read
            read(10,'(5x,i3)')i
            allocate(iarr(i))

            ! reread line just reading array
            backspace(10)
            read(10,'(8x,*(i3))')iarr
            write(*,'(*(g0,1x))')'size=',i,'array=',iarr

            !! Note: writing a new line will truncate file
            !!       to current record position

            close(10,status='delete')

         end program demo_backspace
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fj0%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%200%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20bessel%5Fj0%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fj0%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_j0
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_j0
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
         implicit none
         real(kind=real64) :: x
         x = 0.0_real64
         x = bessel_j0(x)
         write(*,*)x
      end program demo_bessel_j0
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fj1%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20bessel%5Fj1%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fj1%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_j1
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_j1
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 1.0_real64
         x = bessel_j1(x)
         write(*,*)x
      end program demo_bessel_j1
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fjn%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20x%20%3D%20bessel%5Fjn%285%2Cx%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fjn%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_jn
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_jn
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
         & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 1.0_real64
          x = bessel_jn(5,x)
          write(*,*)x
      end program demo_bessel_jn
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fy0%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%200%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20x%20%3D%20bessel%5Fy0%28x%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fy0%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_y0
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_y0
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
      implicit none
        real(kind=real64) :: x = 0.0_real64
        x = bessel_y0(x)
        write(*,*)x
      end program demo_bessel_y0
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fy1%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2C%20bessel%5Fy1%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fy1%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_y1
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_y1
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
      implicit none
        real(kind=real64) :: x = 1.0_real64
        write(*,*)x, bessel_y1(x)
      end program demo_bessel_y1
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbessel%5Fyn%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20x%2Cbessel%5Fyn%285%2Cx%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbessel%5Fyn%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bessel_yn
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bessel_yn
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 1.0_real64
        write(*,*) x,bessel_yn(5,x)
      end program demo_bessel_yn
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbge%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20byte%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%2Callocatable%20%3A%3A%20arr1%28%3A%29%2C%20arr2%28%3A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20BASIC%20USAGE%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27bge%28%2D127%2C127%29%3D%27%2Cbge%28%20%2D127%2C%20127%20%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20on%20%28very%20common%29%20%22two%27s%20complement%22%20machines%20that%20are%0D%0A%20%20%20%20%20%20%20%20%20%21%20little%2Dendian%20%2D127%20will%20be%20greater%20than%20127%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20BOZ%20constants%0D%0A%20%20%20%20%20%20%20%20%20%21%20BOZ%20constants%20are%20subject%20to%20truncation%2C%20so%20make%20sure%0D%0A%20%20%20%20%20%20%20%20%20%21%20your%20values%20are%20valid%20for%20the%20integer%20kind%20being%20compared%20to%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27bge%28b%220001%22%2C2%29%3D%27%2Cbge%28%20b%221%22%2C%202%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20ELEMENTAL%0D%0A%20%20%20%20%20%20%20%20%20%21%20an%20array%20and%20scalar%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27compare%20array%20of%20values%20%5B%2D128%2C%20%2D0%2C%20%2B0%2C%20127%5D%20to%20127%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29bge%28int%28%5B%2D128%2C%20%2D0%2C%20%2B0%2C%20127%5D%2C%20kind%3Dint8%29%2C%20127%5Fint8%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20two%20arrays%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27compare%20two%20arrays%27%0D%0A%20%20%20%20%20%20%20%20%20arr1%3Dint%28%20%5B%20%2D127%2C%20%2D0%2C%20%2B0%2C%20%20127%5D%2C%20kind%3Dint8%20%29%0D%0A%20%20%20%20%20%20%20%20%20arr2%3Dint%28%20%5B%20%20127%2C%20%200%2C%20%200%2C%20%2D127%5D%2C%20kind%3Dint8%20%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27arr1%3D%27%2Carr1%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27arr2%3D%27%2Carr2%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27bge%28arr1%2Carr2%29%3D%27%2Cbge%28%20arr1%2C%20arr2%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20SHOW%20TESTS%20AND%20BITS%0D%0A%20%20%20%20%20%20%20%20%20%21%20actually%20looking%20at%20the%20bit%20patterns%20should%20clarify%20what%20affect%0D%0A%20%20%20%20%20%20%20%20%20%21%20signs%20have%20%2E%2E%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Compare%20some%20one%2Dbyte%20values%20to%2064%2E%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Notice%20that%20the%20values%20are%20tested%20as%20bits%20not%20as%20integers%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27so%20the%20results%20are%20as%20if%20values%20are%20unsigned%20integers%2E%27%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D%2D128%2C127%2C32%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20byte%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%281x%2C1l%2C1x%2Cb0%2E8%29%29%27%29i%2Cbge%28byte%2C64%5Fint8%29%2Cbyte%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20SIGNED%20ZERO%0D%0A%20%20%20%20%20%20%20%20%20%21%20are%20%2B0%20and%20%2D0%20the%20same%20on%20your%20platform%3F%20When%20comparing%20at%20the%0D%0A%20%20%20%20%20%20%20%20%20%21%20bit%20level%20this%20is%20important%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22plus%20zero%3D%22%2Cb0%29%27%29%20%20%2B0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22minus%20zero%3D%22%2Cb0%29%27%29%20%2D0%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbge%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bge
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bge
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer            :: i
      integer(kind=int8) :: byte
      integer(kind=int8),allocatable :: arr1(:), arr2(:)

        ! BASIC USAGE
         write(*,*)'bge(-127,127)=',bge( -127, 127 )
         ! on (very common) "two's complement" machines that are
         ! little-endian -127 will be greater than 127

         ! BOZ constants
         ! BOZ constants are subject to truncation, so make sure
         ! your values are valid for the integer kind being compared to
         write(*,*)'bge(b"0001",2)=',bge( b"1", 2)

        ! ELEMENTAL
         ! an array and scalar
         write(*, *)'compare array of values [-128, -0, +0, 127] to 127'
         write(*, *)bge(int([-128, -0, +0, 127], kind=int8), 127_int8)

         ! two arrays
         write(*, *)'compare two arrays'
         arr1=int( [ -127, -0, +0,  127], kind=int8 )
         arr2=int( [  127,  0,  0, -127], kind=int8 )
         write(*,*)'arr1=',arr1
         write(*,*)'arr2=',arr2
         write(*, *)'bge(arr1,arr2)=',bge( arr1, arr2 )

        ! SHOW TESTS AND BITS
         ! actually looking at the bit patterns should clarify what affect
         ! signs have ...
         write(*,*)'Compare some one-byte values to 64.'
         write(*,*)'Notice that the values are tested as bits not as integers'
         write(*,*)'so the results are as if values are unsigned integers.'
         do i=-128,127,32
            byte=i
            write(*,'(sp,i0.4,*(1x,1l,1x,b0.8))')i,bge(byte,64_int8),byte
         enddo

        ! SIGNED ZERO
         ! are +0 and -0 the same on your platform? When comparing at the
         ! bit level this is important
         write(*,'("plus zero=",b0)')  +0
         write(*,'("minus zero=",b0)') -0

      end program demo_bge
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbgt%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20byte%0D%0A%20%20%20%20%20%20%20%20%21%20Compare%20some%20one%2Dbyte%20values%20to%2064%2E%0D%0A%20%20%20%20%20%20%20%20%20%21%20Notice%20that%20the%20values%20are%20tested%20as%20bits%20not%20as%20integers%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20sign%20bits%20in%20the%20integer%20are%20treated%20just%20like%20any%20other%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20%27we%20will%20compare%20other%20values%20to%2064%27%0D%0A%20%20%20%20%20%20%20%20%20i%3D64%0D%0A%20%20%20%20%20%20%20%20%20byte%3Di%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%281x%2C1l%2C1x%2Cb0%2E8%29%29%27%29i%2Cbgt%28byte%2C64%5Fint8%29%2Cbyte%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20%22comparing%20at%20the%20bit%20level%2C%20not%20as%20whole%20numbers%2E%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20%22so%20pay%20particular%20attention%20to%20the%20negative%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20%22values%20on%20this%20two%27s%20complement%20platform%20%2E%2E%2E%22%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D%2D128%2C127%2C32%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20byte%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%281x%2C1l%2C1x%2Cb0%2E8%29%29%27%29i%2Cbgt%28byte%2C64%5Fint8%29%2Cbyte%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20see%20the%20BGE%28%29%20description%20for%20an%20extended%20description%0D%0A%20%20%20%20%20%20%20%20%20%21%20of%20related%20information%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbgt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bgt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bgt
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer            :: i
      integer(kind=int8) :: byte
        ! Compare some one-byte values to 64.
         ! Notice that the values are tested as bits not as integers
         ! so sign bits in the integer are treated just like any other
         write(*,'(a)') 'we will compare other values to 64'
         i=64
         byte=i
         write(*,'(sp,i0.4,*(1x,1l,1x,b0.8))')i,bgt(byte,64_int8),byte

         write(*,'(a)') "comparing at the bit level, not as whole numbers."
         write(*,'(a)') "so pay particular attention to the negative"
         write(*,'(a)') "values on this two's complement platform ..."
         do i=-128,127,32
            byte=i
            write(*,'(sp,i0.4,*(1x,1l,1x,b0.8))')i,bgt(byte,64_int8),byte
         enddo

         ! see the BGE() description for an extended description
         ! of related information

      end program demo_bgt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbit%5Fsize%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20integer%5Fkinds%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20fmt%3D%26%0D%0A%20%20%20%20%20%20%26%20%27%28a%2C%22%3A%20bit%20size%20is%20%22%2Ci3%2C%22%20which%20is%20kind%3D%22%2Ci3%2C%22%20on%20this%20platform%22%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20default%20integer%20bit%20size%20on%20this%20platform%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29%20%22default%22%2C%20bit%5Fsize%280%29%2C%20kind%280%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29%20%22int8%20%20%20%22%2C%20bit%5Fsize%280%5Fint8%29%2C%20%20%20kind%280%5Fint8%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29%20%22int16%20%20%22%2C%20bit%5Fsize%280%5Fint16%29%2C%20%20kind%280%5Fint16%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29%20%22int32%20%20%22%2C%20bit%5Fsize%280%5Fint32%29%2C%20%20kind%280%5Fint32%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29%20%22int64%20%20%22%2C%20bit%5Fsize%280%5Fint64%29%2C%20%20kind%280%5Fint64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2A%28i0%3A%2C%22%2C%20%22%29%29%27%29%20%22The%20available%20kinds%20are%20%22%2Cinteger%5Fkinds%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbit%5Fsize%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> bit_size
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_bit_size
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      use,intrinsic :: iso_fortran_env, only : integer_kinds
      implicit none
      character(len=*),parameter   :: fmt=&
      & '(a,": bit size is ",i3," which is kind=",i3," on this platform")'

          ! default integer bit size on this platform
          write(*,fmt) "default", bit_size(0), kind(0)

          write(*,fmt) "int8   ", bit_size(0_int8),   kind(0_int8)
          write(*,fmt) "int16  ", bit_size(0_int16),  kind(0_int16)
          write(*,fmt) "int32  ", bit_size(0_int32),  kind(0_int32)
          write(*,fmt) "int64  ", bit_size(0_int64),  kind(0_int64)

          write(*,'(a,*(i0:,", "))') "The available kinds are ",integer_kinds

      end program demo_bit_size
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fble%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20byte%0D%0A%20%20%20%20%20%20%20%20%21%20Compare%20some%20one%2Dbyte%20values%20to%2064%2E%0D%0A%20%20%20%20%20%20%20%20%20%21%20Notice%20that%20the%20values%20are%20tested%20as%20bits%20not%20as%20integers%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20sign%20bits%20in%20the%20integer%20are%20treated%20just%20like%20any%20other%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D%2D128%2C127%2C32%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20byte%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%281x%2C1l%2C1x%2Cb0%2E8%29%29%27%29i%2Cble%28byte%2C64%5Fint8%29%2Cbyte%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%284x%2Cb0%2E8%29%29%27%2964%5Fint8%2C64%5Fint8%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20see%20the%20BGE%28%29%20description%20for%20an%20extended%20description%0D%0A%20%20%20%20%20%20%20%20%20%21%20of%20related%20information%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fble%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ble
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ble
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer            :: i
      integer(kind=int8) :: byte
        ! Compare some one-byte values to 64.
         ! Notice that the values are tested as bits not as integers
         ! so sign bits in the integer are treated just like any other
         do i=-128,127,32
            byte=i
            write(*,'(sp,i0.4,*(1x,1l,1x,b0.8))')i,ble(byte,64_int8),byte
            write(*,'(sp,i0.4,*(4x,b0.8))')64_int8,64_int8
         enddo

         ! see the BGE() description for an extended description
         ! of related information

      end program demo_ble
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fblt%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20byte%0D%0A%20%20%20%20%20%20%20%20%21%20Compare%20some%20one%2Dbyte%20values%20to%2064%2E%0D%0A%20%20%20%20%20%20%20%20%20%21%20Notice%20that%20the%20values%20are%20tested%20as%20bits%20not%20as%20integers%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20sign%20bits%20in%20the%20integer%20are%20treated%20just%20like%20any%20other%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D%2D128%2C127%2C32%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20byte%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28sp%2Ci0%2E4%2C%2A%281x%2C1l%2C1x%2Cb0%2E8%29%29%27%29i%2Cblt%28byte%2C64%5Fint8%29%2Cbyte%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%21%20BOZ%20literals%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29blt%28z%271000%27%2C%20z%27101011010%27%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20see%20the%20BGE%28%29%20description%20for%20an%20extended%20description%0D%0A%20%20%20%20%20%20%20%20%20%21%20of%20related%20information%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fblt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> blt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_blt
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer            :: i
      integer(kind=int8) :: byte
        ! Compare some one-byte values to 64.
         ! Notice that the values are tested as bits not as integers
         ! so sign bits in the integer are treated just like any other
         do i=-128,127,32
            byte=i
            write(*,'(sp,i0.4,*(1x,1l,1x,b0.8))')i,blt(byte,64_int8),byte
         enddo
        ! BOZ literals
         write(*,*)blt(z'1000', z'101011010')
         ! see the BGE() description for an extended description
         ! of related information

      end program demo_blt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fbtest%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2C%20j%2C%20pos%2C%20a%282%2C2%29%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20bool%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28%2A%28g0%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20i%20%3D%2032768%20%2B%201024%20%2B%2064%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Ci0%2C%22%3D%3E%22%2Cb32%2E32%2C%2F%29%27%29%27Looking%20at%20the%20integer%3A%20%27%2Ci%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20looking%20one%20bit%20at%20a%20time%20from%20LOW%20BIT%20TO%20HIGH%20BIT%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27from%20bit%200%20to%20bit%20%27%2Cbit%5Fsize%28i%29%2C%27%3D%3D%3E%27%0D%0A%20%20%20%20%20%20%20%20%20%20do%20pos%3D0%2Cbit%5Fsize%28i%29%2D1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20bool%20%3D%20btest%28i%2C%20pos%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28l1%29%27%2Cadvance%3D%27no%27%29bool%0D%0A%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20a%20binary%20format%20the%20hard%20way%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20Note%20going%20from%20bit%5Fsize%28i%29%20to%20zero%2E%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27so%20for%20%27%2Ci%2C%27%20with%20a%20bit%20size%20of%20%27%2Cbit%5Fsize%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29i%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29merge%28%27%5E%27%2C%27%5F%27%2C%5B%28btest%28i%2Cj%29%2Cj%3Dbit%5Fsize%28i%29%2D1%2C0%2C%2D1%29%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27and%20for%20%27%2C%2Di%2C%27%20with%20a%20bit%20size%20of%20%27%2Cbit%5Fsize%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29%2Di%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29merge%28%27%5E%27%2C%27%5F%27%2C%5B%28btest%28%2Di%2Cj%29%2Cj%3Dbit%5Fsize%28i%29%2D1%2C0%2C%2D1%29%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20elemental%3A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%20a%281%2C%3A%29%3D%5B%201%2C%202%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20a%282%2C%3A%29%3D%5B%203%2C%204%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2F%2C%2A%28i2%2C1x%2Ci2%2C%2F%29%29%27%29%27given%20the%20array%20a%20%2E%2E%2E%27%2Ca%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20second%20bit%20of%20all%20the%20values%20in%20a%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2F%2C%2A%28l2%2C1x%2Cl2%2C%2F%29%29%27%29%27the%20value%20of%20btest%20%28a%2C%202%29%27%2Cbtest%28a%2C2%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20bits%201%2C2%2C3%2C4%20of%20the%20value%202%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2F%2C%2A%28l2%2C1x%2Cl2%2C%2F%29%29%27%29%27the%20value%20of%20btest%20%282%2C%20a%29%27%2Cbtest%282%2Ca%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fbtest%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> btest
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_btest
      implicit none
      integer :: i, j, pos, a(2,2)
      logical :: bool
      character(len=*),parameter :: g='(*(g0))'

           i = 32768 + 1024 + 64
          write(*,'(a,i0,"=>",b32.32,/)')'Looking at the integer: ',i

          ! looking one bit at a time from LOW BIT TO HIGH BIT
          write(*,g)'from bit 0 to bit ',bit_size(i),'==>'
          do pos=0,bit_size(i)-1
              bool = btest(i, pos)
              write(*,'(l1)',advance='no')bool
          enddo
          write(*,*)

          ! a binary format the hard way.
          ! Note going from bit_size(i) to zero.
          write(*,*)
          write(*,g)'so for ',i,' with a bit size of ',bit_size(i)
          write(*,'(b32.32)')i
          write(*,g)merge('^','_',[(btest(i,j),j=bit_size(i)-1,0,-1)])
          write(*,*)
          write(*,g)'and for ',-i,' with a bit size of ',bit_size(i)
          write(*,'(b32.32)')-i
          write(*,g)merge('^','_',[(btest(-i,j),j=bit_size(i)-1,0,-1)])

          ! elemental:
          !
          a(1,:)=[ 1, 2 ]
          a(2,:)=[ 3, 4 ]
          write(*,*)
          write(*,'(a,/,*(i2,1x,i2,/))')'given the array a ...',a
          ! the second bit of all the values in a
          write(*,'(a,/,*(l2,1x,l2,/))')'the value of btest (a, 2)',btest(a,2)
          ! bits 1,2,3,4 of the value 2
          write(*,'(a,/,*(l2,1x,l2,/))')'the value of btest (2, a)',btest(2,a)
      end program demo_btest
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fc%5Fassociated%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20association%5Ftest%28a%2Cb%29%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%2C%20only%3A%20c%5Fassociated%2C%20c%5Floc%2C%20c%5Fptr%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%2C%20pointer%20%3A%3A%20a%0D%0A%20%20%20%20%20%20type%28c%5Fptr%29%20%3A%3A%20b%0D%0A%20%20%20%20%20%20%20%20%20if%28c%5Fassociated%28b%2C%20c%5Floc%28a%29%29%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27b%20and%20a%20do%20not%20point%20to%20same%20target%27%0D%0A%20%20%20%20%20%20end%20subroutine%20association%5Ftest%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fc%5Fassociated%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_associated
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_c_associated

      contains

      subroutine association_test(a,b)
      use iso_c_binding, only: c_associated, c_loc, c_ptr
      implicit none
      real, pointer :: a
      type(c_ptr) :: b
         if(c_associated(b, c_loc(a))) &
            stop 'b and a do not point to same target'
      end subroutine association_test

      end program demo_c_associated
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fceiling%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%20just%20a%20convenient%20format%20for%20a%20list%20of%20integers%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20ints%3D%27%28%2A%28%22%20%20%20%3E%20%22%2C5%28i0%3A%2C%22%2C%22%2C1x%29%2C%2F%29%29%27%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%0D%0A%20%20%20%20%20%20real%20%3A%3A%20y%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%2063%2E29%0D%0A%20%20%20%20%20%20%20%20%20y%20%3D%20%2D63%2E59%0D%0A%20%20%20%20%20%20%20%20%20print%20ints%2C%20ceiling%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20ints%2C%20ceiling%28y%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20the%20result%20was%20the%20next%20integer%20larger%20to%20the%20right%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20real%20values%20equal%20to%20whole%20numbers%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%2063%2E0%0D%0A%20%20%20%20%20%20%20%20%20y%20%3D%20%2D63%2E0%0D%0A%20%20%20%20%20%20%20%20%20print%20ints%2C%20ceiling%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20ints%2C%20ceiling%28y%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%20%28so%20an%20array%20argument%20is%20allowed%29%0D%0A%20%20%20%20%20%20%20%20%20print%20ints%20%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20ceiling%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2D2%2E7%2C%20%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2D1%2E0%2C%20%20%2D0%2E5%2C%20%200%2E0%2C%20%2B0%2E5%2C%20%2B1%2E0%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2B1%2E5%2C%20%20%2B2%2E0%2C%20%2B2%2E2%2C%20%2B2%2E5%2C%20%2B2%2E7%20%20%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fceiling%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ceiling
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ceiling
      implicit none
      ! just a convenient format for a list of integers
      character(len=*),parameter :: ints='(*("   > ",5(i0:,",",1x),/))'
      real :: x
      real :: y
        ! basic usage
         x = 63.29
         y = -63.59
         print ints, ceiling(x)
         print ints, ceiling(y)
         ! note the result was the next integer larger to the right

        ! real values equal to whole numbers
         x = 63.0
         y = -63.0
         print ints, ceiling(x)
         print ints, ceiling(y)

        ! elemental (so an array argument is allowed)
         print ints , &
         & ceiling([ &
         &  -2.7,  -2.5, -2.2, -2.0, -1.5, &
         &  -1.0,  -0.5,  0.0, +0.5, +1.0, &
         &  +1.5,  +2.0, +2.2, +2.5, +2.7  ])

      end program demo_ceiling
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fc%5Ff%5Fpointer%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20interface%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20my%5Froutine%28p%29%20bind%28c%2Cname%3D%27myC%5Ffunc%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20import%20%3A%3A%20c%5Fptr%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20type%28c%5Fptr%29%2C%20intent%28out%29%20%3A%3A%20p%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20type%28c%5Fptr%29%20%3A%3A%20cptr%0D%0A%20%20%20%20%20%20real%2Cpointer%20%3A%3A%20a%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20call%20my%5Froutine%28cptr%29%0D%0A%20%20%20%20%20%20%20%20%20call%20c%5Ff%5Fpointer%28cptr%2C%20a%2C%20%5B12%5D%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fc%5Ff%5Fpointer%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_f_pointer
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_c_f_pointer
      use iso_c_binding
      implicit none
      interface
         subroutine my_routine(p) bind(c,name='myC_func')
            import :: c_ptr
            type(c_ptr), intent(out) :: p
         end subroutine
      end interface
      type(c_ptr) :: cptr
      real,pointer :: a(:)
         call my_routine(cptr)
         call c_f_pointer(cptr, a, [12])
      end program demo_c_f_pointer
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fc%5Ff%5Fprocpointer%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20abstract%20interface%0D%0A%20%20%20%20%20%20%20%20%20function%20func%28a%29%0D%0A%20%20%20%20%20%20%20%20%20import%20%3A%3A%20c%5Ffloat%0D%0A%20%20%20%20%20%20%20%20%20real%28c%5Ffloat%29%2C%20intent%28in%29%20%3A%3A%20a%0D%0A%20%20%20%20%20%20%20%20%20real%28c%5Ffloat%29%20%3A%3A%20func%0D%0A%20%20%20%20%20%20%20%20%20end%20function%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20interface%0D%0A%20%20%20%20%20%20%20%20%20function%20getIterFunc%28%29%20bind%28c%2Cname%3D%22getIterFunc%22%29%0D%0A%20%20%20%20%20%20%20%20%20import%20%3A%3A%20c%5Ffunptr%0D%0A%20%20%20%20%20%20%20%20%20type%28c%5Ffunptr%29%20%3A%3A%20getIterFunc%0D%0A%20%20%20%20%20%20%20%20%20end%20function%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20type%28c%5Ffunptr%29%20%3A%3A%20cfunptr%0D%0A%20%20%20%20%20%20procedure%28func%29%2C%20pointer%20%3A%3A%20myFunc%0D%0A%20%20%20%20%20%20%20%20%20cfunptr%20%3D%20getIterFunc%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20c%5Ff%5Fprocpointer%28cfunptr%2C%20myFunc%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fc%5Ff%5Fprocpointer%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_f_procpointer
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_c_f_procpointer
      use iso_c_binding
      implicit none
      abstract interface
         function func(a)
         import :: c_float
         real(c_float), intent(in) :: a
         real(c_float) :: func
         end function
      end interface
      interface
         function getIterFunc() bind(c,name="getIterFunc")
         import :: c_funptr
         type(c_funptr) :: getIterFunc
         end function
      end interface
      type(c_funptr) :: cfunptr
      procedure(func), pointer :: myFunc
         cfunptr = getIterFunc()
         call c_f_procpointer(cfunptr, myFunc)
      end program demo_c_f_procpointer
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%21%20program%20demo%5Fc%5Ffunloc%20and%20module%0D%0A%20%20%20%20%20%20module%20x%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20subroutine%20sub%28a%29%20bind%28c%29%0D%0A%20%20%20%20%20%20real%28c%5Ffloat%29%20%3A%3A%20a%0D%0A%20%20%20%20%20%20%20%20%20a%20%3D%20sqrt%28a%29%2B5%2E0%0D%0A%20%20%20%20%20%20end%20subroutine%20sub%0D%0A%20%20%20%20%20%20end%20module%20x%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20program%20demo%5Fc%5Ffunloc%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%0D%0A%20%20%20%20%20%20use%20x%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20interface%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20my%5Froutine%28p%29%20bind%28c%2Cname%3D%27myC%5Ffunc%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20import%20%3A%3A%20c%5Ffunptr%0D%0A%20%20%20%20%20%20%20%20%20%20%20type%28c%5Ffunptr%29%2C%20intent%28in%29%20%3A%3A%20p%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20%20%20%20call%20my%5Froutine%28c%5Ffunloc%28sub%29%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fc%5Ffunloc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_funloc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      ! program demo_c_funloc and module
      module x
      use iso_c_binding
      implicit none
      contains
      subroutine sub(a) bind(c)
      real(c_float) :: a
         a = sqrt(a)+5.0
      end subroutine sub
      end module x
      !
      program demo_c_funloc
      use iso_c_binding
      use x
      implicit none
      interface
         subroutine my_routine(p) bind(c,name='myC_func')
           import :: c_funptr
           type(c_funptr), intent(in) :: p
         end subroutine
      end interface
         call my_routine(c_funloc(sub))
      !
      end program demo_c_funloc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fchar%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20ascii%20%3D%20%20selected%5Fchar%5Fkind%20%28%22ascii%22%29%0D%0A%20%20%20%20%20%20character%28len%3D1%2C%20kind%3Dascii%20%29%20%3A%3A%20c%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%21%20basic%0D%0A%20%20%20%20%20%20%20%20%20i%3D74%0D%0A%20%20%20%20%20%20%20%20%20c%3Dchar%28i%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ASCII%20character%20%27%2Ci%2C%27is%20%27%2Cc%0D%0A%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27a%20selection%20of%20ASCII%20characters%20%28shows%20hex%20if%20not%20printable%29%27%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D0%2C127%2C10%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20c%20%3D%20char%28i%2Ckind%3Dascii%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20select%20case%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%2832%3A126%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i3%2C1x%2Ca%29%27%29i%2Cc%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%280%3A31%2C127%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20print%20hexadecimal%20value%20for%20unprintable%20characters%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i3%2C1x%2Cz2%2E2%29%27%29i%2Cc%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i3%2C1x%2Ca%2C1x%2Ca%29%27%29i%2Cc%2C%27non%2Dstandard%20ASCII%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fchar%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> char
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_char
      implicit none
      integer, parameter :: ascii =  selected_char_kind ("ascii")
      character(len=1, kind=ascii ) :: c
      integer :: i
        ! basic
         i=74
         c=char(i)
         write(*,*)'ASCII character ',i,'is ',c
        !
         print *, 'a selection of ASCII characters (shows hex if not printable)'
         do i=0,127,10
            c = char(i,kind=ascii)
            select case(i)
            case(32:126)
               write(*,'(i3,1x,a)')i,c
            case(0:31,127)
               ! print hexadecimal value for unprintable characters
               write(*,'(i3,1x,z2.2)')i,c
            case default
               write(*,'(i3,1x,a,1x,a)')i,c,'non-standard ASCII'
            end select
         enddo

      end program demo_char
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_loc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20program%20demo%5Fclose%20implicit%20none%20character%28len%3D256%29%20%3A%3A%20message%20integer%20%3A%3A%0D%0A%20%20ios%20open%20%2810%2C%20file%3D%27employee%2Enames%27%2C%20action%3D%27read%27%2C%0D%0A%20%20iostat%3Dios%2Ciomsg%3Dmessage%29%20if%20%28ios%20%3C%200%29%20then%20%21%20perform%20end%2Dof%2Dfile%20processing%0D%0A%20%20on%20the%20file%20connected%20to%20unit%2010%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20close%20%2810%2C%20status%3D%27keep%27%2Ciostat%3Dios%2Ciomsg%3Dmessage%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20if%28ios%2Ene%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28a%29%29%27%29%27%2Ademo%5Fclose%2A%20close%20error%3A%20%27%2Ctrim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%201%0D%0A%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20elseif%20%28ios%20%3E%200%29%20then%20%21%20perform%20error%20processing%20on%20open%0D%0A%20%20write%28%2A%2C%27%28%2A%28a%29%29%27%29%27%2Ademo%5Fclose%2A%20open%20error%3A%20%27%2Ctrim%28message%29%20stop%202%20endif%0D%0A%0D%0A%20%20end%20program%20demo%5Fclose%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> close
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  program demo_close implicit none character(len=256) :: message integer ::
  ios open (10, file='employee.names', action='read',
  iostat=ios,iomsg=message) if (ios < 0) then ! perform end-of-file processing
  on the file connected to unit 10.

           close (10, status='keep',iostat=ios,iomsg=message)
           if(ios.ne.0)then
              write(*,'(*(a))')'*demo_close* close error: ',trim(message)
              stop 1
           endif
  elseif (ios > 0) then ! perform error processing on open
  write(*,'(*(a))')'*demo_close* open error: ',trim(message) stop 2 endif

  end program demo_close
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Faimag%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20dp%3Dkind%280%2E0d0%29%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%20%20%20%20%3A%3A%20precise%0D%0A%20%20%20%20%20%20complex%28kind%3Ddp%29%20%20%3A%3A%20z8%0D%0A%20%20%20%20%20%20complex%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20z4%2C%20zthree%283%29%0D%0A%20%20%20%20%20%20%20%20%20precise%3D1%2E2345678901234567d0%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%0D%0A%20%20%20%20%20%20%20%20%20z4%20%3D%20cmplx%28%2D3%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27Z4%3D%27%2Cz4%0D%0A%20%20%20%20%20%20%20%20%20z4%20%3D%20cmplx%281%2E23456789%2C%201%2E23456789%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27Z4%3D%27%2Cz4%0D%0A%20%20%20%20%20%20%20%20%20%21%20with%20a%20format%20treat%20a%20complex%20as%20two%20real%20values%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%281x%2Cg0%2C1x%2Cg0%2C1x%2Cg0%29%27%2C%27Z4%3D%27%2Cz4%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20working%20with%20higher%20precision%20values%0D%0A%20%20%20%20%20%20%20%20%20%21%20using%20kind%3Ddp%20makes%20it%20keep%20DOUBLEPRECISION%20precision%0D%0A%20%20%20%20%20%20%20%20%20%21%20otherwise%20the%20result%20would%20be%20of%20default%20kind%0D%0A%20%20%20%20%20%20%20%20%20z8%20%3D%20cmplx%28precise%2C%20%2Dprecise%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27lost%20precision%20Z8%3D%27%2Cz8%0D%0A%20%20%20%20%20%20%20%20%20z8%20%3D%20cmplx%28precise%2C%20%2Dprecise%20%2Ckind%3Ddp%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27kept%20precision%20Z8%3D%27%2Cz8%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20assignment%20of%20constant%20values%20does%20not%20require%20cmplx%283%2900%0D%0A%20%20%20%20%20%20%20%20%20%21%20The%20following%20is%20intuitive%20and%20works%20without%20calling%20cmplx%283%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20but%20does%20not%20work%20for%20variables%20just%20constants%0D%0A%20%20%20%20%20%20%20%20%20z8%20%3D%20%281%2E1111111111111111d0%2C%202%2E2222222222222222d0%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27Z8%20defined%20with%20constants%3D%27%2Cz8%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20what%20happens%20when%20you%20assign%20a%20complex%20to%20a%20real%3F%0D%0A%20%20%20%20%20%20%20%20%20precise%3Dz8%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27LHS%3D%27%2Cprecise%2C%27RHS%3D%27%2Cz8%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20zthree%3Dcmplx%28%5B10%2C20%2C30%5D%2C%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27zthree%3D%27%2Czthree%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20descriptors%20are%20an%20alternative%0D%0A%20%20%20%20%20%20%20%20%20zthree%281%3A2%29%25re%3D%5B100%2C200%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27zthree%3D%27%2Czthree%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Faimag%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> cmplx
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_aimag
      implicit none
      integer,parameter :: dp=kind(0.0d0)
      real(kind=dp)     :: precise
      complex(kind=dp)  :: z8
      complex           :: z4, zthree(3)
         precise=1.2345678901234567d0

        ! basic
         z4 = cmplx(-3)
         print *, 'Z4=',z4
         z4 = cmplx(1.23456789, 1.23456789)
         print *, 'Z4=',z4
         ! with a format treat a complex as two real values
         print '(1x,g0,1x,g0,1x,g0)','Z4=',z4

        ! working with higher precision values
         ! using kind=dp makes it keep DOUBLEPRECISION precision
         ! otherwise the result would be of default kind
         z8 = cmplx(precise, -precise )
         print *, 'lost precision Z8=',z8
         z8 = cmplx(precise, -precise ,kind=dp)
         print *, 'kept precision Z8=',z8

        ! assignment of constant values does not require cmplx(3)00
         ! The following is intuitive and works without calling cmplx(3)
         ! but does not work for variables just constants
         z8 = (1.1111111111111111d0, 2.2222222222222222d0 )
         print *, 'Z8 defined with constants=',z8

        ! what happens when you assign a complex to a real?
         precise=z8
         print *, 'LHS=',precise,'RHS=',z8

        ! elemental
         zthree=cmplx([10,20,30],-1)
         print *, 'zthree=',zthree

        ! descriptors are an alternative
         zthree(1:2)%re=[100,200]
         print *, 'zthree=',zthree

      end program demo_aimag
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fco%5Fbroadcast%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20val%283%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20val%20%3D%20%5B1%2C%205%2C%203%5D%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20call%20co%5Fbroadcast%20%28val%2C%20source%5Fimage%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20this%5Fimage%28%29%2C%20%22%3A%22%2C%20val%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fco%5Fbroadcast%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> co_broadcast
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_co_broadcast
      implicit none
      integer :: val(3)
         if (this_image() == 1) then
            val = [1, 5, 3]
         endif
         call co_broadcast (val, source_image=1)
         print *, this_image(), ":", val
      end program demo_co_broadcast
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fco%5Fmax%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20val%0D%0A%20%20%20%20%20%20%20%20%20val%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20co%5Fmax%28val%2C%20result%5Fimage%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%22Maximal%20value%22%2C%20val%20%20%21%20prints%20num%5Fimages%28%29%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fco%5Fmax%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> co_max
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_co_max
      implicit none
      integer :: val
         val = this_image()
         call co_max(val, result_image=1)
         if (this_image() == 1) then
           write(*,*) "Maximal value", val  ! prints num_images()
         endif
      end program demo_co_max
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fco%5Fmin%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20val%0D%0A%20%20%20%20%20%20%20%20%20val%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20co%5Fmin%28val%2C%20result%5Fimage%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%22Minimal%20value%22%2C%20val%20%20%21%20prints%201%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fco%5Fmin%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> co_min
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_co_min
      implicit none
      integer :: val
         val = this_image()
         call co_min(val, result_image=1)
         if (this_image() == 1) then
           write(*,*) "Minimal value", val  ! prints 1
         endif
      end program demo_co_min
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcommand%5Fargument%5Fcount%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20count%0D%0A%20%20%20%20%20%20%20%20%20count%20%3D%20command%5Fargument%5Fcount%28%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20count%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcommand%5Fargument%5Fcount%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> command_argument_count
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_command_argument_count
      implicit none
      integer :: count
         count = command_argument_count()
         print *, count
      end program demo_command_argument_count
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcompiler%5Fversion%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20compiler%5Fversion%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20compiler%5Foptions%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%284a%29%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%27This%20file%20was%20compiled%20by%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20compiler%5Fversion%28%29%2C%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%27%20using%20the%20options%20%27%2C%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20compiler%5Foptions%28%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcompiler%5Fversion%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> compiler_options
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_compiler_version
      use, intrinsic :: iso_fortran_env, only : compiler_version
      use, intrinsic :: iso_fortran_env, only : compiler_options
      implicit none
         print '(4a)', &
            'This file was compiled by ', &
            compiler_version(),           &
            ' using the options ',        &
            compiler_options()
      end program demo_compiler_version
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcompiler%5Fversion%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20compiler%5Fversion%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%282a%29%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%27This%20file%20was%20compiled%20by%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20compiler%5Fversion%28%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcompiler%5Fversion%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> compiler_version
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_compiler_version
      use, intrinsic :: iso_fortran_env, only : compiler_version
      implicit none
         print '(2a)', &
            'This file was compiled by ', &
            compiler_version()
      end program demo_compiler_version
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fconjg%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20z%20%3D%20%282%2E0%2C%203%2E0%29%0D%0A%20%20%20%20%20%20complex%28kind%3Dreal64%29%20%3A%3A%20dz%20%3D%20%28%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%201%2E2345678901234567%5Freal64%2C%20%2D1%2E2345678901234567%5Freal64%29%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20arr%283%2C3%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20notice%20the%20sine%20of%20the%20imaginary%20component%20changes%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20z%2C%20conjg%28z%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20any%20complex%20kind%20is%20supported%2E%20z%20is%20of%20default%20kind%20but%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20dz%20is%20kind%3Dreal64%2E%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dz%0D%0A%20%20%20%20%20%20%20%20%20%20dz%20%3D%20conjg%28dz%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dz%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20function%20is%20elemental%20so%20it%20can%20take%20arrays%0D%0A%20%20%20%20%20%20%20%20%20%20arr%281%2C%3A%29%3D%5B%28%2D1%2E0%2C%202%2E0%29%2C%28%203%2E0%2C%204%2E0%29%2C%28%205%2E0%2C%2D6%2E0%29%5D%0D%0A%20%20%20%20%20%20%20%20%20%20arr%282%2C%3A%29%3D%5B%28%207%2E0%2C%2D8%2E0%29%2C%28%208%2E0%2C%209%2E0%29%2C%28%209%2E0%2C%209%2E0%29%5D%0D%0A%20%20%20%20%20%20%20%20%20%20arr%283%2C%3A%29%3D%5B%28%201%2E0%2C%209%2E0%29%2C%28%202%2E0%2C%200%2E0%29%2C%28%2D3%2E0%2C%2D7%2E0%29%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27original%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%283%28%22%28%22%2Cg8%2E2%2C%22%2C%22%2Cg8%2E2%2C%22%29%22%2C1x%29%29%27%29%28arr%28i%2C%3A%29%2Ci%3D1%2C3%29%0D%0A%20%20%20%20%20%20%20%20%20%20arr%20%3D%20conjg%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27conjugate%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%283%28%22%28%22%2Cg8%2E2%2C%22%2C%22%2Cg8%2E2%2C%22%29%22%2C1x%29%29%27%29%28arr%28i%2C%3A%29%2Ci%3D1%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fconjg%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> conjg
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_conjg
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
      implicit none
      complex :: z = (2.0, 3.0)
      complex(kind=real64) :: dz = (   &
         &  1.2345678901234567_real64, -1.2345678901234567_real64)
      complex :: arr(3,3)
      integer :: i
         ! basics
          ! notice the sine of the imaginary component changes
          print *, z, conjg(z)

          ! any complex kind is supported. z is of default kind but
          ! dz is kind=real64.
          print *, dz
          dz = conjg(dz)
          print *, dz
          print *

          ! the function is elemental so it can take arrays
          arr(1,:)=[(-1.0, 2.0),( 3.0, 4.0),( 5.0,-6.0)]
          arr(2,:)=[( 7.0,-8.0),( 8.0, 9.0),( 9.0, 9.0)]
          arr(3,:)=[( 1.0, 9.0),( 2.0, 0.0),(-3.0,-7.0)]

          write(*,*)'original'
          write(*,'(3("(",g8.2,",",g8.2,")",1x))')(arr(i,:),i=1,3)
          arr = conjg(arr)
          write(*,*)'conjugate'
          write(*,'(3("(",g8.2,",",g8.2,")",1x))')(arr(i,:),i=1,3)

      end program demo_conjg
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcontinue%0D%0A%20%20%20%20%20%20%21%20numbered%20targets%20should%20%28almost%3F%29%20always%20be%20a%20continue%20statement%0D%0A%20%20%20%20%20%20%21%20with%20a%20unique%20label%20for%20each%20looping%20structure%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2Cj%0D%0A%20%20%20%20%20%20%20%20j%3D5%0D%0A%20%20%20%20%20%20%20%20do%20100%20i%3D1%2C20%0D%0A%20%20%20%20%20%20%20%20%20%20%20if%28i%2Elt%2E5%29goto%2050%0D%0A%20%20%20%20%20%20%20%20%20%20%20j%3D3%0D%0A%20%20%20%20%20%20%20%20%20%20%2050%20continue%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27J%3D%27%2Cj%0D%0A%20%20%20%20%20%20%20%20100%20continue%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcontinue%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> continue
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_continue
      ! numbered targets should (almost?) always be a continue statement
      ! with a unique label for each looping structure
      integer :: i,j
        j=5
        do 100 i=1,20
           if(i.lt.5)goto 50
           j=3
           50 continue
           write(*,*)'J=',j
        100 continue
      end program demo_continue
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fco%5Freduce%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20val%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20val%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20co%5Freduce%28val%2C%20myprod%2C%201%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%22Product%20value%22%2C%20val%20%20%21%20prints%20num%5Fimages%28%29%20factorial%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20pure%20function%20myprod%28a%2C%20b%29%0D%0A%20%20%20%20%20%20%20%20%20integer%2C%20value%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20myprod%0D%0A%20%20%20%20%20%20%20%20%20myprod%20%3D%20a%20%2A%20b%0D%0A%20%20%20%20%20%20end%20function%20myprod%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fco%5Freduce%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> co_reduce
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_co_reduce
      implicit none
      integer :: val

         val = this_image()
         call co_reduce(val, myprod, 1)
         if (this_image() == 1) then
            write(*,*) "Product value", val  ! prints num_images() factorial
         endif

      contains

      pure function myprod(a, b)
         integer, value :: a, b
         integer :: myprod
         myprod = a * b
      end function myprod

      end program demo_co_reduce
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcos%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g2%3D%27%28a%2Ct20%2Cg0%29%27%0D%0A%20%20%20%20%20%20doubleprecision%2Cparameter%20%3A%3A%20PI%3Datan%281%2E0d0%29%2A4%2E0d0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%280%2E0%29%3D%27%2Ccos%280%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%28PI%29%3D%27%2Ccos%28PI%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%28PI%2F2%2E0d0%29%3D%27%2Ccos%28PI%2F2%2E0d0%29%2C%27EPSILON%3D%27%2Cepsilon%28PI%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%282%2API%29%3D%27%2Ccos%282%2API%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%28%2D2%2API%29%3D%27%2Ccos%28%2D2%2API%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%28%2D2000%2API%29%3D%27%2Ccos%28%2D2000%2API%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg2%29%27COS%283000%2API%29%3D%27%2Ccos%283000%2API%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcos%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> cos
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_cos
      implicit none
      character(len=*),parameter :: g2='(a,t20,g0)'
      doubleprecision,parameter :: PI=atan(1.0d0)*4.0d0
         write(*,g2)'COS(0.0)=',cos(0.0)
         write(*,g2)'COS(PI)=',cos(PI)
         write(*,g2)'COS(PI/2.0d0)=',cos(PI/2.0d0),'EPSILON=',epsilon(PI)
         write(*,g2)'COS(2*PI)=',cos(2*PI)
         write(*,g2)'COS(-2*PI)=',cos(-2*PI)
         write(*,g2)'COS(-2000*PI)=',cos(-2000*PI)
         write(*,g2)'COS(3000*PI)=',cos(3000*PI)
      end program demo_cos
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcosh%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27X%3D%27%2Cx%2C%27COSH%28X%3D%29%27%2Ccosh%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcosh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> cosh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_cosh
      use, intrinsic :: iso_fortran_env, only : &
       & real_kinds, real32, real64, real128
      implicit none
      real(kind=real64) :: x = 1.0_real64
          write(*,*)'X=',x,'COSH(X=)',cosh(x)
      end program demo_cosh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fco%5Fsum%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20val%0D%0A%20%20%20%20%20%20%20%20%20val%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20co%5Fsum%28val%2C%20result%5Fimage%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20prints%20%28n%2A%2A2%20%2B%20n%29%2F2%2C%20with%20n%20%3D%20num%5Fimages%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%22The%20sum%20is%20%22%2C%20val%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fco%5Fsum%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> co_sum
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_co_sum
      implicit none
      integer :: val
         val = this_image()
         call co_sum(val, result_image=1)
         if (this_image() == 1) then
            ! prints (n**2 + n)/2, with n = num_images()
            write(*,*) "The sum is ", val
         endif
      end program demo_co_sum
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcount%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20ints%3D%27%28%2A%28i2%2C1x%29%29%27%0D%0A%20%20%20%20%20%20%21%20two%20arrays%20and%20a%20mask%20all%20with%20the%20same%20shape%0D%0A%20%20%20%20%20%20integer%2C%20dimension%282%2C3%29%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20logical%2C%20dimension%282%2C3%29%20%3A%3A%20mymask%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20c%282%2C3%2C4%29%0D%0A%0D%0A%20%20%20%20%20%20print%20%2A%2C%27the%20numeric%20arrays%20we%20will%20compare%27%0D%0A%20%20%20%20%20%20a%20%3D%20reshape%28%20%5B%201%2C%202%2C%203%2C%204%2C%205%2C%206%20%5D%2C%20%5B%202%2C%203%20%5D%29%0D%0A%20%20%20%20%20%20b%20%3D%20reshape%28%20%5B%200%2C%207%2C%203%2C%204%2C%205%2C%208%20%5D%2C%20%5B%202%2C%203%20%5D%29%0D%0A%20%20%20%20%20%20c%20%3D%20reshape%28%20%5B%28%20i%2Ci%3D1%2C24%29%5D%2C%20%5B%202%2C%203%20%2C4%5D%29%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20a%281%2C%3A%29%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20a%282%2C%3A%29%0D%0A%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20b%281%2C%3A%29%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20b%282%2C%3A%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20basic%20calls%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27count%20a%20few%20basic%20things%20creating%20a%20mask%20from%20an%20expression%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27count%20a%3Eb%27%2Ccount%28a%3Eb%29%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27count%20b%3Ca%27%2Ccount%28a%3Cb%29%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27count%20b%3D%3Da%27%2Ccount%28a%3D%3Db%29%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27check%20sum%20%3D%20%27%2Ccount%28a%3Eb%29%20%2B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20count%28a%3Cb%29%20%2B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20count%28a%3D%3Db%29%2Eeq%2Esize%28a%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20The%20common%20usage%20is%20just%20getting%20a%20count%2C%20but%20if%20you%20want%0D%0A%20%20%20%20%20%20%21%20to%20specify%20the%20DIM%20argument%20and%20get%20back%20reduced%20arrays%0D%0A%20%20%20%20%20%20%21%20of%20counts%20this%20is%20easier%20to%20visualize%20if%20we%20look%20at%20a%20mask%2E%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27make%20a%20mask%20identifying%20unequal%20elements%20%2E%2E%2E%27%0D%0A%20%20%20%20%20%20mymask%20%3D%20a%2Ene%2Eb%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27the%20mask%20generated%20from%20a%2Ene%2Eb%27%0D%0A%20%20%20%20%20%20print%20%27%283l3%29%27%2C%20mymask%281%2C%3A%29%0D%0A%20%20%20%20%20%20print%20%27%283l3%29%27%2C%20mymask%282%2C%3A%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20print%20%2A%2C%27count%20total%20and%20along%20rows%20and%20columns%20%2E%2E%2E%27%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27number%20of%20elements%20not%20equal%27%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27%28ie%2E%20total%20true%20elements%20in%20the%20mask%29%27%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20count%28mymask%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27count%20of%20elements%20not%20equal%20in%20each%20column%27%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27%28ie%2E%20total%20true%20elements%20in%20each%20column%29%27%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20count%28mymask%2C%20dim%3D1%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27count%20of%20elements%20not%20equal%20in%20each%20row%27%0D%0A%20%20%20%20%20%20print%20%27%28a%29%27%2C%20%27%28ie%2E%20total%20true%20elements%20in%20each%20row%29%27%0D%0A%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20count%28mymask%2C%20dim%3D2%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20working%20with%20rank%3D3%20%2E%2E%2E%0D%0A%20%20%20%20%20%20print%20%2A%2C%20%27lets%20try%20this%20with%20c%282%2C3%2C4%29%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20taking%20the%20result%20of%20the%20modulo%20%20%20%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20%20z%3D1%20%20%20%20%20%20z%3D2%20%20%20%20%20%20z%3D3%20%20%20%20%20%20z%3D4%20%20%20%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%201%203%200%20%7C%7C%202%204%201%20%7C%7C%203%200%202%20%7C%7C%204%201%203%20%7C%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%202%204%201%20%7C%7C%203%200%202%20%7C%7C%204%201%203%20%7C%7C%200%202%204%20%7C%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20would%20result%20in%20the%20mask%20%2E%2E%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20F%20F%20T%20%7C%7C%20F%20F%20F%20%7C%7C%20F%20T%20F%20%7C%7C%20F%20F%20F%20%7C%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20F%20F%20F%20%7C%7C%20F%20T%20F%20%7C%7C%20F%20F%20F%20%7C%7C%20T%20F%20F%20%7C%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20print%20%2A%2C%27%20the%20total%20number%20of%20%2Etrue%2Evalues%20is%27%0D%0A%20%20%20%20%20%20print%20ints%2C%20count%28modulo%28c%2C5%29%2Eeq%2E0%29%0D%0A%20%20%20%20%20%20call%20printi%28%27counting%20up%20along%20a%20row%20and%20removing%20rows%27%2C%26%0D%0A%20%20%20%20%20%20count%28modulo%28c%2C5%29%2Eeq%2E0%2Cdim%3D1%29%29%0D%0A%20%20%20%20%20%20call%20printi%28%27counting%20up%20along%20a%20column%20and%20removing%20columns%27%2C%26%0D%0A%20%20%20%20%20%20count%28modulo%28c%2C5%29%2Eeq%2E0%2Cdim%3D2%29%29%0D%0A%20%20%20%20%20%20call%20printi%28%27counting%20up%20along%20a%20depth%20and%20removing%20depths%27%2C%26%0D%0A%20%20%20%20%20%20count%28modulo%28c%2C5%29%2Eeq%2E0%2Cdim%3D3%29%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20CONVENIENCE%20ROUTINE%20FOR%20PRINTING%20SMALL%20INTEGER%20MATRICES%0D%0A%20%20%20%20%20%20subroutine%20printi%28title%2Carr%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%20%21%20a%20handy%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20print%20all%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20trim%28title%29%2C%27%3A%28%27%2Cshape%28arr%29%2C%27%29%27%20%20%21%20print%20title%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20subroutine%20printi%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcount%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> count
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_count
      implicit none
      character(len=*),parameter :: ints='(*(i2,1x))'
      ! two arrays and a mask all with the same shape
      integer, dimension(2,3) :: a, b
      logical, dimension(2,3) :: mymask
      integer :: i
      integer :: c(2,3,4)

      print *,'the numeric arrays we will compare'
      a = reshape( [ 1, 2, 3, 4, 5, 6 ], [ 2, 3 ])
      b = reshape( [ 0, 7, 3, 4, 5, 8 ], [ 2, 3 ])
      c = reshape( [( i,i=1,24)], [ 2, 3 ,4])
      print '(3i3)', a(1,:)
      print '(3i3)', a(2,:)
      print *
      print '(3i3)', b(1,:)
      print '(3i3)', b(2,:)
      !
      ! basic calls
      print *, 'count a few basic things creating a mask from an expression'
      print *, 'count a>b',count(a>b)
      print *, 'count b<a',count(a<b)
      print *, 'count b==a',count(a==b)
      print *, 'check sum = ',count(a>b) + &
                            & count(a<b) + &
                            & count(a==b).eq.size(a)
      !
      ! The common usage is just getting a count, but if you want
      ! to specify the DIM argument and get back reduced arrays
      ! of counts this is easier to visualize if we look at a mask.
      print *, 'make a mask identifying unequal elements ...'
      mymask = a.ne.b
      print *, 'the mask generated from a.ne.b'
      print '(3l3)', mymask(1,:)
      print '(3l3)', mymask(2,:)
      !
      print *,'count total and along rows and columns ...'
      !
      print '(a)', 'number of elements not equal'
      print '(a)', '(ie. total true elements in the mask)'
      print '(3i3)', count(mymask)
      !
      print '(a)', 'count of elements not equal in each column'
      print '(a)', '(ie. total true elements in each column)'
      print '(3i3)', count(mymask, dim=1)
      !
      print '(a)', 'count of elements not equal in each row'
      print '(a)', '(ie. total true elements in each row)'
      print '(3i3)', count(mymask, dim=2)
      !
      ! working with rank=3 ...
      print *, 'lets try this with c(2,3,4)'
      print *,'  taking the result of the modulo   '
      print *,'   z=1      z=2      z=3      z=4   '
      print *,'  1 3 0 || 2 4 1 || 3 0 2 || 4 1 3 |'
      print *,'  2 4 1 || 3 0 2 || 4 1 3 || 0 2 4 |'
      print *,'                                    '
      print *,'  would result in the mask ..       '
      print *,'  F F T || F F F || F T F || F F F |'
      print *,'  F F F || F T F || F F F || T F F |'
      print *,'                                    '
      print *,' the total number of .true.values is'
      print ints, count(modulo(c,5).eq.0)
      call printi('counting up along a row and removing rows',&
      count(modulo(c,5).eq.0,dim=1))
      call printi('counting up along a column and removing columns',&
      count(modulo(c,5).eq.0,dim=2))
      call printi('counting up along a depth and removing depths',&
      count(modulo(c,5).eq.0,dim=3))
      !
      contains
      !
      ! CONVENIENCE ROUTINE FOR PRINTING SMALL INTEGER MATRICES
      subroutine printi(title,arr)
      implicit none
      !
      !@(#) print small 2d integer arrays in row-column format
      !
      character(len=*),parameter :: all='(*(g0,1x))' ! a handy format
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest
         !
         print all
         print all, trim(title),':(',shape(arr),')'  ! print title
         biggest='           '  ! make buffer to write integer into
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='(" > [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo
         !
      end subroutine printi
      end program demo_count
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcpu%5Ftime%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2Creal32%2Creal64%2Creal128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20start%2C%20finish%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20startd%2C%20finishd%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20call%20cpu%5Ftime%28start%29%0D%0A%20%20%20%20%20%20%20%20%20call%20cpu%5Ftime%28startd%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20put%20code%20to%20time%20here%0D%0A%20%20%20%20%20%20%20%20%20call%20cpu%5Ftime%28finish%29%0D%0A%20%20%20%20%20%20%20%20%20call%20cpu%5Ftime%28finishd%29%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%21%20writes%20processor%20time%20taken%20by%20the%20piece%20of%20code%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20the%20accuracy%20of%20the%20clock%20and%20whether%20it%20includes%20system%20time%0D%0A%20%20%20%20%20%20%20%20%21%20as%20well%20as%20user%20time%20is%20processor%20dependent%2E%20Accuracy%20up%20to%0D%0A%20%20%20%20%20%20%20%20%21%20milliseconds%20is%20common%20but%20not%20guaranteed%2C%20and%20may%20be%20much%0D%0A%20%20%20%20%20%20%20%20%21%20higher%20or%20lower%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%22Processor%20Time%20%3D%20%22%2Cf6%2E3%2C%22%20seconds%2E%22%29%27%2Cfinish%2Dstart%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20see%20your%20specific%20compiler%20documentation%20for%20how%20to%20measure%0D%0A%20%20%20%20%20%20%20%20%20%21%20parallel%20jobs%20and%20for%20the%20precision%20of%20the%20time%20returned%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%22Processor%20Time%20%3D%20%22%2Cg0%2C%22%20seconds%2E%22%29%27%2Cfinish%2Dstart%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%22Processor%20Time%20%3D%20%22%2Cg0%2C%22%20seconds%2E%22%29%27%2Cfinishd%2Dstartd%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcpu%5Ftime%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> cpu_time
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_cpu_time
      use, intrinsic :: iso_fortran_env, only : real_kinds,real32,real64,real128
      implicit none
      real :: start, finish
      real(kind=real64) :: startd, finishd
         !
         call cpu_time(start)
         call cpu_time(startd)
         ! put code to time here
         call cpu_time(finish)
         call cpu_time(finishd)
         !
        ! writes processor time taken by the piece of code.

        ! the accuracy of the clock and whether it includes system time
        ! as well as user time is processor dependent. Accuracy up to
        ! milliseconds is common but not guaranteed, and may be much
        ! higher or lower
         print '("Processor Time = ",f6.3," seconds.")',finish-start

         ! see your specific compiler documentation for how to measure
         ! parallel jobs and for the precision of the time returned
         print '("Processor Time = ",g0," seconds.")',finish-start
         print '("Processor Time = ",g0," seconds.")',finishd-startd
      end program demo_cpu_time
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fcshift%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20dimension%285%29%20%20%20%3A%3A%20i1%2Ci2%2Ci3%0D%0A%20%20%20%20%20%20integer%2C%20dimension%283%2C4%29%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20%21basics%0D%0A%20%20%20%20%20%20%20%20%20%20i1%3D%5B10%2C20%2C30%2C40%2C50%5D%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27start%20with%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%281x%2C5i3%29%27%2C%20i1%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27shift%20%2D2%27%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%281x%2C5i3%29%27%2C%20cshift%28i1%2C%2D2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27shift%20%2B2%27%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%281x%2C5i3%29%27%2C%20cshift%28i1%2C%2B2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27start%20with%20a%20matrix%27%0D%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%20reshape%28%20%5B%201%2C%202%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%2C%209%2C%2010%2C%2011%2C%2012%20%5D%2C%20%5B%203%2C%204%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20a%281%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20a%282%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20a%283%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27matrix%20shifted%20along%20rows%2C%20each%20by%20its%20own%20amount%20%5B%2D1%2C0%2C1%5D%27%0D%0A%20%20%20%20%20%20%20%20%20%20b%20%3D%20cshift%28a%2C%20SHIFT%3D%5B1%2C%200%2C%20%2D1%5D%2C%20DIM%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20b%281%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20b%282%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%284i3%29%27%2C%20b%283%2C%3A%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fcshift%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> cshift
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_cshift
      implicit none
      integer, dimension(5)   :: i1,i2,i3
      integer, dimension(3,4) :: a, b
         !basics
          i1=[10,20,30,40,50]
          print *,'start with:'
          print '(1x,5i3)', i1
          print *,'shift -2'
          print '(1x,5i3)', cshift(i1,-2)
          print *,'shift +2'
          print '(1x,5i3)', cshift(i1,+2)

          print *,'start with a matrix'
          a = reshape( [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 ], [ 3, 4 ])
          print '(4i3)', a(1,:)
          print '(4i3)', a(2,:)
          print '(4i3)', a(3,:)
          print *,'matrix shifted along rows, each by its own amount [-1,0,1]'
          b = cshift(a, SHIFT=[1, 0, -1], DIM=2)
          print *
          print '(4i3)', b(1,:)
          print '(4i3)', b(2,:)
          print '(4i3)', b(3,:)
      end program demo_cshift
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fc%5Fsizeof%0D%0A%20%20%20%20%20%20use%20iso%5Fc%5Fbinding%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28c%5Ffloat%29%20%3A%3A%20r%2C%20s%285%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%28c%5Fsizeof%28s%29%2Fc%5Fsizeof%28r%29%20%3D%3D%205%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fc%5Fsizeof%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> c_sizeof
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_c_sizeof
      use iso_c_binding
      implicit none
      real(c_float) :: r, s(5)
         print *, (c_sizeof(s)/c_sizeof(r) == 5)
      end program demo_c_sizeof
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdate%5Fand%5Ftime%0D%0A%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D8%29%20%20%20%20%20%3A%3A%20date%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D10%29%20%20%20%20%3A%3A%20time%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D5%29%20%20%20%20%20%3A%3A%20zone%0D%0A%20%20%20%20%20%20%20%20%20integer%2C%20dimension%288%29%20%3A%3A%20values%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20date%5Fand%5Ftime%28date%2C%20time%2C%20zone%2C%20values%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20using%20keyword%20arguments%0D%0A%20%20%20%20%20%20%20%20%20call%20date%5Fand%5Ftime%28DATE%3Ddate%2C%20TIME%3Dtime%2C%20ZONE%3Dzone%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%2A%28g0%29%29%27%2C%27DATE%3D%22%27%2Cdate%2C%27%22%20TIME%3D%22%27%2Ctime%2C%27%22%20ZONE%3D%22%27%2Czone%2C%27%22%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20date%5Fand%5Ftime%28VALUES%3Dvalues%29%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%20%27%28i5%2Ca%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%281%29%2C%20%27%20%2D%20The%20year%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%282%29%2C%20%27%20%2D%20The%20month%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%283%29%2C%20%27%20%2D%20The%20day%20of%20the%20month%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%284%29%2C%20%27%20%2D%20Time%20difference%20with%20UTC%20in%20minutes%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%285%29%2C%20%27%20%2D%20The%20hour%20of%20the%20day%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%286%29%2C%20%27%20%2D%20The%20minutes%20of%20the%20hour%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%287%29%2C%20%27%20%2D%20The%20seconds%20of%20the%20minute%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20values%288%29%2C%20%27%20%2D%20The%20milliseconds%20of%20the%20second%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%20%27%28a%29%27%29%20iso%5F8601%28%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%20%20%20function%20iso%5F8601%28%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20return%20date%20using%20ISO%2D8601%20format%20at%20a%20resolution%20of%20seconds%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D8%29%20%20%3A%3A%20dt%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D10%29%20%3A%3A%20tm%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D5%29%20%20%3A%3A%20zone%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D25%29%20%3A%3A%20iso%5F8601%0D%0A%20%20%20%20%20%20%20%20%20call%20date%5Fand%5Ftime%28dt%2C%20tm%2C%20zone%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ISO%5F8601%20%3D%20dt%281%3A4%29%2F%2F%27%2D%27%2F%2Fdt%285%3A6%29%2F%2F%27%2D%27%2F%2Fdt%287%3A8%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%2F%2F%27T%27%2F%2F%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20tm%281%3A2%29%2F%2F%27%3A%27%2F%2Ftm%283%3A4%29%2F%2F%27%3A%27%2F%2Ftm%285%3A6%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%2F%2Fzone%281%3A3%29%2F%2F%27%3A%27%2F%2Fzone%284%3A5%29%0D%0A%20%20%20%20%20%20%20%20%20end%20function%20iso%5F8601%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdate%5Fand%5Ftime%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> date_and_time
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_date_and_time
         implicit none
         character(len=8)     :: date
         character(len=10)    :: time
         character(len=5)     :: zone
         integer, dimension(8) :: values

         call date_and_time(date, time, zone, values)

         ! using keyword arguments
         call date_and_time(DATE=date, TIME=time, ZONE=zone)
         print '(*(g0))','DATE="',date,'" TIME="',time,'" ZONE="',zone,'"'

         call date_and_time(VALUES=values)
         write (*, '(i5,a)') &
          & values(1), ' - The year', &
          & values(2), ' - The month', &
          & values(3), ' - The day of the month', &
          & values(4), ' - Time difference with UTC in minutes', &
          & values(5), ' - The hour of the day', &
          & values(6), ' - The minutes of the hour', &
          & values(7), ' - The seconds of the minute', &
          & values(8), ' - The milliseconds of the second'

         write (*, '(a)') iso_8601()
      contains
         function iso_8601()
         ! return date using ISO-8601 format at a resolution of seconds
         character(len=8)  :: dt
         character(len=10) :: tm
         character(len=5)  :: zone
         character(len=25) :: iso_8601
         call date_and_time(dt, tm, zone)
            ISO_8601 = dt(1:4)//'-'//dt(5:6)//'-'//dt(7:8) &
                     & //'T'//                             &
                     & tm(1:2)//':'//tm(3:4)//':'//tm(5:6) &
                     & //zone(1:3)//':'//zone(4:5)
         end function iso_8601
      end program demo_date_and_time
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdble%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%3A%3A%20x%20%3D%202%2E18%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%20%3D%205%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20z%20%3D%20%282%2E3%2C1%2E14%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dble%28x%29%2C%20dble%28i%29%2C%20dble%28z%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdble%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dble
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dble
      implicit none
      real:: x = 2.18
      integer :: i = 5
      complex :: z = (2.3,1.14)
         print *, dble(x), dble(i), dble(z)
      end program demo_dble
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdigits%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%20%3D%2012345%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%203%2E143%0D%0A%20%20%20%20%20%20doubleprecision%20%3A%3A%20y%20%3D%202%2E33d0%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27default%20integer%3A%27%2C%20digits%28i%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27default%20real%3A%20%20%20%27%2C%20digits%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27default%20doubleprecision%3A%27%2C%20digits%28y%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdigits%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> digits
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_digits
      implicit none
      integer :: i = 12345
      real :: x = 3.143
      doubleprecision :: y = 2.33d0
         print *,'default integer:', digits(i)
         print *,'default real:   ', digits(x)
         print *,'default doubleprecision:', digits(y)
      end program demo_digits
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdim%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20%20i%20%3D%20dim%284%2C%2015%29%0D%0A%20%20%20%20%20%20%20%20%20%20x%20%3D%20dim%284%2E321%5Freal64%2C%201%2E111%5Freal64%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20x%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dim%28%5B1%2C2%2C3%5D%2C2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dim%28%5B1%2C2%2C3%5D%2C%5B3%2C2%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dim%28%2D10%2C%5B0%2C%2D10%2C%2D20%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdim%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dim
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dim
      use, intrinsic :: iso_fortran_env, only : real64
      implicit none
      integer           :: i
      real(kind=real64) :: x

         ! basic usage
          i = dim(4, 15)
          x = dim(4.321_real64, 1.111_real64)
          print *, i
          print *, x

         ! elemental
          print *, dim([1,2,3],2)
          print *, dim([1,2,3],[3,2,1])
          print *, dim(-10,[0,-10,-20])

      end program demo_dim
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdot%5Fprod%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20integer%2C%20dimension%283%29%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%20%5B%201%2C%202%2C%203%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20b%20%3D%20%5B%204%2C%205%2C%206%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20a%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dot%5Fproduct%28a%2Cb%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdot%5Fprod%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dot_product
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dot_prod
      implicit none
          integer, dimension(3) :: a, b
          a = [ 1, 2, 3 ]
          b = [ 4, 5, 6 ]
          print '(3i3)', a
          print *
          print '(3i3)', b
          print *
          print *, dot_product(a,b)
      end program demo_dot_prod
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdprod%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20dp%3Dkind%280%2E0d0%29%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%205%2E2%0D%0A%20%20%20%20%20%20real%20%3A%3A%20y%20%3D%202%2E3%0D%0A%20%20%20%20%20%20doubleprecision%20%3A%3A%20xx%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%20%20%3A%3A%20dd%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27algebraically%205%2E2%20x%202%2E3%20is%20exactly%2011%2E96%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27as%20floating%20point%20values%20results%20may%20differ%20slightly%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20dd%20%3D%20dprod%28x%2Cy%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27compare%20dprod%28xy%29%3D%27%2Cdd%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27to%20x%2Ay%3D%27%2Cx%2Ay%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27to%20dble%28x%29%2Adble%28y%29%3D%27%2Cdble%28x%29%2Adble%28y%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27test%20if%20an%20expected%20result%20is%20produced%27%0D%0A%20%20%20%20%20%20%20%20%20xx%3D%2D6%2E0d0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29DPROD%28%2D3%2E0%2C%202%2E0%29%2Cxx%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29merge%28%27PASSED%27%2C%27FAILED%27%2CDPROD%28%2D3%2E0%2C%202%2E0%29%20%3D%3D%20xx%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dprod%28%20%5B2%2E3%2C3%2E4%2C4%2E5%5D%2C%2010%2E0%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dprod%28%20%5B2%2E3%2C3%2E4%2C4%2E5%5D%2C%20%5B9%2E8%2C7%2E6%2C5%2E4%5D%20%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdprod%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dprod
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dprod
      implicit none
      integer,parameter :: dp=kind(0.0d0)
      real :: x = 5.2
      real :: y = 2.3
      doubleprecision :: xx
      real(kind=dp)   :: dd

         print *,'algebraically 5.2 x 2.3 is exactly 11.96'
         print *,'as floating point values results may differ slightly:'
         ! basic usage
         dd = dprod(x,y)
         print *, 'compare dprod(xy)=',dd, &
         & 'to x*y=',x*y, &
         & 'to dble(x)*dble(y)=',dble(x)*dble(y)

         print *,'test if an expected result is produced'
         xx=-6.0d0
         write(*,*)DPROD(-3.0, 2.0),xx
         write(*,*)merge('PASSED','FAILED',DPROD(-3.0, 2.0) == xx)

         print *,'elemental'
         print *, dprod( [2.3,3.4,4.5], 10.0 )
         print *, dprod( [2.3,3.4,4.5], [9.8,7.6,5.4] )

      end program demo_dprod
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdshiftl%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20i%2C%20j%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20dshiftl%20%281%2C%202%2A%2A30%2C%202%29%20%21%20int32%20values%20on%20little%2Dendian%20%3D%3E%205%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20print%20some%20simple%20calls%20as%20binary%20to%20better%20visual%20the%20results%0D%0A%20%20%20%20%20%20%20%20%20i%3D%2D1%0D%0A%20%20%20%20%20%20%20%20%20j%3D0%0D%0A%20%20%20%20%20%20%20%20%20shift%3D5%0D%0A%20%20%20%20%20%20%20%20%20call%20printit%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20leftmost%20SHIFT%20bits%20of%20J%20are%20copied%20to%20the%20rightmost%20result%20bits%0D%0A%20%20%20%20%20%20%20%20%20j%3Dint%28b%2211111000000000000000000000000000%22%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20and%20the%20other%20bits%20are%20the%20rightmost%20bits%20of%20I%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%2200000000000000000000000000000000%22%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printit%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20j%3Dint%28b%2211111000000000000000000000000000%22%29%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%2200000111111111111111111111111111%22%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20result%20should%20be%20all%201s%0D%0A%20%20%20%20%20%20%20%20%20call%20printit%28%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20subroutine%20printit%28%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20i%2Cj%2Cshift%20and%20then%20i%2Cj%2C%20and%20the%20result%20as%20binary%20values%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27I%3D%27%2Ci%2C%27%20J%3D%27%2Cj%2C%27%20SHIFT%3D%27%2Cshift%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29%20i%2Cj%2C%20dshiftl%20%28i%2C%20j%2C%20shift%29%0D%0A%20%20%20%20%20%20end%20subroutine%20printit%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdshiftl%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dshiftl
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dshiftl
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer(kind=int32) :: i, j
      integer             :: shift

        ! basic usage
         write(*,*) dshiftl (1, 2**30, 2) ! int32 values on little-endian => 5

        ! print some simple calls as binary to better visual the results
         i=-1
         j=0
         shift=5
         call printit()

         ! the leftmost SHIFT bits of J are copied to the rightmost result bits
         j=int(b"11111000000000000000000000000000")
         ! and the other bits are the rightmost bits of I
         i=int(b"00000000000000000000000000000000")
         call printit()

         j=int(b"11111000000000000000000000000000")
         i=int(b"00000111111111111111111111111111")
         ! result should be all 1s
         call printit()

      contains
      subroutine printit()
         ! print i,j,shift and then i,j, and the result as binary values
          write(*,'(*(g0))')'I=',i,' J=',j,' SHIFT=',shift
          write(*,'(b32.32)') i,j, dshiftl (i, j, shift)
      end subroutine printit

      end program demo_dshiftl
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fdshiftr%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20i%2C%20j%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20dshiftr%20%281%2C%202%2A%2A30%2C%202%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20print%20some%20calls%20as%20binary%20to%20better%20visualize%20the%20results%0D%0A%20%20%20%20%20%20%20%20%20i%3D%2D1%0D%0A%20%20%20%20%20%20%20%20%20j%3D0%0D%0A%20%20%20%20%20%20%20%20%20shift%3D5%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20values%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27I%3D%27%2Ci%2C%27%20J%3D%27%2Cj%2C%27%20SHIFT%3D%27%2Cshift%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29%20i%2Cj%2C%20dshiftr%20%28i%2C%20j%2C%20shift%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20visualizing%20a%20%22combined%20right%20shift%22%20%2E%2E%2E%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%2200000000000000000000000000011111%22%29%0D%0A%20%20%20%20%20%20%20%20%20j%3Dint%28b%2211111111111111111111111111100000%22%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20appended%20together%20%28%20i%2F%2Fj%20%29%0D%0A%20%20%20%20%20%20%20%20%20%21%200000000000000000000000000001111111111111111111111111111111100000%0D%0A%20%20%20%20%20%20%20%20%20%21%20shifted%20right%20SHIFT%20values%20dropping%20off%20shifted%20values%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%2000000000000000000000000000011111111111111111111111111111111%0D%0A%20%20%20%20%20%20%20%20%20%21%20keep%20enough%20rightmost%20bits%20to%20fill%20the%20kind%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2011111111111111111111111111111111%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20the%20result%20should%20be%20all%201s%20bits%20%2E%2E%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27I%3D%27%2Ci%2C%27%20J%3D%27%2Cj%2C%27%20SHIFT%3D%27%2Cshift%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29%20i%2Cj%2C%20dshiftr%20%28i%2C%20j%2C%20shift%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fdshiftr%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> dshiftr
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_dshiftr
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer(kind=int32) :: i, j
      integer             :: shift

        ! basic usage
         write(*,*) dshiftr (1, 2**30, 2)

        ! print some calls as binary to better visualize the results
         i=-1
         j=0
         shift=5

         ! print values
          write(*,'(*(g0))')'I=',i,' J=',j,' SHIFT=',shift
          write(*,'(b32.32)') i,j, dshiftr (i, j, shift)

        ! visualizing a "combined right shift" ...
         i=int(b"00000000000000000000000000011111")
         j=int(b"11111111111111111111111111100000")
         ! appended together ( i//j )
         ! 0000000000000000000000000001111111111111111111111111111111100000
         ! shifted right SHIFT values dropping off shifted values
         !      00000000000000000000000000011111111111111111111111111111111
         ! keep enough rightmost bits to fill the kind
         !                                 11111111111111111111111111111111
         ! so the result should be all 1s bits ...

          write(*,'(*(g0))')'I=',i,' J=',j,' SHIFT=',shift
          write(*,'(b32.32)') i,j, dshiftr (i, j, shift)

      end program demo_dshiftr
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Feoshift%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20dimension%283%2C3%29%20%3A%3A%20a%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%20reshape%28%20%5B%201%2C%202%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%2C%209%20%5D%2C%20%5B%203%2C%203%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20%28a%28i%2C%3A%29%2Ci%3D1%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20shift%20it%0D%0A%20%20%20%20%20%20%20%20%20%20a%20%3D%20eoshift%28a%2C%20SHIFT%3D%5B1%2C%202%2C%201%5D%2C%20BOUNDARY%3D%2D5%2C%20DIM%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%283i3%29%27%2C%20%28a%28i%2C%3A%29%2Ci%3D1%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Feoshift%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> eoshift
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_eoshift
      implicit none
      integer, dimension(3,3) :: a
      integer :: i

          a = reshape( [ 1, 2, 3, 4, 5, 6, 7, 8, 9 ], [ 3, 3 ])
          print '(3i3)', (a(i,:),i=1,3)

          print *

          ! shift it
          a = eoshift(a, SHIFT=[1, 2, 1], BOUNDARY=-5, DIM=2)
          print '(3i3)', (a(i,:),i=1,3)

      end program demo_eoshift
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fepsilon%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dsp%29%20%3A%3A%20x%20%3D%203%2E143%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%3A%3A%20y%20%3D%202%2E33d0%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20if%20x%20is%20of%20type%20real32%2C%20epsilon%28x%29%20has%20the%20value%202%2A%2A%2D23%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20epsilon%28x%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20just%20the%20type%20and%20kind%20of%20x%20matter%2C%20not%20the%20value%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20epsilon%28huge%28x%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20epsilon%28tiny%28x%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20value%20changes%20with%20the%20kind%20of%20the%20real%20value%20though%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20epsilon%28y%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20adding%20and%20subtracting%20epsilon%28x%29%20changes%20x%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%20%3D%3D%20x%20%2B%20epsilon%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%20%3D%3D%20x%20%2D%20epsilon%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20these%20next%20two%20comparisons%20will%20be%20%2Etrue%2E%20%21%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%20%3D%3D%20x%20%2B%20epsilon%28x%29%20%2A%200%2E999999%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%20%3D%3D%20x%20%2D%20epsilon%28x%29%20%2A%200%2E999999%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20you%20can%20calculate%20epsilon%281%2E0d0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29my%5Fdp%5Feps%28%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20function%20my%5Fdp%5Feps%28%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20calculate%20the%20epsilon%20value%20of%20a%20machine%20the%20hard%20way%0D%0A%20%20%20%20%20%20%20%20%20real%28kind%3Ddp%29%20%3A%3A%20t%0D%0A%20%20%20%20%20%20%20%20%20real%28kind%3Ddp%29%20%3A%3A%20my%5Fdp%5Feps%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20starting%20with%20a%20value%20of%201%2C%20keep%20dividing%20the%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20by%202%20until%20no%20change%20is%20detected%2E%20Note%20that%20with%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20infinite%20precision%20this%20would%20be%20an%20infinite%20loop%2C%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20but%20floating%20point%20values%20in%20Fortran%20have%20a%20defined%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20and%20limited%20precision%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20my%5Fdp%5Feps%20%3D%201%2E0d0%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20SET%5FST%3A%20do%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20my%5Fdp%5Feps%20%3D%20my%5Fdp%5Feps%2F2%2E0d0%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20t%20%3D%201%2E0d0%20%2B%20my%5Fdp%5Feps%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28t%20%3C%3D%201%2E0d0%29%20exit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%20SET%5FST%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20my%5Fdp%5Feps%20%3D%202%2E0d0%2Amy%5Fdp%5Feps%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20end%20function%20my%5Fdp%5Feps%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fepsilon%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> epsilon
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_epsilon
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=sp) :: x = 3.143
      real(kind=dp) :: y = 2.33d0

         ! so if x is of type real32, epsilon(x) has the value 2**-23
         print *, epsilon(x)
         ! note just the type and kind of x matter, not the value
         print *, epsilon(huge(x))
         print *, epsilon(tiny(x))

         ! the value changes with the kind of the real value though
         print *, epsilon(y)

         ! adding and subtracting epsilon(x) changes x
         write(*,*)x == x + epsilon(x)
         write(*,*)x == x - epsilon(x)

         ! these next two comparisons will be .true. !
         write(*,*)x == x + epsilon(x) * 0.999999
         write(*,*)x == x - epsilon(x) * 0.999999

         ! you can calculate epsilon(1.0d0)
         write(*,*)my_dp_eps()

      contains

         function my_dp_eps()
         ! calculate the epsilon value of a machine the hard way
         real(kind=dp) :: t
         real(kind=dp) :: my_dp_eps

            ! starting with a value of 1, keep dividing the value
            ! by 2 until no change is detected. Note that with
            ! infinite precision this would be an infinite loop,
            ! but floating point values in Fortran have a defined
            ! and limited precision.
            my_dp_eps = 1.0d0
            SET_ST: do
               my_dp_eps = my_dp_eps/2.0d0
               t = 1.0d0 + my_dp_eps
               if (t <= 1.0d0) exit
            enddo SET_ST
            my_dp_eps = 2.0d0*my_dp_eps

         end function my_dp_eps
      end program demo_epsilon
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ferfc%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%200%2E17%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27X%3D%27%2Cx%2C%20%27%20ERFC%28X%29%3D%27%2Cerfc%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27equivalently%201%2DERF%28X%29%3D%27%2C1%2Derf%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ferfc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> erfc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_erfc
      use, intrinsic :: iso_fortran_env, only : &
       & real_kinds, real32, real64, real128
      implicit none
      real(kind=real64) :: x = 0.17_real64
         write(*,'(*(g0))')'X=',x, ' ERFC(X)=',erfc(x)
         write(*,'(*(g0))')'equivalently 1-ERF(X)=',1-erf(x)
      end program demo_erfc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ferfc%5Fscaled%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%280%2E0d0%29%29%20%3A%3A%20x%20%3D%200%2E17d0%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20erfc%5Fscaled%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20x%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ferfc%5Fscaled%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> erfc_scaled
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_erfc_scaled
      implicit none
      real(kind(0.0d0)) :: x = 0.17d0
         x = erfc_scaled(x)
         print *, x
      end program demo_erfc_scaled
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ferf%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%200%2E17%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2C%20erf%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ferf%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> erf
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_erf
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 0.17_real64
          write(*,*)x, erf(x)
      end program demo_erf
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fevent%5Fquery%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20type%28event%5Ftype%29%20%3A%3A%20event%5Fvalue%5Fhas%5Fbeen%5Fset%5B%2A%5D%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20cnt%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20call%20event%5Fquery%28event%5Fvalue%5Fhas%5Fbeen%5Fset%2C%20cnt%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28cnt%20%3E%200%29%20write%28%2A%2C%2A%29%20%22Value%20has%20been%20set%22%0D%0A%20%20%20%20%20%20%20%20%20elseif%20%28this%5Fimage%28%29%20%3D%3D%202%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20event%20post%28event%5Fvalue%5Fhas%5Fbeen%5Fset%5B1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fevent%5Fquery%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> event_query
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_event_query
      use iso_fortran_env
      implicit none
      type(event_type) :: event_value_has_been_set[*]
      integer :: cnt
         if (this_image() == 1) then
            call event_query(event_value_has_been_set, cnt)
            if (cnt > 0) write(*,*) "Value has been set"
         elseif (this_image() == 2) then
            event post(event_value_has_been_set[1])
         endif
      end program demo_event_query
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fexec%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20execute%5Fcommand%5Fline%28%22external%5Fprog%2Eexe%22%2C%20exitstat%3Di%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22Exit%20status%20of%20external%5Fprog%2Eexe%20was%20%22%2C%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20execute%5Fcommand%5Fline%28%22reindex%5Ffiles%2Eexe%22%2C%20wait%3D%2Efalse%2E%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22Now%20reindexing%20files%20in%20the%20background%22%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fexec%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> execute_command_line
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_exec
      implicit none
         integer :: i

         call execute_command_line("external_prog.exe", exitstat=i)
         print *, "Exit status of external_prog.exe was ", i

         call execute_command_line("reindex_files.exe", wait=.false.)
         print *, "Now reindexing files in the background"
      end program demo_exec
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fexp%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%2C%20re%2C%20im%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20cx%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%201%2E0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%22Euler%27s%20constant%20is%20approximately%22%2Cexp%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%21%20complex%20values%0D%0A%20%20%20%20%20%20%20%20%20%21%20given%0D%0A%20%20%20%20%20%20%20%20%20re%3D3%2E0%0D%0A%20%20%20%20%20%20%20%20%20im%3D4%2E0%0D%0A%20%20%20%20%20%20%20%20%20cx%3Dcmplx%28re%2Cim%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20complex%20results%20from%20complex%20arguments%20are%20Related%20to%20Euler%27s%20formula%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27given%20the%20complex%20value%20%27%2Ccx%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27exp%28x%29%20is%27%2Cexp%28cx%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27is%20the%20same%20as%27%2Cexp%28re%29%2Acmplx%28cos%28im%29%2Csin%28im%29%2Ckind%3Dkind%28cx%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20exp%283%29%20is%20the%20inverse%20function%20of%20log%283%29%20so%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20real%20component%20of%20the%20input%20must%20be%20less%20than%20or%20equal%20to%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27maximum%20real%20component%27%2Clog%28huge%280%2E0%29%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20or%20for%20double%20precision%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27maximum%20doubleprecision%20component%27%2Clog%28huge%280%2E0d0%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20but%20since%20the%20imaginary%20component%20is%20passed%20to%20the%20cos%283%29%20and%20sin%283%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20functions%20the%20imaginary%20component%20can%20be%20any%20real%20value%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fexp%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> exp
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_exp
      implicit none
      real :: x, re, im
      complex :: cx

         x = 1.0
         write(*,*)"Euler's constant is approximately",exp(x)

         !! complex values
         ! given
         re=3.0
         im=4.0
         cx=cmplx(re,im)

         ! complex results from complex arguments are Related to Euler's formula
         write(*,*)'given the complex value ',cx
         write(*,*)'exp(x) is',exp(cx)
         write(*,*)'is the same as',exp(re)*cmplx(cos(im),sin(im),kind=kind(cx))

         ! exp(3) is the inverse function of log(3) so
         ! the real component of the input must be less than or equal to
         write(*,*)'maximum real component',log(huge(0.0))
         ! or for double precision
         write(*,*)'maximum doubleprecision component',log(huge(0.0d0))

         ! but since the imaginary component is passed to the cos(3) and sin(3)
         ! functions the imaginary component can be any real value

      end program demo_exp
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fexponent%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%201%2E0%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20i%20%3D%20exponent%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20exponent%280%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20exponent%28%5B10%2E0%2C100%2E0%2C1000%2E0%2C%2D10000%2E0%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20beware%20of%20overflow%2C%20it%20may%20occur%20silently%0D%0A%20%20%20%20%20%20%20%20%20%21print%20%2A%2C%202%2A%2A%5B10%2E0%2C100%2E0%2C1000%2E0%2C%2D10000%2E0%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20exponent%28huge%280%2E0%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20exponent%28tiny%280%2E0%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fexponent%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> exponent
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_exponent
      implicit none
      real :: x = 1.0
      integer :: i
         i = exponent(x)
         print *, i
         print *, exponent(0.0)
         print *, exponent([10.0,100.0,1000.0,-10000.0])
         ! beware of overflow, it may occur silently
         !print *, 2**[10.0,100.0,1000.0,-10000.0]
         print *, exponent(huge(0.0))
         print *, exponent(tiny(0.0))
      end program demo_exponent
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%21%20program%20demo%5Fextends%5Ftype%5Fof%0D%0A%20%20%20%20%20%20%20%20module%20M%5Fdemo%5Fextends%5Ftype%5Fof%0D%0A%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20private%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%20nothing%0D%0A%20%20%20%20%20%20%20%20end%20type%20nothing%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%2C%20extends%28nothing%29%20%3A%3A%20dot%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20x%3D0%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20y%3D0%0D%0A%20%20%20%20%20%20%20%20end%20type%20dot%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%2C%20extends%28dot%29%20%3A%3A%20point%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20z%3D0%0D%0A%20%20%20%20%20%20%20%20end%20type%20point%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%20something%5Felse%0D%0A%20%20%20%20%20%20%20%20end%20type%20something%5Felse%0D%0A%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20nothing%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20dot%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20point%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20something%5Felse%0D%0A%0D%0A%20%20%20%20%20%20%20%20end%20module%20M%5Fdemo%5Fextends%5Ftype%5Fof%0D%0A%0D%0A%20%20%20%20%20%20%20%20program%20demo%5Fextends%5Ftype%5Fof%0D%0A%20%20%20%20%20%20%20%20use%20M%5Fdemo%5Fextends%5Ftype%5Fof%2C%20only%20%3A%20nothing%2C%20dot%2C%20point%2C%20something%5Felse%0D%0A%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20type%28nothing%29%20%3A%3A%20grandpa%0D%0A%20%20%20%20%20%20%20%20type%28dot%29%20%3A%3A%20dad%0D%0A%20%20%20%20%20%20%20%20type%28point%29%20%3A%3A%20me%0D%0A%20%20%20%20%20%20%20%20type%28something%5Felse%29%20%3A%3A%20alien%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27these%20should%20all%20be%20true%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28me%2Cgrandpa%29%2C%27I%20am%20descended%20from%20Grandpa%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28dad%2Cgrandpa%29%2C%27Dad%20is%20descended%20from%20Grandpa%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28me%2Cdad%29%2C%27Dad%20is%20my%20ancestor%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27is%20an%20object%20an%20extension%20of%20itself%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28grandpa%2Cgrandpa%29%20%2C%27self%2Dpropagating%21%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28dad%2Cdad%29%20%2C%27clone%21%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27%20you%20did%20not%20father%20your%20grandfather%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28grandpa%2Cdad%29%2C%27no%20paradox%20here%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28dad%2Cme%29%2C%27no%20paradox%20here%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28grandpa%2Cme%29%2C%27no%20relation%20whatsoever%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28grandpa%2Calien%29%2C%27no%20relation%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29extends%5Ftype%5Fof%28me%2Calien%29%2C%27not%20what%20everyone%20thinks%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20pointers%28%29%0D%0A%20%20%20%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20pointers%28%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20Given%20the%20declarations%20and%20assignments%0D%0A%20%20%20%20%20%20%20%20%20type%20t1%0D%0A%20%20%20%20%20%20%20%20%20real%20c%0D%0A%20%20%20%20%20%20%20%20%20end%20type%0D%0A%20%20%20%20%20%20%20%20%20type%2C%20extends%28t1%29%20%3A%3A%20t2%0D%0A%20%20%20%20%20%20%20%20%20end%20type%0D%0A%20%20%20%20%20%20%20%20%20class%28t1%29%2C%20pointer%20%3A%3A%20p%2C%20q%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20allocate%20%28p%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20allocate%20%28t2%20%3A%3A%20q%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20the%20result%20of%20EXTENDS%5FTYPE%5FOF%20%28P%2C%20Q%29%20will%20be%20false%2C%20and%20the%20result%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20of%20EXTENDS%5FTYPE%5FOF%20%28Q%2C%20P%29%20will%20be%20true%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27%28P%2CQ%29%27%2Cextends%5Ftype%5Fof%28p%2Cq%29%2C%22mind%20your%20P%27s%20and%20Q%27s%22%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27%28Q%2CP%29%27%2Cextends%5Ftype%5Fof%28q%2Cp%29%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%20pointers%0D%0A%0D%0A%20%20%20%20%20%20%20%20end%20program%20demo%5Fextends%5Ftype%5Fof%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> extends_type_of
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
        ! program demo_extends_type_of
        module M_demo_extends_type_of
        implicit none
        private

        type nothing
        end type nothing

        type, extends(nothing) :: dot
          real :: x=0
          real :: y=0
        end type dot

        type, extends(dot) :: point
          real :: z=0
        end type point

        type something_else
        end type something_else

        public :: nothing
        public :: dot
        public :: point
        public :: something_else

        end module M_demo_extends_type_of

        program demo_extends_type_of
        use M_demo_extends_type_of, only : nothing, dot, point, something_else
        implicit none
        type(nothing) :: grandpa
        type(dot) :: dad
        type(point) :: me
        type(something_else) :: alien

         write(*,*)'these should all be true'
         write(*,*)extends_type_of(me,grandpa),'I am descended from Grandpa'
         write(*,*)extends_type_of(dad,grandpa),'Dad is descended from Grandpa'
         write(*,*)extends_type_of(me,dad),'Dad is my ancestor'

         write(*,*)'is an object an extension of itself?'
         write(*,*)extends_type_of(grandpa,grandpa) ,'self-propagating!'
         write(*,*)extends_type_of(dad,dad) ,'clone!'

         write(*,*)' you did not father your grandfather'
         write(*,*)extends_type_of(grandpa,dad),'no paradox here'

         write(*,*)extends_type_of(dad,me),'no paradox here'
         write(*,*)extends_type_of(grandpa,me),'no relation whatsoever'
         write(*,*)extends_type_of(grandpa,alien),'no relation'
         write(*,*)extends_type_of(me,alien),'not what everyone thinks'

         call pointers()
         contains

         subroutine pointers()
         ! Given the declarations and assignments
         type t1
         real c
         end type
         type, extends(t1) :: t2
         end type
         class(t1), pointer :: p, q
            allocate (p)
            allocate (t2 :: q)
            ! the result of EXTENDS_TYPE_OF (P, Q) will be false, and the result
            ! of EXTENDS_TYPE_OF (Q, P) will be true.
            write(*,*)'(P,Q)',extends_type_of(p,q),"mind your P's and Q's"
            write(*,*)'(Q,P)',extends_type_of(q,p)
         end subroutine pointers

        end program demo_extends_type_of
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ffindloc%0D%0A%20%20%20%20%20%20logical%2Cparameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20ibox%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20logical%2Callocatable%20%3A%3A%20mask%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20first%20element%20matching%20the%20value%20is%20returned%20AS%20AN%20ARRAY%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%3D%3D%206%27%2Cfindloc%20%28%5B2%2C%206%2C%204%2C%206%5D%2C%20value%20%3D%206%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%3D%3D%206%27%2Cfindloc%20%28%5B2%2C%206%2C%204%2C%206%5D%2C%20value%20%3D%206%2Cback%3D%2Etrue%2E%29%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20first%20element%20matching%20the%20value%20is%20returned%20AS%20A%20SCALAR%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%3D%3D%206%27%2Cfindloc%20%28%5B2%2C%206%2C%204%2C%206%5D%2C%20value%20%3D%206%2Cdim%3D1%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%3D%3D%206%27%2Cfindloc%20%28%5B2%2C%206%2C%204%2C%206%5D%2C%20value%20%3D%206%2Cback%3D%2Etrue%2E%2Cdim%3D1%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20ibox%3Dreshape%28%5B%200%2C%2D5%2C%20%207%2C%207%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%2C%204%2C%20%2D1%2C%202%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%2C%205%2C%20%206%2C%207%5D%20%2Cshape%3D%5B3%2C4%5D%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20mask%3Dreshape%28%5B%20T%2C%20T%2C%20F%2C%20T%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20T%2C%20T%2C%20F%2C%20T%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20T%2C%20T%2C%20F%2C%20T%5D%20%2Cshape%3D%5B3%2C4%5D%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27array%20is%27%2C%20ibox%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printl%28%27mask%20%20is%27%2C%20mask%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27so%20for%20%3D%3D%207%20and%20back%3D%2Efalse%2E%27%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27so%20for%20%3D%3D%207%20the%20address%20of%20the%20element%20is%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20findloc%20%28ibox%2C%207%2C%20mask%20%3D%20mask%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27so%20for%20%3D%3D%207%20and%20back%3D%2Etrue%2E%27%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27so%20for%20%3D%3D%207%20the%20address%20of%20the%20element%20is%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20findloc%20%28ibox%2C%207%2C%20mask%20%3D%20mask%2C%20back%3D%2Etrue%2E%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27This%20is%20independent%20of%20declared%20lower%20bounds%20for%20the%20array%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27%20using%20dim%3DN%27%0D%0A%20%20%20%20%20%20%20%20%20ibox%3Dreshape%28%5B%201%2C%20%202%2C%20%2D9%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%2C%20%202%2C%20%206%20%5D%20%2Cshape%3D%5B2%2C3%5D%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27array%20is%27%2C%20ibox%20%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20has%20the%20value%20%5B2%2C%201%2C%200%5D%20and%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%27%2Cfindloc%20%28ibox%2C%20value%20%3D%202%2C%20dim%20%3D%201%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20has%20the%20value%20%5B2%2C%201%5D%2E%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%27%2Cfindloc%20%28ibox%2C%20value%20%3D%202%2C%20dim%20%3D%202%29%20%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%20GENERIC%20ROUTINES%20TO%20PRINT%20MATRICES%0D%0A%20%20%20%20%20%20subroutine%20printl%28title%2Ca%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20logical%20scalar%2C%20vector%2C%20matrix%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20logical%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%28%2E%2E%29%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20row%3D%27%28%22%20%3E%20%5B%20%22%2C%2A%28l1%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20all%3D%27%28%22%20%22%2C%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20logical%2Callocatable%20%20%20%20%20%20%20%20%20%20%3A%3A%20b%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%2Cadvance%3D%27no%27%29trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20copy%20everything%20to%20a%20matrix%20to%20keep%20code%20simple%0D%0A%20%20%20%20%20%20%20%20%20select%20rank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%280%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20scalar%29%27%3B%20b%3Dreshape%28%5Ba%5D%2C%5B1%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%281%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20vector%29%27%3B%20b%3Dreshape%28a%2C%5Bsize%28a%29%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%282%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20matrix%29%27%3B%20b%3Da%0D%0A%20%20%20%20%20%20%20%20%20rank%20default%3B%20stop%20%27%2Aprintl%2A%20unexpected%20rank%27%0D%0A%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28b%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29b%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%29%20%27%3Eshape%3D%27%2Cshape%28a%29%2C%27%2Crank%3D%27%2Crank%28a%29%2C%27%2Csize%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20end%20subroutine%20printl%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20printi%28title%2Ca%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20scalar%2C%20vector%2C%20matrix%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%28%2E%2E%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20all%3D%27%28%22%20%22%2C%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20row%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%20%20%20%20%20%20%20%20%20%3A%3A%20b%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%2Cadvance%3D%27no%27%29trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20copy%20everything%20to%20a%20matrix%20to%20keep%20code%20simple%0D%0A%20%20%20%20%20%20%20%20%20select%20rank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%280%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20scalar%29%27%3B%20b%3Dreshape%28%5Ba%5D%2C%5B1%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%281%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20vector%29%27%3B%20b%3Dreshape%28a%2C%5Bsize%28a%29%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%282%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20matrix%29%27%3B%20b%3Da%0D%0A%20%20%20%20%20%20%20%20%20rank%20default%3B%20stop%20%27%2Aprinti%2A%20unexpected%20rank%27%0D%0A%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28row%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28b%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20row%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28row%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28b%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29b%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%29%20%27%3Eshape%3D%27%2Cshape%28a%29%2C%27%2Crank%3D%27%2Crank%28a%29%2C%27%2Csize%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20end%20subroutine%20printi%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ffindloc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> findloc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_findloc
      logical,parameter :: T=.true., F=.false.
      integer,allocatable :: ibox(:,:)
      logical,allocatable :: mask(:,:)
        ! basics
         ! the first element matching the value is returned AS AN ARRAY
         call printi('== 6',findloc ([2, 6, 4, 6], value = 6))
         call printi('== 6',findloc ([2, 6, 4, 6], value = 6,back=.true.))
         ! the first element matching the value is returned AS A SCALAR
         call printi('== 6',findloc ([2, 6, 4, 6], value = 6,dim=1))
         call printi('== 6',findloc ([2, 6, 4, 6], value = 6,back=.true.,dim=1))

         ibox=reshape([ 0,-5,  7, 7, &
                        3, 4, -1, 2, &
                        1, 5,  6, 7] ,shape=[3,4],order=[2,1])

         mask=reshape([ T, T, F, T, &
                        T, T, F, T, &
                        T, T, F, T] ,shape=[3,4],order=[2,1])

         call printi('array is', ibox )
         call printl('mask  is', mask )
         print *, 'so for == 7 and back=.false.'
         call printi('so for == 7 the address of the element is', &
                 & findloc (ibox, 7, mask = mask) )
         print *, 'so for == 7 and back=.true.'
         call printi('so for == 7 the address of the element is', &
                 & findloc (ibox, 7, mask = mask, back=.true.) )

         print *,'This is independent of declared lower bounds for the array'

         print *, ' using dim=N'
         ibox=reshape([ 1,  2, -9,  &
                        2,  2,  6 ] ,shape=[2,3],order=[2,1])

         call printi('array is', ibox )
         ! has the value [2, 1, 0] and
         call printi('',findloc (ibox, value = 2, dim = 1) )
         ! has the value [2, 1].
         call printi('',findloc (ibox, value = 2, dim = 2) )
      contains
      ! GENERIC ROUTINES TO PRINT MATRICES
      subroutine printl(title,a)
      implicit none
      !@(#) print small 2d logical scalar, vector, matrix in row-column format
      character(len=*),intent(in)  :: title
      logical,intent(in)           :: a(..)

      character(len=*),parameter   :: row='(" > [ ",*(l1:,","))'
      character(len=*),parameter   :: all='(" ",*(g0,1x))'
      logical,allocatable          :: b(:,:)
      integer                      :: i
         write(*,all,advance='no')trim(title)
         ! copy everything to a matrix to keep code simple
         select rank(a)
         rank (0); write(*,'(a)')' (a scalar)'; b=reshape([a],[1,1])
         rank (1); write(*,'(a)')' (a vector)'; b=reshape(a,[size(a),1])
         rank (2); write(*,'(a)')' (a matrix)'; b=a
         rank default; stop '*printl* unexpected rank'
         end select
         do i=1,size(b,dim=1)
            write(*,fmt=row,advance='no')b(i,:)
            write(*,'(" ]")')
         enddo
         write(*,all) '>shape=',shape(a),',rank=',rank(a),',size=',size(a)
         write(*,*)
      end subroutine printl

      subroutine printi(title,a)
      implicit none
      !@(#) print small 2d integer scalar, vector, matrix in row-column format
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: a(..)
      character(len=*),parameter   :: all='(" ",*(g0,1x))'
      character(len=20)            :: row
      integer,allocatable          :: b(:,:)
      integer                      :: i
         write(*,all,advance='no')trim(title)
         ! copy everything to a matrix to keep code simple
         select rank(a)
         rank (0); write(*,'(a)')' (a scalar)'; b=reshape([a],[1,1])
         rank (1); write(*,'(a)')' (a vector)'; b=reshape(a,[size(a),1])
         rank (2); write(*,'(a)')' (a matrix)'; b=a
         rank default; stop '*printi* unexpected rank'
         end select
         ! find how many characters to use for integers
         write(row,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(b))))))+2
         ! use this format to write a row
         row='(" > [",*(i'//trim(row)//':,","))'
         do i=1,size(b,dim=1)
            write(*,fmt=row,advance='no')b(i,:)
            write(*,'(" ]")')
         enddo
         write(*,all) '>shape=',shape(a),',rank=',rank(a),',size=',size(a)
         write(*,*)
      end subroutine printi
      end program demo_findloc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ffloor%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%2063%2E29%0D%0A%20%20%20%20%20%20real%20%3A%3A%20y%20%3D%20%2D63%2E59%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20x%2C%20floor%28x%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20y%2C%20floor%28y%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cfloor%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2D2%2E7%2C%20%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%2D1%2E0%2C%20%2D0%2E5%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%200%2E0%2C%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2B0%2E5%2C%20%20%2B1%2E0%2C%20%2B1%2E5%2C%20%2B2%2E0%2C%20%2B2%2E2%2C%20%2B2%2E5%2C%20%2B2%2E7%20%20%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20even%20a%20small%20deviation%20from%20the%20whole%20number%20changes%20the%20result%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20%20%20%20%20%5B2%2E0%2C2%2E0%2Depsilon%280%2E0%29%2C2%2E0%2D2%2Aepsilon%280%2E0%29%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cfloor%28%5B2%2E0%2C2%2E0%2Depsilon%280%2E0%29%2C2%2E0%2D2%2Aepsilon%280%2E0%29%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20A%3DNan%2C%20Infinity%20or%20%20%3Chuge%280%5FKIND%29%2D1%20%3C%20A%20%3E%20huge%280%5FKIND%29%20is%20undefined%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ffloor%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> floor
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_floor
      implicit none
      real :: x = 63.29
      real :: y = -63.59
          print *, x, floor(x)
          print *, y, floor(y)
         ! elemental
         print *,floor([ &
         &  -2.7,  -2.5, -2.2, -2.0, -1.5, -1.0, -0.5, &
         &  0.0,   &
         &  +0.5,  +1.0, +1.5, +2.0, +2.2, +2.5, +2.7  ])

         ! note even a small deviation from the whole number changes the result
         print *,      [2.0,2.0-epsilon(0.0),2.0-2*epsilon(0.0)]
         print *,floor([2.0,2.0-epsilon(0.0),2.0-2*epsilon(0.0)])

         ! A=Nan, Infinity or  <huge(0_KIND)-1 < A > huge(0_KIND) is undefined
      end program demo_floor
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20%20program%20demo%5Fflush%0D%0A%20%20%20%20%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20stderr%3D%3EERROR%5FUNIT%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20stdin%3D%3EINPUT%5FUNIT%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20stdout%3D%3EOUTPUT%5FUNIT%0D%0A%20%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20iostat%0D%0A%20%20%20%20%20%20%20%20%20%20character%28len%3D255%29%20%3A%3A%20iomsg%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20flush%20%28stderr%2C%20iostat%3Diostat%2C%20iomsg%3Diomsg%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20if%28iostat%2Ene%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ERROR%3A%27%2F%2Ftrim%28iomsg%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error%20stop%201%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20flush%20%28stdout%2C%20err%20%3D%20999%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20stop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20999%20continue%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20stop%2010%0D%0A%20%20%20%20%20%20%20%20%20%20end%20program%20demo%5Fflush%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> flush
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
          program demo_flush
          use, intrinsic :: iso_fortran_env, only : &
          & stderr=>ERROR_UNIT, &
          & stdin=>INPUT_UNIT,  &
          & stdout=>OUTPUT_UNIT
          implicit none
          integer :: iostat
          character(len=255) :: iomsg
             flush (stderr, iostat=iostat, iomsg=iomsg)
             if(iostat.ne.0)then
                write(*,*)'ERROR:'//trim(iomsg)
                error stop 1
             endif
             flush (stdout, err = 999 )
             stop
             999 continue
             stop 10
          end program demo_flush
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ffraction%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20178%2E1387e%2D4%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20fraction%28x%29%2C%20x%20%2A%20radix%28x%29%2A%2A%28%2Dexponent%28x%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ffraction%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> fraction
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_fraction
      implicit none
      real :: x
         x = 178.1387e-4
         print *, fraction(x), x * radix(x)**(-exponent(x))
      end program demo_fraction
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fgamma%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20wp%3D%3Ereal64%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%2C%20xa%284%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2C%20j%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20gamma%281%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27gamma%281%2E0%29%3D%27%2Cx%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20xa%3Dgamma%28%5B1%2E0%2C2%2E0%2C3%2E0%2C4%2E0%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29xa%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20gamma%28%29%20is%20related%20to%20the%20factorial%20function%0D%0A%20%20%20%20%20%20%20%20%20do%20i%20%3D%201%2C%20171%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20check%20value%20is%20not%20too%20big%20for%20default%20integer%20type%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28factorial%28i%29%20%20%3C%3D%20%20huge%280%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20i%2C%20nint%28factorial%28i%29%29%2C%20%27integer%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20elseif%20%28factorial%28i%29%20%20%3C%3D%20%20huge%280%5Fint64%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20i%2C%20nint%28factorial%28i%29%2Ckind%3Dint64%29%2C%27integer%28kind%3Dint64%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20i%2C%20factorial%28i%29%20%2C%20%27user%20factorial%20function%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20i%2C%20product%28%5B%28real%28j%2C%20kind%3Dwp%29%2C%20j%3D1%2C%20i%29%5D%29%2C%20%27product%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20i%2C%20gamma%28real%28i%20%2B%201%2C%20kind%3Dwp%29%29%2C%20%27gamma%20directly%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20function%20factorial%28i%29%20result%28f%29%0D%0A%20%20%20%20%20%20%21%20%20GAMMA%28X%29%20computes%20Gamma%20of%20X%2E%20For%20positive%20whole%20number%20values%20of%20N%20the%0D%0A%20%20%20%20%20%20%21%20%20Gamma%20function%20can%20be%20used%20to%20calculate%20factorials%2C%20as%20%28N%2D1%29%21%20%3D%3D%0D%0A%20%20%20%20%20%20%21%20%20GAMMA%28REAL%28N%29%29%2E%20That%20is%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20%20%20%20%20%20n%21%20%3D%3D%20gamma%28real%28n%2B1%29%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20integer%2C%20intent%28in%29%20%3A%3A%20i%0D%0A%20%20%20%20%20%20real%28kind%3Dwp%29%20%3A%3A%20f%0D%0A%20%20%20%20%20%20%20%20%20if%20%28i%20%20%3C%3D%20%200%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%20%27%3CERROR%3E%20gamma%283%29%20function%20value%20%27%2C%20i%2C%20%27%20%3C%3D%200%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27%3CSTOP%3E%20bad%20value%20in%20gamma%20function%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20f%20%3D%20anint%28gamma%28real%28i%20%2B%201%2Ckind%3Dwp%29%29%29%0D%0A%20%20%20%20%20%20end%20function%20factorial%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fgamma%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> gamma
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_gamma
      use, intrinsic :: iso_fortran_env, only : wp=>real64, int64
      implicit none
      real :: x, xa(4)
      integer :: i, j

         ! basic usage
         x = gamma(1.0)
         write(*,*)'gamma(1.0)=',x

         ! elemental
         xa=gamma([1.0,2.0,3.0,4.0])
         write(*,*)xa
         write(*,*)

         ! gamma() is related to the factorial function
         do i = 1, 171
            ! check value is not too big for default integer type
            if (factorial(i)  <=  huge(0)) then
               write(*,*) i, nint(factorial(i)), 'integer'
            elseif (factorial(i)  <=  huge(0_int64)) then
               write(*,*) i, nint(factorial(i),kind=int64),'integer(kind=int64)'
            else
               write(*,*) i, factorial(i) , 'user factorial function'
               write(*,*) i, product([(real(j, kind=wp), j=1, i)]), 'product'
               write(*,*) i, gamma(real(i + 1, kind=wp)), 'gamma directly'
            endif
         enddo

      contains
      function factorial(i) result(f)
      !  GAMMA(X) computes Gamma of X. For positive whole number values of N the
      !  Gamma function can be used to calculate factorials, as (N-1)! ==
      !  GAMMA(REAL(N)). That is
      !
      !      n! == gamma(real(n+1))
      !
      integer, intent(in) :: i
      real(kind=wp) :: f
         if (i  <=  0) then
            write(*,'(*(g0))') '<ERROR> gamma(3) function value ', i, ' <= 0'
            stop '<STOP> bad value in gamma function'
         endif
         f = anint(gamma(real(i + 1,kind=wp)))
      end function factorial

      end program demo_gamma
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fget%5Fcommand%5Fargument%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D255%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20progname%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20count%2C%20i%2C%20argument%5Flength%2C%20istat%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20arg%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20command%20name%20assuming%20it%20is%20less%20than%20255%20characters%20in%20length%0D%0A%20%20%20%20%20%20%20%20call%20get%5Fcommand%5Fargument%20%280%2C%20progname%2C%20status%3Distat%29%0D%0A%20%20%20%20%20%20%20%20if%20%28istat%20%3D%3D%200%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20program%27s%20name%20is%20%22%20%2F%2F%20trim%20%28progname%29%0D%0A%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22Could%20not%20get%20the%20program%27s%20name%20%22%20%2F%2F%20trim%20%28progname%29%0D%0A%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20get%20number%20of%20arguments%0D%0A%20%20%20%20%20%20%20%20count%20%3D%20command%5Fargument%5Fcount%28%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27The%20number%20of%20arguments%20is%20%27%2Ccount%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%21%20allocate%20string%20array%20big%20enough%20to%20hold%20command%20line%0D%0A%20%20%20%20%20%20%20%20%21%20argument%20strings%20and%20related%20information%0D%0A%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20do%20i%3D1%2Ccount%0D%0A%20%20%20%20%20%20%20%20%20%20%20call%20get%5Fcommand%5Fargument%28number%3Di%2Clength%3Dargument%5Flength%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20if%28allocated%28arg%29%29deallocate%28arg%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20allocate%28character%28len%3Dargument%5Flength%29%20%3A%3A%20arg%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20call%20get%5Fcommand%5Fargument%28i%2C%20arg%2Cstatus%3Distat%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%21%20show%20the%20results%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%27%28i3%2E3%2C1x%2Ci0%2E5%2C1x%2Ci0%2E5%2C1x%2C%22%5B%22%2Ca%2C%22%5D%22%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20i%2Cistat%2Cargument%5Flength%2Carg%0D%0A%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fget%5Fcommand%5Fargument%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> get_command_argument
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_get_command_argument
      implicit none
      character(len=255)           :: progname
      integer                      :: count, i, argument_length, istat
      character(len=:),allocatable :: arg

       ! command name assuming it is less than 255 characters in length
        call get_command_argument (0, progname, status=istat)
        if (istat == 0) then
           print *, "The program's name is " // trim (progname)
        else
           print *, "Could not get the program's name " // trim (progname)
        endif

       ! get number of arguments
        count = command_argument_count()
        write(*,*)'The number of arguments is ',count

        !
        ! allocate string array big enough to hold command line
        ! argument strings and related information
        !
        do i=1,count
           call get_command_argument(number=i,length=argument_length)
           if(allocated(arg))deallocate(arg)
           allocate(character(len=argument_length) :: arg)
           call get_command_argument(i, arg,status=istat)
           ! show the results
           write (*,'(i3.3,1x,i0.5,1x,i0.5,1x,"[",a,"]")') &
           & i,istat,argument_length,arg
        enddo

      end program demo_get_command_argument
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fget%5Fcommand%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20command%5Fline%5Flength%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20command%5Fline%0D%0A%20%20%20%20%20%20%20%20%20%21%20get%20command%20line%20length%0D%0A%20%20%20%20%20%20%20%20%20call%20get%5Fcommand%28length%3Dcommand%5Fline%5Flength%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20allocate%20string%20big%20enough%20to%20hold%20command%20line%0D%0A%20%20%20%20%20%20%20%20%20allocate%28character%28len%3Dcommand%5Fline%5Flength%29%20%3A%3A%20command%5Fline%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20get%20command%20line%20as%20a%20string%0D%0A%20%20%20%20%20%20%20%20%20call%20get%5Fcommand%28command%3Dcommand%5Fline%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20trim%20leading%20spaces%20just%20in%20case%0D%0A%20%20%20%20%20%20%20%20%20command%5Fline%3Dadjustl%28command%5Fline%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22OUTPUT%3A%22%2Ca%29%27%29command%5Fline%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fget%5Fcommand%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> get_command
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_get_command
      implicit none
      integer                      :: command_line_length
      character(len=:),allocatable :: command_line
         ! get command line length
         call get_command(length=command_line_length)
         ! allocate string big enough to hold command line
         allocate(character(len=command_line_length) :: command_line)
         ! get command line as a string
         call get_command(command=command_line)
         ! trim leading spaces just in case
         command_line=adjustl(command_line)
         write(*,'("OUTPUT:",a)')command_line
      end program demo_get_command
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fgetenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20homedir%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20var%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20var%3D%27HOME%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20homedir%3Dget%5Fenv%28var%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%27%28a%2C%22%3D%22%22%22%2Ca%2C%22%22%22%22%29%27%29var%2Chomedir%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20function%20get%5Fenv%28name%2Cdefault%29%20result%28value%29%0D%0A%20%20%20%20%20%20%21%20a%20function%20that%20makes%20calling%20get%5Fenvironment%5Fvariable%283%29%20simple%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%3A%3A%20name%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%2Coptional%20%3A%3A%20default%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%20%20%20%20%20%20%20%20%3A%3A%20value%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20howbig%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20stat%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20length%0D%0A%20%20%20%20%20%20%20%20%20length%3D0%0D%0A%20%20%20%20%20%20%20%20%20value%3D%27%27%0D%0A%20%20%20%20%20%20%20%20%20if%28name%2Ene%2E%27%27%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20call%20get%5Fenvironment%5Fvariable%28%20name%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20length%3Dhowbig%2Cstatus%3Dstat%2Ctrim%5Fname%3D%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20select%20case%20%28stat%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20%281%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20name%2C%20%22%20is%20not%20defined%20in%20the%20environment%2E%20Strange%2E%2E%2E%22%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20value%3D%27%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20%282%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%22This%20processor%20does%20not%20support%20environment%20variables%2E%20Boooh%21%22%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20value%3D%27%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20make%20string%20of%20sufficient%20size%20to%20hold%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20if%28allocated%28value%29%29deallocate%28value%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20allocate%28character%28len%3Dmax%28howbig%2C1%29%29%20%3A%3A%20value%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20get%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20get%5Fenvironment%5Fvariable%28%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20name%2Cvalue%2Cstatus%3Dstat%2Ctrim%5Fname%3D%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20if%28stat%2Ene%2E0%29value%3D%27%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20if%28value%2Eeq%2E%27%27%2Eand%2Epresent%28default%29%29value%3Ddefault%0D%0A%20%20%20%20%20%20end%20function%20get%5Fenv%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fgetenv%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> get_environment_variable
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_getenv
      implicit none
      character(len=:),allocatable :: homedir
      character(len=:),allocatable :: var

           var='HOME'
           homedir=get_env(var)
           write (*,'(a,"=""",a,"""")')var,homedir

      contains

      function get_env(name,default) result(value)
      ! a function that makes calling get_environment_variable(3) simple
      implicit none
      character(len=*),intent(in)          :: name
      character(len=*),intent(in),optional :: default
      character(len=:),allocatable         :: value
      integer                              :: howbig
      integer                              :: stat
      integer                              :: length
         length=0
         value=''
         if(name.ne.'')then
            call get_environment_variable( name, &
            & length=howbig,status=stat,trim_name=.true.)
            select case (stat)
            case (1)
             print *, name, " is not defined in the environment. Strange..."
             value=''
            case (2)
             print *, &
             "This processor does not support environment variables. Boooh!"
             value=''
            case default
             ! make string of sufficient size to hold value
             if(allocated(value))deallocate(value)
             allocate(character(len=max(howbig,1)) :: value)
             ! get value
             call get_environment_variable( &
             & name,value,status=stat,trim_name=.true.)
             if(stat.ne.0)value=''
            end select
         endif
         if(value.eq.''.and.present(default))value=default
      end function get_env

      end program demo_getenv
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fhuge%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20f%3D%27%28i2%2C1x%2C2%28i11%2C1x%29%2Cf14%2E0%3A%2C1x%2Cl1%2C1x%2Ca%29%27%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2Cj%2Ck%2Cbiggest%0D%0A%20%20%20%20%20%20real%20%3A%3A%20v%2C%20w%0D%0A%20%20%20%20%20%20doubleprecision%20%3A%3A%20tally%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20huge%280%29%2C%20huge%280%2E0%29%2C%20huge%280%2E0d0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20tiny%280%2E0%29%2C%20tiny%280%2E0d0%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20tally%3D0%2E0d0%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20subtracting%20one%20because%20counter%20is%20the%20end%20value%2B1%20on%20exit%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D0%2Chuge%280%29%2D1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20tally%3Dtally%2Bi%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27tally%3D%27%2Ctally%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20advanced%0D%0A%20%20%20%20%20%20%20%20%20biggest%3Dhuge%280%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20be%20careful%20of%20overflow%20when%20using%20integers%20in%20computation%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2C14%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20j%3D6%2A%2Ai%20%20%20%21%20Danger%2C%20Danger%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20w%3D6%2A%2Ai%20%20%20%21%20Danger%2C%20Danger%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20v%3D6%2E0%2A%2Ai%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20k%3Dv%20%20%20%20%20%20%21%20Danger%2C%20Danger%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28v%2Egt%2Ebiggest%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%20i%2C%20j%2C%20k%2C%20v%2C%20v%2Eeq%2Ew%2C%20%27wrong%20j%20and%20k%20and%20w%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%20i%2C%20j%2C%20k%2C%20v%2C%20v%2Eeq%2Ew%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fhuge%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> huge
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_huge
      implicit none
      character(len=*),parameter :: f='(i2,1x,2(i11,1x),f14.0:,1x,l1,1x,a)'
      integer :: i,j,k,biggest
      real :: v, w
      doubleprecision :: tally
         ! basic
         print *, huge(0), huge(0.0), huge(0.0d0)
         print *, tiny(0.0), tiny(0.0d0)

         tally=0.0d0
         ! note subtracting one because counter is the end value+1 on exit
         do i=0,huge(0)-1
            tally=tally+i
         enddo
         write(*,*)'tally=',tally

         ! advanced
         biggest=huge(0)
         ! be careful of overflow when using integers in computation
         do i=1,14
            j=6**i   ! Danger, Danger
            w=6**i   ! Danger, Danger
            v=6.0**i
            k=v      ! Danger, Danger

            if(v.gt.biggest)then
               write(*,f) i, j, k, v, v.eq.w, 'wrong j and k and w'
            else
               write(*,f) i, j, k, v, v.eq.w
            endif

         enddo
      end program demo_huge
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fhypot%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal32%29%20%3A%3A%20x%2C%20y%0D%0A%20%20%20%20%20%20real%28kind%3Dreal32%29%2Callocatable%20%3A%3A%20xs%28%3A%29%2C%20ys%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20f%3D%27%28a%2C%2F%2CSP%2C%2A%283x%2Cg0%2C1x%2Cg0%3A%2C%2F%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%201%2Ee0%5Freal32%0D%0A%20%20%20%20%20%20%20%20%20y%20%3D%200%2E5e0%5Freal32%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27point%20%3C%27%2Cx%2C%27%2C%27%2Cy%2C%27%3E%20is%20%27%2Chypot%28x%2Cy%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27units%20away%20from%20the%20origin%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20xs%3D%5B%20%20x%2C%20%20x%2A%2A2%2C%20%20x%2A10%2E0%2C%20%20x%2A15%2E0%2C%20%2Dx%2A%2A2%20%20%5D%0D%0A%20%20%20%20%20%20%20%20%20ys%3D%5B%20%20y%2C%20%20y%2A%2A2%2C%20%2Dy%2A20%2E0%2C%20%20y%2A%2A2%2C%20%20%20%2Dy%2A%2A2%20%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%22the%20points%22%2C%28xs%28i%29%2Cys%28i%29%2Ci%3D1%2Csize%28xs%29%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%22have%20distances%20from%20the%20origin%20of%20%22%2Chypot%28xs%2Cys%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%22the%20closest%20is%22%2Cminval%28hypot%28xs%2Cys%29%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fhypot%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> hypot
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_hypot
      use, intrinsic :: iso_fortran_env, only : &
       & real_kinds, real32, real64, real128
      implicit none
      real(kind=real32) :: x, y
      real(kind=real32),allocatable :: xs(:), ys(:)
      integer :: i
      character(len=*),parameter :: f='(a,/,SP,*(3x,g0,1x,g0:,/))'

         x = 1.e0_real32
         y = 0.5e0_real32

         write(*,*)
         write(*,'(*(g0))')'point <',x,',',y,'> is ',hypot(x,y)
         write(*,'(*(g0))')'units away from the origin'
         write(*,*)

         ! elemental
         xs=[  x,  x**2,  x*10.0,  x*15.0, -x**2  ]
         ys=[  y,  y**2, -y*20.0,  y**2,   -y**2  ]

         write(*,f)"the points",(xs(i),ys(i),i=1,size(xs))
         write(*,f)"have distances from the origin of ",hypot(xs,ys)
         write(*,f)"the closest is",minval(hypot(xs,ys))

      end program demo_hypot
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiachar%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20just%20does%20a%20string%20one%20character%20long%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29iachar%28%27A%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20elemental%3A%20can%20do%20an%20array%20of%20letters%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29iachar%28%5B%27A%27%2C%27Z%27%2C%27a%27%2C%27z%27%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20convert%20all%20characters%20to%20lowercase%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29lower%28%27abcdefg%20ABCDEFG%27%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20pure%20elemental%20function%20lower%28str%29%20result%20%28string%29%0D%0A%20%20%20%20%20%20%21%20Changes%20a%20string%20to%20lowercase%0D%0A%20%20%20%20%20%20character%28%2A%29%2C%20intent%28In%29%20%20%20%20%20%3A%3A%20str%0D%0A%20%20%20%20%20%20character%28len%28str%29%29%20%20%20%20%20%20%20%20%20%20%3A%3A%20string%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20string%20%3D%20str%0D%0A%20%20%20%20%20%20%20%20%20%21%20step%20thru%20each%20letter%20in%20the%20string%20in%20specified%20range%0D%0A%20%20%20%20%20%20%20%20%20do%20i%20%3D%201%2C%20len%28str%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20select%20case%20%28str%28i%3Ai%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20%28%27A%27%3A%27Z%27%29%20%21%20change%20letter%20to%20miniscule%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20string%28i%3Ai%29%20%3D%20char%28iachar%28str%28i%3Ai%29%29%2B32%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20end%20do%0D%0A%20%20%20%20%20%20end%20function%20lower%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiachar%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> iachar
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iachar
      implicit none
         ! basic usage
          ! just does a string one character long
          write(*,*)iachar('A')
          ! elemental: can do an array of letters
          write(*,*)iachar(['A','Z','a','z'])

         ! convert all characters to lowercase
          write(*,'(a)')lower('abcdefg ABCDEFG')
      contains
      !
      pure elemental function lower(str) result (string)
      ! Changes a string to lowercase
      character(*), intent(In)     :: str
      character(len(str))          :: string
      integer                      :: i
         string = str
         ! step thru each letter in the string in specified range
         do i = 1, len(str)
            select case (str(i:i))
            case ('A':'Z') ! change letter to miniscule
               string(i:i) = char(iachar(str(i:i))+32)
            case default
            end select
         end do
      end function lower
      !
      end program demo_iachar
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiall%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20integer%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20a%282%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20a%281%29%20%3D%20int%28b%2700100100%27%29%0D%0A%20%20%20%20%20%20%20%20%20a%282%29%20%3D%20int%28b%2701101010%27%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28b8%2E8%29%27%2C%20iall%28a%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiall%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> iall
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iall
      use, intrinsic :: iso_fortran_env, only : integer_kinds, &
       & int8, int16, int32, int64
      implicit none
      integer(kind=int8) :: a(2)

         a(1) = int(b'00100100')
         a(2) = int(b'01101010')

         print '(b8.8)', iall(a)

      end program demo_iall
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiand%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20data%20a%20%2F%20z%27f%27%20%2F%2C%20b%20%2F%20z%273%27%20%2F%0D%0A%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20%27a%3D%27%2Ca%2C%27%20b%3D%27%2Cb%2C%27iand%28a%2Cb%29%3D%27%2Ciand%28a%2C%20b%29%0D%0A%20%20%20%20%20%20%20write%20%28%2A%2C%27%28b32%2E32%29%27%29%20a%2Cb%2Ciand%28a%2Cb%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiand%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> iand
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iand
      implicit none
      integer :: a, b
       data a / z'f' /, b / z'3' /
       write (*,*) 'a=',a,' b=',b,'iand(a,b)=',iand(a, b)
       write (*,'(b32.32)') a,b,iand(a,b)
      end program demo_iand
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiany%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20integer%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%2Cparameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20a%283%29%0D%0A%20%20%20%20%20%20%20%20%20a%281%29%20%3D%20int%28b%2700100100%27%2Cint8%29%0D%0A%20%20%20%20%20%20%20%20%20a%282%29%20%3D%20int%28b%2701101010%27%2Cint8%29%0D%0A%20%20%20%20%20%20%20%20%20a%283%29%20%3D%20int%28b%2710101010%27%2Cint8%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27A%3D%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%281x%2Cb8%2E8%29%27%2C%20a%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27IANY%28A%29%3D%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%281x%2Cb8%2E8%29%27%2C%20iany%28a%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27IANY%28A%29%20with%20a%20mask%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%281x%2Cb8%2E8%29%27%2C%20iany%28a%2Cmask%3D%5BT%2CF%2CT%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27should%20match%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%281x%2Cb8%2E8%29%27%2C%20iany%28%5Ba%281%29%2Ca%283%29%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27does%20it%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29iany%28a%2C%5BT%2CF%2CT%5D%29%20%3D%3D%20iany%28%5Ba%281%29%2Ca%283%29%5D%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiany%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> iany
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iany
      use, intrinsic :: iso_fortran_env, only : integer_kinds, &
       & int8, int16, int32, int64
      implicit none
      logical,parameter :: T=.true., F=.false.
      integer(kind=int8) :: a(3)
         a(1) = int(b'00100100',int8)
         a(2) = int(b'01101010',int8)
         a(3) = int(b'10101010',int8)
         write(*,*)'A='
         print '(1x,b8.8)', a
         print *
         write(*,*)'IANY(A)='
         print '(1x,b8.8)', iany(a)
         print *
         write(*,*)'IANY(A) with a mask'
         print '(1x,b8.8)', iany(a,mask=[T,F,T])
         print *
         write(*,*)'should match '
         print '(1x,b8.8)', iany([a(1),a(3)])
         print *
         write(*,*)'does it?'
         write(*,*)iany(a,[T,F,T]) == iany([a(1),a(3)])
      end program demo_iany
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fibclr%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint16%29%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibclr%20%2816%2C%201%29%2C%20%27%20%3D%3D%3E%20ibclr%2816%2C1%29%20has%20the%20value%2015%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20it%20is%20easier%20to%20see%20using%20binary%20representation%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%270000000000111111%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b16%2E16%2C1x%2Ci0%29%27%29%20ibclr%28i%2C3%29%2C%20ibclr%28i%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27an%20array%20of%20initial%20values%20may%20be%20given%20as%20well%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibclr%28i%3D%5B7%2C4096%2C9%5D%2C%20pos%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27a%20list%20of%20positions%20results%20in%20multiple%20returned%20values%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27not%20multiple%20bits%20set%20in%20one%20value%2C%20as%20the%20routine%20is%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27a%20scalar%20function%3B%20calling%20it%20elementally%20essentially%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27calls%20it%20multiple%20times%2E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b16%2E16%29%27%29%20ibclr%28i%3D%2D1%5Fint16%2C%20pos%3D%5B1%2C2%2C3%2C4%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20both%20may%20be%20arrays%20if%20of%20the%20same%20size%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fibclr%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ibclr
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ibclr
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int16) :: i
        ! basic usage
         print *,ibclr (16, 1), ' ==> ibclr(16,1) has the value 15'

         ! it is easier to see using binary representation
         i=int(b'0000000000111111',kind=int16)
         write(*,'(b16.16,1x,i0)') ibclr(i,3), ibclr(i,3)

        ! elemental
         print *,'an array of initial values may be given as well'
         print *,ibclr(i=[7,4096,9], pos=2)
         print *
         print *,'a list of positions results in multiple returned values'
         print *,'not multiple bits set in one value, as the routine is  '
         print *,'a scalar function; calling it elementally essentially  '
         print *,'calls it multiple times.                               '
         write(*,'(b16.16)') ibclr(i=-1_int16, pos=[1,2,3,4])

         ! both may be arrays if of the same size

      end program demo_ibclr
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fibits%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint16%29%20%3A%3A%20i%2Cj%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibits%20%2814%2C%201%2C%203%29%20%21%20should%20be%20seven%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibits%28%2D1%2C10%2C3%29%20%20%20%21%20and%20so%20is%20this%0D%0A%20%20%20%20%20%20%20%20%20%21%20it%20is%20easier%20to%20see%20using%20binary%20representation%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%270101010101011101%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b16%2E16%2C1x%2Ci0%29%27%29%20ibits%28i%2C3%2C3%29%2C%20ibits%28i%2C3%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20we%20can%20illustrate%20this%20as%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%23%2D%2D%20position%2015%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%2D%2D%20position%200%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%7C%20%20%20%3C%2D%2D%20%2Blen%20%20%20%7C%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20V%20%20%20%20%20%20%20%20%20%20%20%20%20%20V%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%205432109876543210%0D%0A%20%20%20%20%20%20%20%20%20i%20%3Dint%28b%271111111111111111%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%20%20%5E%5E%5E%5E%0D%0A%20%20%20%20%20%20%20%20%20j%3Dibits%28i%2C10%2C4%29%20%21%20start%20at%2010th%20from%20left%20and%20proceed%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20left%20for%20a%20total%20of%204%20characters%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Cb16%2E16%29%27%29%27j%3D%27%2Cj%0D%0A%20%20%20%20%20%20%20%20%21%20lets%20do%20something%20less%20ambiguous%0D%0A%20%20%20%20%20%20%20%20%20i%20%3Dint%28b%270010011000000000%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20j%3Dibits%28i%2C9%2C5%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Cb16%2E16%29%27%29%27j%3D%27%2Cj%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fibits%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ibits
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ibits
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int16) :: i,j
        ! basic usage
         print *,ibits (14, 1, 3) ! should be seven
         print *,ibits(-1,10,3)   ! and so is this
         ! it is easier to see using binary representation
         i=int(b'0101010101011101',kind=int16)
         write(*,'(b16.16,1x,i0)') ibits(i,3,3), ibits(i,3,3)

        ! we can illustrate this as
         !        #-- position 15
         !        |              #-- position 0
         !        |   <-- +len   |
         !        V              V
         !        5432109876543210
         i =int(b'1111111111111111',kind=int16)
         !          ^^^^
         j=ibits(i,10,4) ! start at 10th from left and proceed
                         ! left for a total of 4 characters
         write(*,'(a,b16.16)')'j=',j
        ! lets do something less ambiguous
         i =int(b'0010011000000000',kind=int16)
         j=ibits(i,9,5)
         write(*,'(a,b16.16)')'j=',j
      end program demo_ibits
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fibset%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint16%29%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibset%20%2812%2C%201%29%2C%20%27ibset%2812%2C1%29%20has%20the%20value%2014%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20it%20is%20easier%20to%20see%20using%20binary%20representation%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%270000000000000110%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b16%2E16%2C1x%2Ci0%2C1x%2Ci0%29%27%29%20ibset%28i%2C12%29%2C%20ibset%28i%2C12%29%2C%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27an%20array%20of%20initial%20values%20may%20be%20given%20as%20well%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cibset%28i%3D%5B0%2C4096%5D%2C%20pos%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27a%20list%20of%20positions%20results%20in%20multiple%20returned%20values%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27not%20multiple%20bits%20set%20in%20one%20value%2C%20as%20the%20routine%20is%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27a%20scalar%20function%3B%20calling%20it%20elementally%20essentially%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27calls%20it%20multiple%20times%2E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b16%2E16%29%27%29%20ibset%28i%3D0%2C%20pos%3D%5B1%2C2%2C3%2C4%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20both%20may%20be%20arrays%20if%20of%20the%20same%20size%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fibset%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ibset
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ibset
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int16) :: i
        ! basic usage
         print *,ibset (12, 1), 'ibset(12,1) has the value 14'

         ! it is easier to see using binary representation
         i=int(b'0000000000000110',kind=int16)
         write(*,'(b16.16,1x,i0,1x,i0)') ibset(i,12), ibset(i,12), i

        ! elemental
         print *,'an array of initial values may be given as well'
         print *,ibset(i=[0,4096], pos=2)
         print *
         print *,'a list of positions results in multiple returned values'
         print *,'not multiple bits set in one value, as the routine is  '
         print *,'a scalar function; calling it elementally essentially  '
         print *,'calls it multiple times.                               '
         write(*,'(b16.16)') ibset(i=0, pos=[1,2,3,4])

         ! both may be arrays if of the same size

      end program demo_ibset
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fichar%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ichar%28%5B%27a%27%2C%27z%27%2C%27A%27%2C%27Z%27%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fichar%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ichar
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ichar
      implicit none

         write(*,*)ichar(['a','z','A','Z'])

      end program demo_ichar
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fieor%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint16%29%20%3A%3A%20i%2Cj%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cieor%20%2816%2C%201%29%2C%20%27%20%3D%3D%3E%20ieor%2816%2C1%29%20has%20the%20value%2017%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20it%20is%20easier%20to%20see%20using%20binary%20representation%0D%0A%20%20%20%20%20%20%20%20%20i%3Dint%28b%270000000000111111%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20j%3Dint%28b%270000001111110000%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Cb16%2E16%2C1x%2Ci0%29%27%29%27i%3D%20%20%20%20%20%27%2Ci%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Cb16%2E16%2C1x%2Ci0%29%27%29%27j%3D%20%20%20%20%20%27%2Cj%2C%20j%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2Cb16%2E16%2C1x%2Ci0%29%27%29%27result%3D%27%2Cieor%28i%2Cj%29%2C%20ieor%28i%2Cj%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27arguments%20may%20be%20arrays%2E%20If%20both%20are%20arrays%20they%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27must%20have%20the%20same%20shape%2E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cieor%28i%3D%5B7%2C4096%2C9%5D%2C%20j%3D2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20both%20may%20be%20arrays%20if%20of%20the%20same%20size%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fieor%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ieor
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ieor
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int16) :: i,j
        ! basic usage
         print *,ieor (16, 1), ' ==> ieor(16,1) has the value 17'

         ! it is easier to see using binary representation
         i=int(b'0000000000111111',kind=int16)
         j=int(b'0000001111110000',kind=int16)
         write(*,'(a,b16.16,1x,i0)')'i=     ',i, i
         write(*,'(a,b16.16,1x,i0)')'j=     ',j, j
         write(*,'(a,b16.16,1x,i0)')'result=',ieor(i,j), ieor(i,j)

        ! elemental
         print *,'arguments may be arrays. If both are arrays they '
         print *,'must have the same shape.                        '
         print *,ieor(i=[7,4096,9], j=2)

         ! both may be arrays if of the same size

      end program demo_ieor
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> image_index
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Findex%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20str%3D%26%0D%0A%20%20%20%20%20%20%20%20%20%27Search%20this%20string%20for%20this%20expression%27%0D%0A%20%20%20%20%20%20%20%20%20%211234567890123456789012345678901234567890%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20index%28str%2C%27this%27%29%2Eeq%2E8%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20return%20value%20is%20counted%20from%20the%20left%20end%20even%20if%20BACK%3D%2ETRUE%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20index%28str%2C%27this%27%2Cback%3D%2Etrue%2E%29%2Eeq%2E24%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20INDEX%20is%20case%2Dsensitive%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20index%28str%2C%27This%27%29%2Eeq%2E0%0D%0A%20%20%20%20%20%20end%20program%20demo%5Findex%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> index
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_index
      implicit none
      character(len=*),parameter :: str=&
         'Search this string for this expression'
         !1234567890123456789012345678901234567890
         write(*,*)&
            index(str,'this').eq.8,              &
            ! return value is counted from the left end even if BACK=.TRUE.
            index(str,'this',back=.true.).eq.24, &
            ! INDEX is case-sensitive
            index(str,'This').eq.0
      end program demo_index
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> inquire
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fint%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%20%3D%2042%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20z%20%3D%20%28%2D3%2E7%2C%201%2E0%29%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%3D%2D10%2E5%2C%20y%3D10%2E5%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28x%29%2C%20int%28y%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28i%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28z%29%2C%20int%28z%2C8%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28%5B%2D10%2E9%2C%2D10%2E5%2C%2D10%2E3%2C10%2E3%2C10%2E5%2C10%2E9%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20int%283%29%20truncates%20towards%20zero%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20CAUTION%3A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20number%20bigger%20than%20a%20default%20integer%20can%20represent%0D%0A%20%20%20%20%20%20%20%20%20%21%20produces%20an%20incorrect%20result%20and%20is%20not%20required%20to%0D%0A%20%20%20%20%20%20%20%20%20%21%20be%20detected%20by%20the%20program%2E%0D%0A%20%20%20%20%20%20%20%20%20x%3Dreal%28huge%280%29%29%2B1000%2E0%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28x%29%2Cx%0D%0A%20%20%20%20%20%20%20%20%20%21%20using%20a%20larger%20kind%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28x%2Ckind%3Dint64%29%2Cx%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20B%22111111111111111111111111111111111111111111111111111111111111111%22%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20kind%3Dint64%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28O%22777777777777777777777%22%2Ckind%3Dint64%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20int%28Z%227FFFFFFFFFFFFFFF%22%2Ckind%3Dint64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2Cint%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2D2%2E7%2C%20%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%2D1%2E0%2C%20%2D0%2E5%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%200%2E0%2C%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%2B0%2E5%2C%20%20%2B1%2E0%2C%20%2B1%2E5%2C%20%2B2%2E0%2C%20%2B2%2E2%2C%20%2B2%2E5%2C%20%2B2%2E7%20%20%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fint%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> int
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_int
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer :: i = 42
      complex :: z = (-3.7, 1.0)
      real :: x=-10.5, y=10.5

         print *, int(x), int(y)

         print *, int(i)

         print *, int(z), int(z,8)
         ! elemental
         print *, int([-10.9,-10.5,-10.3,10.3,10.5,10.9])
         ! note int(3) truncates towards zero

         ! CAUTION:
         ! a number bigger than a default integer can represent
         ! produces an incorrect result and is not required to
         ! be detected by the program.
         x=real(huge(0))+1000.0
         print *, int(x),x
         ! using a larger kind
         print *, int(x,kind=int64),x

         print *, int(&
         & B"111111111111111111111111111111111111111111111111111111111111111",&
         & kind=int64)
         print *, int(O"777777777777777777777",kind=int64)
         print *, int(Z"7FFFFFFFFFFFFFFF",kind=int64)

         ! elemental
         print *
         print *,int([ &
         &  -2.7,  -2.5, -2.2, -2.0, -1.5, -1.0, -0.5, &
         &  0.0,   &
         &  +0.5,  +1.0, +1.5, +2.0, +2.2, +2.5, +2.7  ])

      end program demo_int
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fior%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2C%20j%2C%20k%0D%0A%20%20%20%20%20%20%20%20%20i%3D53%20%20%20%20%20%20%20%21%20i%3D00110101%20binary%20%28lowest%20order%20byte%29%0D%0A%20%20%20%20%20%20%20%20%20j%3D45%20%20%20%20%20%20%20%21%20j%3D00101101%20binary%20%28lowest%20order%20byte%29%0D%0A%20%20%20%20%20%20%20%20%20k%3Dior%28i%2Cj%29%20%21%20k%3D00111101%20binary%20%28lowest%20order%20byte%29%2C%20k%3D61%20decimal%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i8%2C1x%2Cb8%2E8%29%27%29i%2Ci%2Cj%2Cj%2Ck%2Ck%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fior%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ior
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ior
      implicit none
      integer :: i, j, k
         i=53       ! i=00110101 binary (lowest order byte)
         j=45       ! j=00101101 binary (lowest order byte)
         k=ior(i,j) ! k=00111101 binary (lowest order byte), k=61 decimal
         write(*,'(i8,1x,b8.8)')i,i,j,j,k,k
      end program demo_ior
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiparity%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20dimension%282%29%20%3A%3A%20a%0D%0A%20%20%20%20%20%20%20%20a%281%29%20%3D%20int%28b%2700100100%27%29%0D%0A%20%20%20%20%20%20%20%20a%282%29%20%3D%20int%28b%2701101010%27%29%0D%0A%20%20%20%20%20%20%20%20print%20%27%28b8%2E8%29%27%2C%20iparity%28a%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiparity%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> iparity
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iparity
      implicit none
      integer, dimension(2) :: a
        a(1) = int(b'00100100')
        a(2) = int(b'01101010')
        print '(b8.8)', iparity(a)
      end program demo_iparity
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fis%5Fcontiguous%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20intrinsic%20is%5Fcontiguous%0D%0A%20%20%20%20%20%20real%2C%20DIMENSION%20%281000%2C%201000%29%2C%20TARGET%20%3A%3A%20A%0D%0A%20%20%20%20%20%20real%2C%20DIMENSION%20%28%3A%2C%20%3A%29%2C%20POINTER%20%20%20%20%20%20%20%3A%3A%20IN%2C%20OUT%0D%0A%20%20%20%20%20%20%20%20%20IN%20%3D%3E%20A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20Associate%20IN%20with%20target%20A%0D%0A%20%20%20%20%20%20%20%20%20OUT%20%3D%3E%20A%281%3A1000%3A2%2C%3A%29%20%21%20Associate%20OUT%20with%20subset%20of%20target%20A%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27IN%20is%20%27%2CIS%5FCONTIGUOUS%28IN%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27OUT%20is%20%27%2CIS%5FCONTIGUOUS%28OUT%29%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fis%5Fcontiguous%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> is_contiguous
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_is_contiguous
      implicit none
      intrinsic is_contiguous
      real, DIMENSION (1000, 1000), TARGET :: A
      real, DIMENSION (:, :), POINTER       :: IN, OUT
         IN => A              ! Associate IN with target A
         OUT => A(1:1000:2,:) ! Associate OUT with subset of target A
         !
         write(*,*)'IN is ',IS_CONTIGUOUS(IN)
         write(*,*)'OUT is ',IS_CONTIGUOUS(OUT)
         !
      end program demo_is_contiguous
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fishftc%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28b32%2E32%2C1x%2Ci0%29%27%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20ishftc%283%2C%201%29%2C%27%20%3C%3D%3D%20typically%20should%20have%20the%20value%206%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27lets%20start%20with%20this%3A%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b32%2E32%29%27%29huge%280%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27shift%20the%20value%20by%20various%20amounts%2C%20negative%20and%20positive%27%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D%20%2Dbit%5Fsize%280%29%2C%20bit%5Fsize%280%29%2C%208%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20ishftc%28huge%280%29%2Ci%29%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%27%0D%0A%20%20%20%20%20%20%20%20i%3Dhuge%280%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ishftc%28i%2C%5B2%2C3%2C4%2C5%5D%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ishftc%28%5B2%2A%2A1%2C2%2A%2A3%2C%2D2%2A%2A7%5D%2C3%29%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%27note%20the%20arrays%20have%20to%20conform%20when%20elemental%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ishftc%28%5B2%2A%2A1%2C2%2A%2A3%2C%2D2%2A%2A7%5D%2C%5B5%2C20%2C0%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fishftc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ishftc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ishftc
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer             :: i
      character(len=*),parameter :: g='(b32.32,1x,i0)'
        ! basics
         write(*,*) ishftc(3, 1),' <== typically should have the value 6'

         print *, 'lets start with this:'
         write(*,'(b32.32)')huge(0)
         print *, 'shift the value by various amounts, negative and positive'
         do i= -bit_size(0), bit_size(0), 8
            write(*,g) ishftc(huge(0),i), i
         enddo
        print *,'elemental'
        i=huge(0)
        write(*,*)ishftc(i,[2,3,4,5])
        write(*,*)ishftc([2**1,2**3,-2**7],3)
        print *,'note the arrays have to conform when elemental'
        write(*,*)ishftc([2**1,2**3,-2**7],[5,20,0])

      end program demo_ishftc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fishft%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28b32%2E32%2C1x%2Ci0%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20ishft%283%2C%201%29%2C%27%20%3C%3D%3D%20typically%20should%20have%20the%20value%206%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20shift%3D4%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20ishft%28huge%280%29%2Cshift%29%2C%20shift%0D%0A%20%20%20%20%20%20%20%20%20shift%3D0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20ishft%28huge%280%29%2Cshift%29%2C%20shift%0D%0A%20%20%20%20%20%20%20%20%20shift%3D%2D4%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20ishft%28huge%280%29%2Cshift%29%2C%20shift%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fishft%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ishft
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_ishft
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer             :: shift
      character(len=*),parameter :: g='(b32.32,1x,i0)'

         write(*,*) ishft(3, 1),' <== typically should have the value 6'

         shift=4
         write(*,g) ishft(huge(0),shift), shift
         shift=0
         write(*,g) ishft(huge(0),shift), shift
         shift=-4
         write(*,g) ishft(huge(0),shift), shift
      end program demo_ishft
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fiostat%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20value%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20ios%0D%0A%20%20%20%20%20%20character%28len%3D256%29%20%3A%3A%20message%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Begin%20entering%20numeric%20values%2C%20one%20per%20line%27%0D%0A%20%20%20%20%20%20%20%20%20do%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%28%2A%2C%2A%2Ciostat%3Dios%2Ciomsg%3Dmessage%29value%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28ios%2Eeq%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27VALUE%3D%27%2Cvalue%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20elseif%28%20is%5Fiostat%5Fend%28ios%29%20%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27end%20of%20file%2E%20Goodbye%21%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ERROR%3A%27%2Cios%2Ctrim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20exit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fiostat%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> is_iostat_end
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_iostat
      implicit none
      real               :: value
      integer            :: ios
      character(len=256) :: message
         write(*,*)'Begin entering numeric values, one per line'
         do
            read(*,*,iostat=ios,iomsg=message)value
            if(ios.eq.0)then
               write(*,*)'VALUE=',value
            elseif( is_iostat_end(ios) ) then
               stop 'end of file. Goodbye!'
            else
               write(*,*)'ERROR:',ios,trim(message)
               exit
            endif
            !
         enddo
      end program demo_iostat
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fis%5Fiostat%5Feor%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20iostat%5Feor%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20inums%285%29%2C%20lun%2C%20ios%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20create%20a%20test%20file%20to%20read%20from%0D%0A%20%20%20%20%20%20%20%20%20open%28newunit%3Dlun%2C%20form%3D%27formatted%27%2Cstatus%3D%27scratch%27%29%0D%0A%20%20%20%20%20%20%20%20%20write%28lun%2C%20%27%28a%29%27%29%20%2710%2020%2030%27%0D%0A%20%20%20%20%20%20%20%20%20write%28lun%2C%20%27%28a%29%27%29%20%2740%2050%2060%2070%27%0D%0A%20%20%20%20%20%20%20%20%20write%28lun%2C%20%27%28a%29%27%29%20%2780%2090%27%0D%0A%20%20%20%20%20%20%20%20%20write%28lun%2C%20%27%28a%29%27%29%20%27100%27%0D%0A%20%20%20%20%20%20%20%20%20rewind%28lun%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20do%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%28lun%2C%20%2A%2C%20iostat%3Dios%29%20inums%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27iostat%3D%27%2Cios%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28is%5Fiostat%5Feor%28ios%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27end%20of%20record%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20elseif%28is%5Fiostat%5Fend%28ios%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27end%20of%20file%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20exit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20elseif%28ios%2Ene%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%27I%2FO%20error%27%2Cios%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20exit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20close%28lun%2Ciostat%3Dios%2Cstatus%3D%27delete%27%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fis%5Fiostat%5Feor%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> is_iostat_eor
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_is_iostat_eor
      use iso_fortran_env, only : iostat_eor
      implicit none
      integer :: inums(5), lun, ios

        ! create a test file to read from
         open(newunit=lun, form='formatted',status='scratch')
         write(lun, '(a)') '10 20 30'
         write(lun, '(a)') '40 50 60 70'
         write(lun, '(a)') '80 90'
         write(lun, '(a)') '100'
         rewind(lun)

         do
            read(lun, *, iostat=ios) inums
            write(*,*)'iostat=',ios
            if(is_iostat_eor(ios)) then
               stop 'end of record'
            elseif(is_iostat_end(ios)) then
               print *,'end of file'
               exit
            elseif(ios.ne.0)then
               print *,'I/O error',ios
               exit
            endif
         enddo

         close(lun,iostat=ios,status='delete')

      end program demo_is_iostat_eor
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fkind%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20dc%20%3D%20kind%28%27%20%27%29%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20dl%20%3D%20kind%28%2Etrue%2E%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20default%20character%20kind%20is%20%22%2C%20dc%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20default%20logical%20kind%20is%20%22%2C%20dl%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fkind%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> kind
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_kind
      implicit none
      integer,parameter :: dc = kind(' ')
      integer,parameter :: dl = kind(.true.)

         print *, "The default character kind is ", dc
         print *, "The default logical kind is ", dl

      end program demo_kind
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%21%20program%20demo%5Flbound%0D%0A%20%20%20%20%20%20module%20m%5Fbounds%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%20%20%20%20subroutine%20msub%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%21integer%2Cintent%28in%29%20%3A%3A%20arr%28%2A%29%20%20%21%20cannot%20be%20assumed%2Dsize%20array%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27MSUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20end%20subroutine%20msub%0D%0A%20%20%20%20%20%20%20end%20module%20m%5Fbounds%0D%0A%0D%0A%20%20%20%20%20%20%20program%20demo%5Flbound%0D%0A%20%20%20%20%20%20%20use%20m%5Fbounds%2C%20only%20%3A%20msub%0D%0A%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20interface%0D%0A%20%20%20%20%20%20%20%20%20%20subroutine%20esub%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20end%20subroutine%20esub%0D%0A%20%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20%20integer%20%3A%3A%20arr%28%2D10%3A10%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27MAIN%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20csub%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20msub%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20esub%28arr%29%0D%0A%20%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20subroutine%20csub%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27CSUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20end%20subroutine%20csub%0D%0A%20%20%20%20%20%20end%0D%0A%0D%0A%20%20%20%20%20%20%20subroutine%20esub%28arr%29%0D%0A%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20WARNING%3A%20IF%20CALLED%20WITHOUT%20AN%20EXPLICIT%20INTERFACE%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20THIS%20WILL%20GIVE%20UNDEFINED%20ANSWERS%20%28like%200%2C0%2C0%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ESUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20%20end%20subroutine%20esub%0D%0A%0D%0A%20%20%20%20%20%20%21end%20program%20demo%5Flbound%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> lbound
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      ! program demo_lbound
      module m_bounds
      implicit none
       contains
          subroutine msub(arr)
             !!integer,intent(in) :: arr(*)  ! cannot be assumed-size array
             integer,intent(in) :: arr(:)
             write(*,*)'MSUB: LOWER=',lbound(arr), &
             & 'UPPER=',ubound(arr), &
             & 'SIZE=',size(arr)
          end subroutine msub
       end module m_bounds

       program demo_lbound
       use m_bounds, only : msub
       implicit none
       interface
          subroutine esub(arr)
          integer,intent(in) :: arr(:)
          end subroutine esub
       end interface
       integer :: arr(-10:10)
          write(*,*)'MAIN: LOWER=',lbound(arr), &
          & 'UPPER=',ubound(arr), &
          & 'SIZE=',size(arr)
          call csub()
          call msub(arr)
          call esub(arr)
       contains
      subroutine csub
         write(*,*)'CSUB: LOWER=',lbound(arr), &
         & 'UPPER=',ubound(arr), &
         & 'SIZE=',size(arr)
      end subroutine csub
      end

       subroutine esub(arr)
       implicit none
       integer,intent(in) :: arr(:)
          ! WARNING: IF CALLED WITHOUT AN EXPLICIT INTERFACE
          ! THIS WILL GIVE UNDEFINED ANSWERS (like 0,0,0)
          write(*,*)'ESUB: LOWER=',lbound(arr), &
          & 'UPPER=',ubound(arr), &
          & 'SIZE=',size(arr)
       end subroutine esub

      !end program demo_lbound
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> lcobound
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fleadz%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20value%2C%20i%0D%0A%20%20%20%20%20%20character%28len%3D80%29%20%3A%3A%20f%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20make%20a%20format%20statement%20for%20writing%20a%20value%20as%20a%20bit%20string%0D%0A%20%20%20%20%20%20%20%20write%28f%2C%27%28%22%28b%22%2Ci0%2C%22%2E%22%2Ci0%2C%22%29%22%29%27%29bit%5Fsize%28value%29%2Cbit%5Fsize%28value%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20show%20output%20for%20various%20integer%20values%0D%0A%20%20%20%20%20%20%20%20value%3D0%0D%0A%20%20%20%20%20%20%20%20do%20i%3D%2D150%2C%20150%2C%2050%0D%0A%20%20%20%20%20%20%20%20%20%20%20value%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%27%28%22LEADING%20ZERO%20BITS%3D%22%2Ci3%29%27%2Cadvance%3D%27no%27%29%20leadz%28value%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%27%28%22%20OF%20VALUE%20%22%29%27%2Cadvance%3D%27no%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%2Cadvance%3D%27no%27%29%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%281x%2Cg0%29%29%27%29%20%22AKA%22%2Cvalue%0D%0A%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%21%20Notes%3A%0D%0A%20%20%20%20%20%20%20%20%21%20for%20two%27s%2Dcomplements%20programming%20environments%20a%20negative%20non%2Dzero%0D%0A%20%20%20%20%20%20%20%20%21%20integer%20value%20will%20always%20start%20with%20a%201%20and%20a%20positive%20value%20with%200%0D%0A%20%20%20%20%20%20%20%20%21%20as%20the%20first%20bit%20is%20the%20sign%20bit%2E%20Such%20platforms%20are%20very%20common%2E%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fleadz%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> leadz
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_leadz
      implicit none
      integer :: value, i
      character(len=80) :: f

        ! make a format statement for writing a value as a bit string
        write(f,'("(b",i0,".",i0,")")')bit_size(value),bit_size(value)

        ! show output for various integer values
        value=0
        do i=-150, 150, 50
           value=i
           write (*,'("LEADING ZERO BITS=",i3)',advance='no') leadz(value)
           write (*,'(" OF VALUE ")',advance='no')
           write(*,f,advance='no') value
           write(*,'(*(1x,g0))') "AKA",value
        enddo
        ! Notes:
        ! for two's-complements programming environments a negative non-zero
        ! integer value will always start with a 1 and a positive value with 0
        ! as the first bit is the sign bit. Such platforms are very common.
      end program demo_leadz
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flen%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%20fixed%20length%0D%0A%20%20%20%20%20%20character%28len%3D40%29%20%3A%3A%20string%0D%0A%20%20%20%20%20%20%21%20allocatable%20length%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20astring%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20many%5Fstrings%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20ii%0D%0A%20%20%20%20%20%20%20%20%21%20BASIC%20USAGE%0D%0A%20%20%20%20%20%20%20%20%20ii%3Dlen%28string%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27length%20%3D%27%2Cii%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20ALLOCATABLE%20VARIABLE%20LENGTH%20CAN%20CHANGE%0D%0A%20%20%20%20%20%20%20%20%21%20the%20allocatable%20string%20length%20will%20be%20the%20length%20of%20RHS%20expression%0D%0A%20%20%20%20%20%20%20%20%20astring%3D%27%20How%20long%20is%20this%20allocatable%20string%3F%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29astring%2C%20%27%20LEN%3D%27%2C%20len%28astring%29%0D%0A%20%20%20%20%20%20%20%20%21%20print%20underline%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20repeat%28%27%3D%27%2Clen%28astring%29%29%0D%0A%20%20%20%20%20%20%20%20%21%20assign%20new%20value%20to%20astring%20and%20length%20changes%0D%0A%20%20%20%20%20%20%20%20%20astring%3D%27New%20allocatable%20string%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29astring%2C%20%27%20LEN%3D%27%2C%20len%28astring%29%0D%0A%20%20%20%20%20%20%20%20%21%20print%20underline%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20repeat%28%27%3D%27%2Clen%28astring%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20THE%20STRING%20LENGTH%20WILL%20BE%20CONSTANT%20FOR%20A%20FIXED%2DLENGTH%20VARIABLE%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27%20How%20long%20is%20this%20fixed%20string%3F%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29string%2C%27%20LEN%3D%27%2Clen%28string%29%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27New%20fixed%20string%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29string%2C%27%20LEN%3D%27%2Clen%28string%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20ALL%20STRINGS%20IN%20AN%20ARRAY%20ARE%20THE%20SAME%20LENGTH%0D%0A%20%20%20%20%20%20%20%20%21%20a%20scalar%20is%20returned%20for%20an%20array%2C%20as%20all%20values%20in%20a%20Fortran%0D%0A%20%20%20%20%20%20%20%20%21%20character%20array%20must%20be%20of%20the%20same%20length%2E%0D%0A%20%20%20%20%20%20%20%20%20many%5Fstrings%20%3D%20%5B%20character%28len%3D7%29%20%3A%3A%20%27Tom%27%2C%20%27Dick%27%2C%20%27Harry%27%20%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27length%20of%20ALL%20elements%20of%20array%3D%27%2Clen%28many%5Fstrings%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20NAME%25LEN%20IS%20ESSENTIALLY%20THE%20SAME%20AS%20LEN%28NAME%29%0D%0A%20%20%20%20%20%20%20%20%21%20you%20can%20also%20query%20the%20length%20%28and%20other%20attributes%29%20of%20a%20string%0D%0A%20%20%20%20%20%20%20%20%21%20using%20a%20%22type%20parameter%20inquiry%22%20%28available%20since%20fortran%202018%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27length%20from%20type%20parameter%20inquiry%3D%27%2Cstring%25len%0D%0A%20%20%20%20%20%20%20%20%21%20%25len%20is%20equivalent%20to%20a%20call%20to%20LEN%28%29%20except%20the%20kind%20of%20the%20integer%0D%0A%20%20%20%20%20%20%20%20%21%20value%20returned%20is%20always%20of%20default%20kind%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20LOOK%20AT%20HOW%20A%20PASSED%20STRING%20CAN%20BE%20USED%20%2E%2E%2E%0D%0A%20%20%20%20%20%20%20%20%20call%20passed%28%27%20how%20long%3F%20%27%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20passed%28str%29%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20str%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20length%20of%20str%20can%20be%20used%20in%20the%20definitions%20of%20variables%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20you%20can%20query%20the%20length%20of%20the%20passed%20variable%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27length%20of%20passed%20value%20is%20%27%2C%20LEN%28str%29%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%20passed%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flen%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> len
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_len
      implicit none

      ! fixed length
      character(len=40) :: string
      ! allocatable length
      character(len=:),allocatable :: astring
      character(len=:),allocatable :: many_strings(:)
      integer :: ii
        ! BASIC USAGE
         ii=len(string)
         write(*,*)'length =',ii

        ! ALLOCATABLE VARIABLE LENGTH CAN CHANGE
        ! the allocatable string length will be the length of RHS expression
         astring=' How long is this allocatable string? '
         write(*,*)astring, ' LEN=', len(astring)
        ! print underline
         write(*,*) repeat('=',len(astring))
        ! assign new value to astring and length changes
         astring='New allocatable string'
         write(*,*)astring, ' LEN=', len(astring)
        ! print underline
         write(*,*) repeat('=',len(astring))

        ! THE STRING LENGTH WILL BE CONSTANT FOR A FIXED-LENGTH VARIABLE
         string=' How long is this fixed string? '
         write(*,*)string,' LEN=',len(string)
         string='New fixed string '
         write(*,*)string,' LEN=',len(string)

        ! ALL STRINGS IN AN ARRAY ARE THE SAME LENGTH
        ! a scalar is returned for an array, as all values in a Fortran
        ! character array must be of the same length.
         many_strings = [ character(len=7) :: 'Tom', 'Dick', 'Harry' ]
         write(*,*)'length of ALL elements of array=',len(many_strings)

        ! NAME%LEN IS ESSENTIALLY THE SAME AS LEN(NAME)
        ! you can also query the length (and other attributes) of a string
        ! using a "type parameter inquiry" (available since fortran 2018)
         write(*,*)'length from type parameter inquiry=',string%len
        ! %len is equivalent to a call to LEN() except the kind of the integer
        ! value returned is always of default kind.

        ! LOOK AT HOW A PASSED STRING CAN BE USED ...
         call passed(' how long? ')

      contains

         subroutine passed(str)
         character(len=*),intent(in)  :: str
         ! the length of str can be used in the definitions of variables
            ! you can query the length of the passed variable
            write(*,*)'length of passed value is ', LEN(str)
         end subroutine passed

      end program demo_len
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flen%5Ftrim%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20string%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20string%3D%22%20how%20long%20is%20this%20string%3F%20%20%20%20%20%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20string%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27UNTRIMMED%20LENGTH%3D%27%2Clen%28string%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27TRIMMED%20LENGTH%3D%27%2Clen%5Ftrim%28string%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20string%2C%20then%20print%20substring%20of%20string%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27xxxxx%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29string%2Cstring%2Cstring%0D%0A%20%20%20%20%20%20%20%20%20i%3Dlen%5Ftrim%28string%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29string%28%3Ai%29%2Cstring%28%3Ai%29%2Cstring%28%3Ai%29%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%20example%0D%0A%20%20%20%20%20%20%20%20%20ELE%3Ablock%0D%0A%20%20%20%20%20%20%20%20%20%21%20an%20array%20of%20strings%20may%20be%20used%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20tablet%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20tablet%3D%5Bcharacter%28len%3D256%29%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27%20how%20long%20is%20this%20string%3F%20%20%20%20%20%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27and%20this%20one%3F%27%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27UNTRIMMED%20LENGTH%3D%20%20%27%2Clen%28tablet%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27TRIMMED%20LENGTH%3D%20%20%20%20%27%2Clen%5Ftrim%28tablet%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SUM%20TRIMMED%20LENGTH%3D%27%2Csum%28len%5Ftrim%28tablet%29%29%0D%0A%20%20%20%20%20%20%20%20%20endblock%20ELE%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flen%5Ftrim%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> len_trim
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_len_trim
      implicit none
      character(len=:),allocatable :: string
      integer :: i
      ! basic usage
         string=" how long is this string?     "
         write(*,*) string
         write(*,*)'UNTRIMMED LENGTH=',len(string)
         write(*,*)'TRIMMED LENGTH=',len_trim(string)

         ! print string, then print substring of string
         string='xxxxx   '
         write(*,*)string,string,string
         i=len_trim(string)
         write(*,*)string(:i),string(:i),string(:i)
         !
        ! elemental example
         ELE:block
         ! an array of strings may be used
         character(len=:),allocatable :: tablet(:)
         tablet=[character(len=256) :: &
         & ' how long is this string?     ',&
         & 'and this one?']
            write(*,*)'UNTRIMMED LENGTH=  ',len(tablet)
            write(*,*)'TRIMMED LENGTH=    ',len_trim(tablet)
            write(*,*)'SUM TRIMMED LENGTH=',sum(len_trim(tablet))
         endblock ELE
         !
      end program demo_len_trim
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flge%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27the%20ASCII%20collating%20sequence%20for%20printable%20characters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2C19a%29%27%29%28char%28i%29%2Ci%3D32%2C126%29%20%21%20ASCII%20order%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27abc%27%2C%27ABC%27%29%20%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%20lowercase%20is%20%3E%20uppercase%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27abc%27%2C%27abc%20%20%27%29%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%20trailing%20spaces%0D%0A%20%20%20%20%20%20%20%20%20%21%20If%20both%20strings%20are%20of%20zero%20length%20the%20result%20is%20true%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27%27%2C%27a%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%20the%20null%20string%20is%20padded%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27a%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%27abc%27%2C%5B%27abc%27%2C%27123%27%5D%29%20%20%20%21%20%5BT%20T%5D%20%20scalar%20and%20array%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%5B%27cba%27%2C%20%27123%27%5D%2C%27abc%27%29%20%20%21%20%5BT%20F%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lge%28%5B%27abc%27%2C%27123%27%5D%2C%5B%27cba%27%2C%27123%27%5D%29%20%21%20%5BF%20T%5D%20%20both%20arrays%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flge%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> lge
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_lge
      implicit none
      integer :: i
         print *,'the ASCII collating sequence for printable characters'
         write(*,'(1x,19a)')(char(i),i=32,126) ! ASCII order
         write(*,*) lge('abc','ABC')           ! [T] lowercase is > uppercase
         write(*,*) lge('abc','abc  ')         ! [T] trailing spaces
         ! If both strings are of zero length the result is true
         write(*,*) lge('','')                 ! [T]
         write(*,*) lge('','a')                ! [F] the null string is padded
         write(*,*) lge('a','')                ! [T]
         ! elemental
         write(*,*) lge('abc',['abc','123'])   ! [T T]  scalar and array
         write(*,*) lge(['cba', '123'],'abc')  ! [T F]
         write(*,*) lge(['abc','123'],['cba','123']) ! [F T]  both arrays
      end program demo_lge
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flgt%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27the%20ASCII%20collating%20sequence%20for%20printable%20characters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2C19a%29%27%29%28char%28i%29%2Ci%3D32%2C126%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27abc%27%2C%27ABC%27%29%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%20lowercase%20is%20%3E%20uppercase%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27abc%27%2C%27abc%20%20%27%29%20%20%20%20%20%20%20%20%21%20%5BF%5D%20trailing%20spaces%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20If%20both%20strings%20are%20of%20zero%20length%20the%20result%20is%20false%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27%27%2C%27a%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%20the%20null%20string%20is%20padded%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27a%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%27abc%27%2C%5B%27abc%27%2C%27123%27%5D%29%20%20%21%20%5BF%20T%5D%20%20scalar%20and%20array%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%5B%27cba%27%2C%20%27123%27%5D%2C%27abc%27%29%20%21%20%5BT%20F%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lgt%28%5B%27abc%27%2C%27123%27%5D%2C%5B%27cba%27%2C%27123%27%5D%29%20%21%20%5BF%20F%5D%20%20both%20arrays%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flgt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> lgt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_lgt
      implicit none
      integer :: i
         print *,'the ASCII collating sequence for printable characters'
         write(*,'(1x,19a)')(char(i),i=32,126)

         write(*,*) lgt('abc','ABC')          ! [T] lowercase is > uppercase
         write(*,*) lgt('abc','abc  ')        ! [F] trailing spaces

         ! If both strings are of zero length the result is false.
         write(*,*) lgt('','')                ! [F]
         write(*,*) lgt('','a')               ! [F] the null string is padded
         write(*,*) lgt('a','')               ! [T]
         write(*,*) lgt('abc',['abc','123'])  ! [F T]  scalar and array
         write(*,*) lgt(['cba', '123'],'abc') ! [T F]
         write(*,*) lgt(['abc','123'],['cba','123']) ! [F F]  both arrays
      end program demo_lgt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flle%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27the%20ASCII%20collating%20sequence%20for%20printable%20characters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2C19a%29%27%29%28char%28i%29%2Ci%3D32%2C126%29%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27case%20matters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abc%27%2C%27ABC%27%29%20%20%20%20%20%20%20%21%20F%20lowercase%20is%20%3E%20uppercase%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27a%20space%20is%20the%20lowest%20printable%20character%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abcd%27%2C%27abc%27%29%20%20%20%20%20%20%21%20F%20%20d%20%3E%20space%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abc%27%2C%27abcd%27%29%20%20%20%20%20%20%21%20T%20%20space%20%3C%20d%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27leading%20spaces%20matter%2C%20trailing%20spaces%20do%20not%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abc%27%2C%27abc%20%20%27%29%20%20%20%20%20%21%20T%20trailing%20spaces%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abc%27%2C%27%20abc%27%29%20%20%20%20%20%20%21%20F%20leading%20spaces%20are%20significant%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27even%20null%20strings%20are%20padded%20and%20compared%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20If%20both%20strings%20are%20of%20zero%20length%20the%20result%20is%20true%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20T%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27%27%2C%27a%27%29%20%20%20%20%20%20%20%20%20%20%20%20%21%20T%20the%20null%20string%20is%20padded%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27a%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%21%20F%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%27abc%27%2C%5B%27abc%27%2C%27123%27%5D%29%20%20%21%20%5BT%2CF%5D%20scalar%20and%20array%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%5B%27cba%27%2C%20%27123%27%5D%2C%27abc%27%29%20%21%20%5BF%2CT%5D%0D%0A%20%20%20%20%20%20%20%20%20%21%20per%20the%20rules%20for%20elemental%20procedures%20arrays%20must%20be%20the%20same%20size%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20lle%28%5B%27abc%27%2C%27123%27%5D%2C%5B%27cba%27%2C%27123%27%5D%29%20%21%20%5BT%2CT%5D%20both%20arrays%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flle%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> lle
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_lle
      implicit none
      integer :: i
         print *,'the ASCII collating sequence for printable characters'
         write(*,'(1x,19a)')(char(i),i=32,126)
        ! basics

         print *,'case matters'
         write(*,*) lle('abc','ABC')       ! F lowercase is > uppercase

         print *,'a space is the lowest printable character'
         write(*,*) lle('abcd','abc')      ! F  d > space
         write(*,*) lle('abc','abcd')      ! T  space < d

         print *,'leading spaces matter, trailing spaces do not'
         write(*,*) lle('abc','abc  ')     ! T trailing spaces
         write(*,*) lle('abc',' abc')      ! F leading spaces are significant

         print *,'even null strings are padded and compared'
         ! If both strings are of zero length the result is true.
         write(*,*) lle('','')             ! T
         write(*,*) lle('','a')            ! T the null string is padded
         write(*,*) lle('a','')            ! F
         print *,'elemental'
         write(*,*) lle('abc',['abc','123'])  ! [T,F] scalar and array
         write(*,*) lle(['cba', '123'],'abc') ! [F,T]
         ! per the rules for elemental procedures arrays must be the same size
         write(*,*) lle(['abc','123'],['cba','123']) ! [T,T] both arrays
      end program demo_lle
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fllt%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27the%20ASCII%20collating%20sequence%20for%20printable%20characters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2C19a%29%27%29%28char%28i%29%2Ci%3D32%2C126%29%20%21%20ASCII%20order%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27case%20matters%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27abc%27%2C%27ABC%27%29%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%20lowercase%20is%20%3E%20uppercase%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27abc%27%2C%27abc%20%20%27%29%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%20trailing%20spaces%0D%0A%20%20%20%20%20%20%20%20%20%21%20If%20both%20strings%20are%20of%20zero%20length%20the%20result%20is%20false%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27%27%2C%27a%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BT%5D%20the%20null%20string%20is%20padded%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27a%27%2C%27%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20%5BF%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%27abc%27%2C%5B%27abc%27%2C%27123%27%5D%29%20%20%20%21%20%5BF%20F%5D%20%20scalar%20and%20array%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%5B%27cba%27%2C%20%27123%27%5D%2C%27abc%27%29%20%20%21%20%5BF%20T%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20llt%28%5B%27abc%27%2C%27123%27%5D%2C%5B%27cba%27%2C%27123%27%5D%29%20%21%20%5BT%20F%5D%20%20both%20arrays%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fllt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> llt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_llt
      implicit none
      integer :: i

         print *,'the ASCII collating sequence for printable characters'
         write(*,'(1x,19a)')(char(i),i=32,126) ! ASCII order

        ! basics
         print *,'case matters'
         write(*,*) llt('abc','ABC')           ! [F] lowercase is > uppercase
         write(*,*) llt('abc','abc  ')         ! [F] trailing spaces
         ! If both strings are of zero length the result is false.
         write(*,*) llt('','')                 ! [F]
         write(*,*) llt('','a')                ! [T] the null string is padded
         write(*,*) llt('a','')                ! [F]
         print *,'elemental'
         write(*,*) llt('abc',['abc','123'])   ! [F F]  scalar and array
         write(*,*) llt(['cba', '123'],'abc')  ! [F T]
         write(*,*) llt(['abc','123'],['cba','123']) ! [T F]  both arrays
      end program demo_llt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flog10%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%2010%2E0%5Freal64%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20log10%28x%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27log10%28%27%2Cx%2C%27%29%20is%20%27%2Clog10%28x%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29log10%28%5B1%2E0%2C%2010%2E0%2C%20100%2E0%2C%201000%2E0%2C%2010000%2E0%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20100000%2E0%2C%201000000%2E0%2C%2010000000%2E0%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flog10%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> log10
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_log10
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 10.0_real64

         x = log10(x)
         write(*,'(*(g0))')'log10(',x,') is ',log10(x)

         ! elemental
         write(*, *)log10([1.0, 10.0, 100.0, 1000.0, 10000.0, &
                           & 100000.0, 1000000.0, 10000000.0])

      end program demo_log10
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flog%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20real%28kind%280%2E0d0%29%29%20%3A%3A%20x%20%3D%202%2E71828182845904518d0%0D%0A%20%20%20%20%20%20%20%20complex%20%3A%3A%20z%20%3D%20%281%2E0%2C%202%2E0%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2C%20log%28x%29%20%20%20%20%21%20will%20yield%20%28approximately%29%201%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29z%2C%20log%28z%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flog%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> log
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_log
      implicit none
        real(kind(0.0d0)) :: x = 2.71828182845904518d0
        complex :: z = (1.0, 2.0)
        write(*,*)x, log(x)    ! will yield (approximately) 1
        write(*,*)z, log(z)
      end program demo_log
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flog%5Fgamma%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%201%2E0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2Clog%5Fgamma%28x%29%20%21%20returns%200%2E0%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2Clog%5Fgamma%283%2E0%29%20%21%20returns%200%2E693%20%28approximately%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flog%5Fgamma%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> log_gamma
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_log_gamma
      implicit none
      real :: x = 1.0
         write(*,*)x,log_gamma(x) ! returns 0.0
         write(*,*)x,log_gamma(3.0) ! returns 0.693 (approximately)
      end program demo_log_gamma
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Flogical%0D%0A%20%20%20%20%20%20%21%20Access%20array%20containing%20the%20kind%20type%20parameter%20values%20supported%20by%20this%0D%0A%20%20%20%20%20%20%21%20compiler%20for%20entities%20of%20logical%20type%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20logical%5Fkinds%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20list%20kind%20values%20supported%20on%20this%20platform%2C%20which%20generally%20vary%0D%0A%20%20%20%20%20%20%20%20%20%21%20in%20storage%20size%20as%20alias%20declarations%0D%0A%20%20%20%20%20%20%20%20%20do%20i%20%3D1%2C%20size%28logical%5Fkinds%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%29%29%27%29%27integer%2Cparameter%20%3A%3A%20boolean%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20logical%5Fkinds%28i%29%2C%27%3D%27%2C%20logical%5Fkinds%28i%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Flogical%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> logical
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_logical
      ! Access array containing the kind type parameter values supported by this
      ! compiler for entities of logical type
      use iso_fortran_env, only : logical_kinds
      implicit none
      integer :: i

         ! list kind values supported on this platform, which generally vary
         ! in storage size as alias declarations
         do i =1, size(logical_kinds)
            write(*,'(*(g0))')'integer,parameter :: boolean', &
            & logical_kinds(i),'=', logical_kinds(i)
         enddo

      end program demo_logical
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmaskl%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20i%3D3%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2C1x%2Cb0%29%27%29%20i%2C%20maskl%28i%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28i11%2C1x%2Cb0%2E32%2C1x%2C%2F%29%29%27%29%20maskl%28%5B%28i%2Ci%2Ci%3D0%2Cbit%5Fsize%280%29%2C4%29%5D%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmaskl%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> maskl
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_maskl
      implicit none
      integer :: i
        ! basics
         i=3
         write(*,'(i0,1x,b0)') i, maskl(i)

        ! elemental
         write(*,'(*(i11,1x,b0.32,1x,/))') maskl([(i,i,i=0,bit_size(0),4)])
      end program demo_maskl
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmaskr%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27basics%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%201%2C%20maskr%281%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%205%2C%20%20maskr%285%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%2011%2C%20maskr%2811%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%22should%20be%20equivalent%20on%20two%27s%2Dcomplement%20processors%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%201%2C%20%20shiftr%28%2D1%2Cbit%5Fsize%280%29%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%205%2C%20%20shiftr%28%2D1%2Cbit%5Fsize%280%29%2D5%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2Ct5%2Cb32%2E32%29%27%29%2011%2C%20shiftr%28%2D1%2Cbit%5Fsize%280%29%2D11%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27elemental%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27%28array%20argument%20accepted%20like%20called%20with%20each%20element%29%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28i11%2C1x%2Cb0%2E32%2C1x%2C%2F%29%29%27%29%20maskr%28%5B%28i%2Ci%2Ci%3D0%2Cbit%5Fsize%280%29%2C4%29%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmaskr%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> maskr
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_maskr
      implicit none
      integer :: i

        ! basics
         print *,'basics'
         write(*,'(i0,t5,b32.32)') 1, maskr(1)
         write(*,'(i0,t5,b32.32)') 5,  maskr(5)
         write(*,'(i0,t5,b32.32)') 11, maskr(11)
         print *,"should be equivalent on two's-complement processors"
         write(*,'(i0,t5,b32.32)') 1,  shiftr(-1,bit_size(0)-1)
         write(*,'(i0,t5,b32.32)') 5,  shiftr(-1,bit_size(0)-5)
         write(*,'(i0,t5,b32.32)') 11, shiftr(-1,bit_size(0)-11)

        ! elemental
         print *,'elemental '
         print *,'(array argument accepted like called with each element)'
         write(*,'(*(i11,1x,b0.32,1x,/))') maskr([(i,i,i=0,bit_size(0),4)])

      end program demo_maskr
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmatmul%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20a%282%2C3%29%2C%20b%283%2C2%29%2C%20c%282%29%2C%20d%283%29%2C%20e%282%2C2%29%2C%20f%283%29%2C%20g%282%29%2C%20v1%284%29%2Cv2%284%29%0D%0A%20%20%20%20%20%20%20%20%20a%20%3D%20reshape%28%5B1%2C%202%2C%203%2C%204%2C%205%2C%206%5D%2C%20%5B2%2C%203%5D%29%0D%0A%20%20%20%20%20%20%20%20%20b%20%3D%20reshape%28%5B10%2C%2020%2C%2030%2C%2040%2C%2050%2C%2060%5D%2C%20%5B3%2C%202%5D%29%0D%0A%20%20%20%20%20%20%20%20%20c%20%3D%20%5B1%2C%202%5D%0D%0A%20%20%20%20%20%20%20%20%20d%20%3D%20%5B1%2C%202%2C%203%5D%0D%0A%20%20%20%20%20%20%20%20%20e%20%3D%20matmul%28a%2C%20b%29%0D%0A%20%20%20%20%20%20%20%20%20f%20%3D%20matmul%28c%2Ca%29%0D%0A%20%20%20%20%20%20%20%20%20g%20%3D%20matmul%28a%2Cd%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27A%20is%20%27%2Ca%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27B%20is%20%27%2Cb%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27C%20is%20%27%2Cc%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27D%20is%20%27%2Cd%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27E%20is%20matmul%28A%2CB%29%27%2Ce%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27F%20is%20matmul%28C%2CA%29%27%2Cf%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27G%20is%20matmul%28A%2CD%29%27%2Cg%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20look%20at%20argument%20shapes%20when%20one%20is%20a%20vector%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%3E%20shape%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20at%20least%20one%20argument%20must%20be%20of%20rank%20two%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20for%20two%20vectors%20at%20least%20one%20must%20be%20reshaped%0D%0A%20%20%20%20%20%20%20%20%20v1%3D%5B11%2C22%2C33%2C44%5D%0D%0A%20%20%20%20%20%20%20%20%20v2%3D%5B10%2C20%2C30%2C40%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20these%20return%20a%20vector%20C%281%3A1%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20treat%20A%281%3An%29%20as%20A%281%3A1%2C1%3An%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27Cd%20is%20a%20vector%20%28not%20a%20scalar%29%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20matmul%28reshape%28v1%2C%5B1%2Csize%28v1%29%5D%29%2Cv2%29%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20or%20treat%20B%281%3Am%29%20as%20B%281%3Am%2C1%3A1%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fvector%5Fint%28%27cD%20is%20a%20vector%20too%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20matmul%28v1%2Creshape%28v2%2C%5Bsize%28v2%29%2C1%5D%29%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20or%20treat%20A%281%3An%29%20as%20A%281%3A1%2C1%3An%29%20and%20B%281%3Am%29%20as%20B%281%3Am%2C1%3A1%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20but%20note%20this%20returns%20a%20matrix%20C%281%3A1%2C1%3A1%29%20not%20a%20vector%21%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27CD%20is%20a%20matrix%27%2Cmatmul%28%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20reshape%28v1%2C%5B1%2Csize%28v1%29%5D%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20reshape%28v2%2C%5Bsize%28v2%29%2C1%5D%29%29%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%21%20CONVENIENCE%20ROUTINES%20TO%20PRINT%20IN%20ROW%2DCOLUMN%20ORDER%0D%0A%20%20%20%20%20%20subroutine%20print%5Fvector%5Fint%28title%2Carr%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28title%2Creshape%28arr%2C%5B1%2Cshape%28arr%29%5D%29%29%0D%0A%20%20%20%20%20%20end%20subroutine%20print%5Fvector%5Fint%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20print%5Fmatrix%5Fint%28title%2Carr%29%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%22%20%3E%20%22%2C%2A%28g0%2C1x%29%29%27%20%21%20a%20handy%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20all%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20print%5Fmatrix%5Fint%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmatmul%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> matmul
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_matmul
      implicit none
      integer :: a(2,3), b(3,2), c(2), d(3), e(2,2), f(3), g(2), v1(4),v2(4)
         a = reshape([1, 2, 3, 4, 5, 6], [2, 3])
         b = reshape([10, 20, 30, 40, 50, 60], [3, 2])
         c = [1, 2]
         d = [1, 2, 3]
         e = matmul(a, b)
         f = matmul(c,a)
         g = matmul(a,d)

         call print_matrix_int('A is ',a)
         call print_matrix_int('B is ',b)
         call print_vector_int('C is ',c)
         call print_vector_int('D is ',d)
         call print_matrix_int('E is matmul(A,B)',e)
         call print_vector_int('F is matmul(C,A)',f)
         call print_vector_int('G is matmul(A,D)',g)

         ! look at argument shapes when one is a vector
         write(*,'(" > shape")')
         ! at least one argument must be of rank two
         ! so for two vectors at least one must be reshaped
         v1=[11,22,33,44]
         v2=[10,20,30,40]

         ! these return a vector C(1:1)
         ! treat A(1:n) as A(1:1,1:n)
         call print_vector_int('Cd is a vector (not a scalar)',&
         & matmul(reshape(v1,[1,size(v1)]),v2))
         ! or treat B(1:m) as B(1:m,1:1)
         call print_vector_int('cD is a vector too',&
         & matmul(v1,reshape(v2,[size(v2),1])))

         ! or treat A(1:n) as A(1:1,1:n) and B(1:m) as B(1:m,1:1)
         ! but note this returns a matrix C(1:1,1:1) not a vector!
         call print_matrix_int('CD is a matrix',matmul(&
         & reshape(v1,[1,size(v1)]), &
         & reshape(v2,[size(v2),1])))

      contains

      ! CONVENIENCE ROUTINES TO PRINT IN ROW-COLUMN ORDER
      subroutine print_vector_int(title,arr)
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:)
         call print_matrix_int(title,reshape(arr,[1,shape(arr)]))
      end subroutine print_vector_int

      subroutine print_matrix_int(title,arr)
      !@(#) print small 2d integer arrays in row-column format
      character(len=*),parameter :: all='(" > ",*(g0,1x))' ! a handy format
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest

         print all
         print all, trim(title)
         biggest='           '  ! make buffer to write integer into
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='(" > [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo

      end subroutine print_matrix_int

      end program demo_matmul
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmaxexponent%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real32%2Creal64%2Creal128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%20g%2C%20%20minexponent%280%2E0%5Freal32%29%2C%20%20%20maxexponent%280%2E0%5Freal32%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%20g%2C%20%20minexponent%280%2E0%5Freal64%29%2C%20%20%20maxexponent%280%2E0%5Freal64%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%20g%2C%20%20minexponent%280%2E0%5Freal128%29%2C%20%20maxexponent%280%2E0%5Freal128%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmaxexponent%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> maxexponent
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_maxexponent
      use, intrinsic :: iso_fortran_env, only : real32,real64,real128
      implicit none
      character(len=*),parameter :: g='(*(g0,1x))'
         print  g,  minexponent(0.0_real32),   maxexponent(0.0_real32)
         print  g,  minexponent(0.0_real64),   maxexponent(0.0_real64)
         print  g,  minexponent(0.0_real128),  maxexponent(0.0_real128)
      end program demo_maxexponent
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmax%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20arr1%284%29%3D%20%5B10%2E0%2C11%2E0%2C30%2E0%2C%2D100%2E0%5D%0D%0A%20%20%20%20%20%20real%20%3A%3A%20arr2%285%29%3D%20%5B20%2E0%2C21%2E0%2C32%2E0%2C%2D200%2E0%2C2200%2E0%5D%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20box%283%2C4%29%3D%20reshape%28%5B%2D6%2C%2D5%2C%2D4%2C%2D3%2C%2D2%2C%2D1%2C1%2C2%2C3%2C4%2C5%2C6%5D%2Cshape%28box%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20%21%20this%20is%20simple%20enough%20when%20all%20arguments%20are%20scalar%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20most%20positive%20value%20is%20returned%2C%20not%20the%20one%20with%20the%0D%0A%20%20%20%20%20%20%20%20%20%21%20largest%20magnitude%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27scalars%3A%27%2Cmax%2810%2E0%2C11%2E0%2C30%2E0%2C%2D100%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27scalars%3A%27%2Cmax%28%2D22222%2E0%2C%2D0%2E0001%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20strings%20do%20not%20need%20to%20be%20of%20the%20same%20length%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27characters%3A%27%2Cmax%28%27the%27%2C%27words%27%2C%27order%27%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20leading%20spaces%20are%20significant%3B%20everyone%20is%20padded%20on%20the%20right%0D%0A%20%20%20%20%20%20%20%20%20%21%20to%20the%20length%20of%20the%20longest%20argument%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27characters%3A%27%2Cmax%28%27c%27%2C%27bb%27%2C%27a%27%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27characters%3A%27%2Cmax%28%27%20c%27%2C%27b%27%2C%27a%27%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20%21%20there%20must%20be%20at%20least%20two%20arguments%2C%20so%20even%20if%20A1%20is%20an%20array%0D%0A%20%20%20%20%20%20%20%20%20%21%20max%28A1%29%20is%20not%20valid%2E%20See%20MAXVAL%283%29%20and%2For%20MAXLOC%283%29%20instead%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20strings%20in%20a%20single%20array%20do%20need%20to%20be%20of%20the%20same%20length%0D%0A%20%20%20%20%20%20%20%20%20%21%20but%20the%20different%20objects%20can%20still%20be%20of%20different%20lengths%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%22%28%2A%28%27%22%22%27%2Ca%2C%27%22%22%27%3A%2C1x%29%29%22%29MAX%28%5B%27A%27%2C%27Z%27%5D%2C%5B%27BB%27%2C%27Y%20%27%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20the%20result%20is%20now%20an%20array%20with%20the%20max%20of%20every%20element%0D%0A%20%20%20%20%20%20%20%20%20%21%20position%2C%20as%20can%20be%20illustrated%20numerically%20as%20well%3A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2A%28i3%2C1x%29%29%27%29%27box%3D%20%20%20%27%2Cbox%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2A%28i3%2C1x%29%29%27%29%27box%2A%2A2%3D%27%2Csign%281%2Cbox%29%2Abox%2A%2A2%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%2C%2A%28i3%2C1x%29%29%27%29%27max%20%20%20%20%27%2Cmax%28box%2Csign%281%2Cbox%29%2Abox%2A%2A2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20Remember%20if%20any%20argument%20is%20an%20array%20by%20the%20definition%20of%20an%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%20function%20all%20the%20array%20arguments%20must%20be%20the%20same%20shape%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20to%20find%20the%20single%20largest%20value%20of%20arrays%20you%20could%20use%20something%0D%0A%20%20%20%20%20%20%20%20%20%21%20like%20MAXVAL%28%5Barr1%2C%20arr2%5D%29%20or%20probably%20better%20%28no%20large%20temp%20array%29%2C%0D%0A%20%20%20%20%20%20%20%20%20%21%20max%28maxval%28arr1%29%2Cmaxval%28arr2%29%29%20instead%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20this%20returns%20an%20array%20of%20the%20same%20shape%20as%20any%20input%20array%0D%0A%20%20%20%20%20%20%20%20%20%21%20where%20each%20result%20is%20the%20maximum%20that%20occurs%20at%20that%20position%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29max%28arr1%2Carr2%281%3A4%29%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20this%20returns%20an%20array%20just%20like%20arr1%20except%20all%20values%20less%20than%0D%0A%20%20%20%20%20%20%20%20%20%21%20zero%20are%20set%20to%20zero%3A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29max%28box%2C0%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20When%20mixing%20arrays%20and%20scalars%20you%20can%20think%20of%20the%20scalars%0D%0A%20%20%20%20%20%20%20%20%20%21%20as%20being%20a%20copy%20of%20one%20of%20the%20arrays%20with%20all%20values%20set%20to%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20scalar%20value%2E%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmax%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> max
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_max
      implicit none
      real :: arr1(4)= [10.0,11.0,30.0,-100.0]
      real :: arr2(5)= [20.0,21.0,32.0,-200.0,2200.0]
      integer :: box(3,4)= reshape([-6,-5,-4,-3,-2,-1,1,2,3,4,5,6],shape(box))

        ! basic usage
         ! this is simple enough when all arguments are scalar

         ! the most positive value is returned, not the one with the
         ! largest magnitude
         write(*,*)'scalars:',max(10.0,11.0,30.0,-100.0)
         write(*,*)'scalars:',max(-22222.0,-0.0001)

         ! strings do not need to be of the same length
         write(*,*)'characters:',max('the','words','order')

         ! leading spaces are significant; everyone is padded on the right
         ! to the length of the longest argument
         write(*,*)'characters:',max('c','bb','a')
         write(*,*)'characters:',max(' c','b','a')

        ! elemental
         ! there must be at least two arguments, so even if A1 is an array
         ! max(A1) is not valid. See MAXVAL(3) and/or MAXLOC(3) instead.

         ! strings in a single array do need to be of the same length
         ! but the different objects can still be of different lengths.
         write(*,"(*('""',a,'""':,1x))")MAX(['A','Z'],['BB','Y '])
         ! note the result is now an array with the max of every element
         ! position, as can be illustrated numerically as well:
         write(*,'(a,*(i3,1x))')'box=   ',box
         write(*,'(a,*(i3,1x))')'box**2=',sign(1,box)*box**2
         write(*,'(a,*(i3,1x))')'max    ',max(box,sign(1,box)*box**2)

         ! Remember if any argument is an array by the definition of an
         ! elemental function all the array arguments must be the same shape.

         ! to find the single largest value of arrays you could use something
         ! like MAXVAL([arr1, arr2]) or probably better (no large temp array),
         ! max(maxval(arr1),maxval(arr2)) instead

         ! so this returns an array of the same shape as any input array
         ! where each result is the maximum that occurs at that position.
         write(*,*)max(arr1,arr2(1:4))
         ! this returns an array just like arr1 except all values less than
         ! zero are set to zero:
         write(*,*)max(box,0)
         ! When mixing arrays and scalars you can think of the scalars
         ! as being a copy of one of the arrays with all values set to
         ! the scalar value.

      end program demo_max
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmaxloc%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%3A%3A%20ii%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20i%28%2D3%3A3%29%3D%5B%28abs%28abs%28ii%29%2D50%29%2Cii%3D%2D3%2C3%29%5D%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20ints%283%2C5%29%3D%20reshape%28%5B%26%0D%0A%20%20%20%20%20%20%20%20%201%2C%20%202%2C%20%203%2C%20%204%2C%20%205%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%2010%2C%2020%2C%2030%2C%2040%2C%2050%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%2011%2C%2022%2C%2033%2C%2044%2C%2055%20%20%26%0D%0A%20%20%20%20%20%20%5D%2Cshape%28ints%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxloc%28ints%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxloc%28ints%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxloc%28ints%2Cdim%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20when%20array%20bounds%20do%20not%20start%20with%20one%20remember%20MAXLOC%283%29%20returns%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20offset%20relative%20to%20the%20lower%20bound%2D1%20of%20the%20location%20of%20the%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20maximum%20value%2C%20not%20the%20subscript%20of%20the%20maximum%20value%2E%20When%20the%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20lower%20bound%20of%20the%20array%20is%20one%2C%20these%20values%20are%20the%20same%2E%20In%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20other%20words%2C%20MAXLOC%283%29%20returns%20the%20subscript%20of%20the%20value%20assuming%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20first%20subscript%20of%20the%20array%20is%20one%20no%20matter%20what%20the%20lower%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20bound%20of%20the%20subscript%20actually%20is%2E%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28g0%2C1x%2Cg0%29%27%29%20%28ii%2Ci%28ii%29%2Cii%3Dlbound%28i%2Cdim%3D1%29%2Cubound%28i%2Cdim%3D1%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29maxloc%28i%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmaxloc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> maxloc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_maxloc
      implicit none
      integer      :: ii
      integer,save :: i(-3:3)=[(abs(abs(ii)-50),ii=-3,3)]
      integer,save :: ints(3,5)= reshape([&
         1,  2,  3,  4,  5, &
         10, 20, 30, 40, 50, &
         11, 22, 33, 44, 55  &
      ],shape(ints),order=[2,1])

          write(*,*) maxloc(ints)
          write(*,*) maxloc(ints,dim=1)
          write(*,*) maxloc(ints,dim=2)
          ! when array bounds do not start with one remember MAXLOC(3) returns
          ! the offset relative to the lower bound-1 of the location of the
          ! maximum value, not the subscript of the maximum value. When the
          ! lower bound of the array is one, these values are the same. In
          ! other words, MAXLOC(3) returns the subscript of the value assuming
          ! the first subscript of the array is one no matter what the lower
          ! bound of the subscript actually is.
          write(*,'(g0,1x,g0)') (ii,i(ii),ii=lbound(i,dim=1),ubound(i,dim=1))
          write(*,*)maxloc(i)

      end program demo_maxloc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmaxval%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20ints%283%2C5%29%3D%20reshape%28%5B%26%0D%0A%20%20%20%20%20%20%20%20%201%2C%20%202%2C%20%203%2C%20%204%2C%20%205%2C%20%26%0D%0A%20%20%20%20%20%20%20%2010%2C%2020%2C%2030%2C%2040%2C%2050%2C%20%26%0D%0A%20%20%20%20%20%20%20%2011%2C%2022%2C%2033%2C%2044%2C%2055%20%20%26%0D%0A%20%20%20%20%20%20%5D%2Cshape%28ints%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxval%28ints%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxval%28ints%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxval%28ints%2Cdim%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20biggest%20number%20less%20than%2030%20with%20mask%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20maxval%28ints%2Cmask%3Dints%2Elt%2E30%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmaxval%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> maxval
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_maxval
      implicit none
      integer,save :: ints(3,5)= reshape([&
         1,  2,  3,  4,  5, &
        10, 20, 30, 40, 50, &
        11, 22, 33, 44, 55  &
      ],shape(ints),order=[2,1])

         write(*,*) maxval(ints)
         write(*,*) maxval(ints,dim=1)
         write(*,*) maxval(ints,dim=2)
         ! find biggest number less than 30 with mask
         write(*,*) maxval(ints,mask=ints.lt.30)
      end program demo_maxval
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmerge%5Fbits%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint16%29%20%3A%3A%20if%5Fone%2Cif%5Fzero%2Cmsk%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20fmt%3D%27%28%2A%28g0%2C%201X%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27MERGE%5FBITS%28%205%2C10%2C41%29%20should%20be%203%2E%3D%3E%27%2Cmerge%5Fbits%285%2C10%2C41%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27MERGE%5FBITS%2813%2C18%2C22%29%20should%20be%204%2E%3D%3E%27%2Cmerge%5Fbits%2813%2C18%2C22%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20some%20values%20in%20base2%20illustratively%3A%0D%0A%20%20%20%20%20%20%20%20%20if%5Fone%20%3Dint%28b%271010101010101010%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20if%5Fzero%3Dint%28b%270101010101010101%27%2Ckind%3Dint16%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20msk%3Dint%28b%270101010101010101%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%22should%20get%20all%20zero%20bits%20%3D%3E%22%2Cb16%2E16%29%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20merge%5Fbits%28if%5Fone%2Cif%5Fzero%2Cmsk%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20msk%3Dint%28b%271010101010101010%27%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%28%22should%20get%20all%20ones%20bits%20%3D%3E%22%2Cb16%2E16%29%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20merge%5Fbits%28if%5Fone%2Cif%5Fzero%2Cmsk%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20using%20BOZ%20values%0D%0A%20%20%20%20%20%20%20%20%20print%20fmt%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20merge%5Fbits%2832767%5Fint16%2C%20%20%20%20o%2712345%27%2C%20%20%20%20%20%20%20%20%2032767%5Fint16%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20merge%5Fbits%28o%2712345%27%2C%2032767%5Fint16%2C%20b%270000000000010101%27%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20merge%5Fbits%2832767%5Fint16%2C%20%20%20%20o%2712345%27%2C%20%20%20%20%20%20%20%20%20%20%20%20%20z%271234%27%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20do%2Dit%2Dyourself%20equivalent%20for%20comparison%20and%20validation%0D%0A%20%20%20%20%20%20%20%20%20print%20fmt%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20ior%28iand%2832767%5Fint16%2C%2032767%5Fint16%29%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%20iand%28o%2712345%27%2C%20not%2832767%5Fint16%29%29%29%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%26%20ior%28iand%28o%2712345%27%2C%20int%28o%2712345%27%2C%20kind%3Dint16%29%29%2C%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%20iand%2832767%5Fint16%2C%20not%28int%28o%2712345%27%2C%20kind%3Dint16%29%29%29%29%2C%20%26%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%26%20ior%28iand%2832767%5Fint16%2C%20z%271234%27%29%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%20%20iand%28o%2712345%27%2C%20not%28int%28%20z%271234%27%2C%20kind%3Dint16%29%29%29%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmerge%5Fbits%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> merge_bits
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_merge_bits
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int16) :: if_one,if_zero,msk
      character(len=*),parameter :: fmt='(*(g0, 1X))'

         ! basic usage
         print *,'MERGE_BITS( 5,10,41) should be 3.=>',merge_bits(5,10,41)
         print *,'MERGE_BITS(13,18,22) should be 4.=>',merge_bits(13,18,22)

         ! use some values in base2 illustratively:
         if_one =int(b'1010101010101010',kind=int16)
         if_zero=int(b'0101010101010101',kind=int16)

         msk=int(b'0101010101010101',kind=int16)
         print '("should get all zero bits =>",b16.16)', &
         & merge_bits(if_one,if_zero,msk)

         msk=int(b'1010101010101010',kind=int16)
         print '("should get all ones bits =>",b16.16)', &
         & merge_bits(if_one,if_zero,msk)

         ! using BOZ values
         print fmt, &
         & merge_bits(32767_int16,    o'12345',         32767_int16), &
         & merge_bits(o'12345', 32767_int16, b'0000000000010101'), &
         & merge_bits(32767_int16,    o'12345',             z'1234')

         ! a do-it-yourself equivalent for comparison and validation
         print fmt, &
         & ior(iand(32767_int16, 32767_int16),                   &
         &   iand(o'12345', not(32767_int16))),                  &

         & ior(iand(o'12345', int(o'12345', kind=int16)),        &
         &   iand(32767_int16, not(int(o'12345', kind=int16)))), &

         & ior(iand(32767_int16, z'1234'),                       &
         &   iand(o'12345', not(int( z'1234', kind=int16))))

      end program demo_merge_bits
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmerge%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20tvals%282%2C3%29%2C%20fvals%282%2C3%29%2C%20answer%282%2C3%29%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20mask%282%2C3%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20k%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20chooseleft%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20Works%20with%20scalars%0D%0A%20%20%20%20%20%20%20%20%20k%3D5%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29merge%20%281%2E0%2C%200%2E0%2C%20k%20%3E%200%29%0D%0A%20%20%20%20%20%20%20%20%20k%3D%2D2%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29merge%20%281%2E0%2C%200%2E0%2C%20k%20%3E%200%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20set%20up%20some%20simple%20arrays%20that%20all%20conform%20to%20the%0D%0A%20%20%20%20%20%20%20%20%20%21%20same%20shape%0D%0A%20%20%20%20%20%20%20%20%20tvals%281%2C%3A%29%3D%5B%20%2010%2C%20%2D60%2C%20%2050%20%5D%0D%0A%20%20%20%20%20%20%20%20%20tvals%282%2C%3A%29%3D%5B%20%2D20%2C%20%2040%2C%20%2D60%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20fvals%281%2C%3A%29%3D%5B%200%2C%203%2C%202%20%5D%0D%0A%20%20%20%20%20%20%20%20%20fvals%282%2C%3A%29%3D%5B%207%2C%204%2C%208%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20mask%281%2C%3A%29%3D%5B%20%2Etrue%2E%2C%20%20%2Efalse%2E%2C%20%2Etrue%2E%20%5D%0D%0A%20%20%20%20%20%20%20%20%20mask%282%2C%3A%29%3D%5B%20%2Efalse%2E%2C%20%2Efalse%2E%2C%20%2Etrue%2E%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20lets%20use%20the%20mask%20of%20specific%20values%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27mask%20of%20logicals%27%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dmerge%28%20tvals%2C%20fvals%2C%20mask%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printme%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20more%20typically%20the%20mask%20is%20an%20expression%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27highest%20values%27%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dmerge%28%20tvals%2C%20fvals%2C%20tvals%20%3E%20fvals%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printme%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27lowest%20values%27%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dmerge%28%20tvals%2C%20fvals%2C%20tvals%20%3C%20fvals%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printme%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27zero%20out%20negative%20values%27%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dmerge%28%200%2C%20tvals%2C%20tvals%20%3C%200%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printme%28%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%2A%29%27binary%20choice%27%0D%0A%20%20%20%20%20%20%20%20%20chooseleft%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%27%283i4%29%27%29merge%28%5B1%2C2%2C3%5D%2C%5B10%2C20%2C30%5D%2Cchooseleft%29%0D%0A%20%20%20%20%20%20%20%20%20chooseleft%3D%2Etrue%2E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%27%283i4%29%27%29merge%28%5B1%2C2%2C3%5D%2C%5B10%2C20%2C30%5D%2Cchooseleft%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20printme%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%20%27%283i4%29%27%29%28answer%28i%2C%20%3A%29%2C%20i%3D1%2C%20size%28answer%2C%20dim%3D1%29%29%0D%0A%20%20%20%20%20%20end%20subroutine%20printme%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmerge%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> merge
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_merge
      implicit none
      integer :: tvals(2,3), fvals(2,3), answer(2,3)
      logical :: mask(2,3)
      integer :: i
      integer :: k
      logical :: chooseleft

         ! Works with scalars
         k=5
         write(*,*)merge (1.0, 0.0, k > 0)
         k=-2
         write(*,*)merge (1.0, 0.0, k > 0)

         ! set up some simple arrays that all conform to the
         ! same shape
         tvals(1,:)=[  10, -60,  50 ]
         tvals(2,:)=[ -20,  40, -60 ]

         fvals(1,:)=[ 0, 3, 2 ]
         fvals(2,:)=[ 7, 4, 8 ]

         mask(1,:)=[ .true.,  .false., .true. ]
         mask(2,:)=[ .false., .false., .true. ]

         ! lets use the mask of specific values
         write(*,*)'mask of logicals'
         answer=merge( tvals, fvals, mask )
         call printme()

         ! more typically the mask is an expression
         write(*, *)'highest values'
         answer=merge( tvals, fvals, tvals > fvals )
         call printme()

         write(*, *)'lowest values'
         answer=merge( tvals, fvals, tvals < fvals )
         call printme()

         write(*, *)'zero out negative values'
         answer=merge( 0, tvals, tvals < 0)
         call printme()

         write(*, *)'binary choice'
         chooseleft=.false.
         write(*, '(3i4)')merge([1,2,3],[10,20,30],chooseleft)
         chooseleft=.true.
         write(*, '(3i4)')merge([1,2,3],[10,20,30],chooseleft)

      contains

      subroutine printme()
            write(*, '(3i4)')(answer(i, :), i=1, size(answer, dim=1))
      end subroutine printme

      end program demo_merge
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fminexponent%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal32%29%20%3A%3A%20x%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20y%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20minexponent%28x%29%2C%20maxexponent%28x%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20minexponent%28y%29%2C%20maxexponent%28y%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fminexponent%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> minexponent
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_minexponent
      use, intrinsic :: iso_fortran_env, only : &
       &real_kinds, real32, real64, real128
      implicit none
      real(kind=real32) :: x
      real(kind=real64) :: y
          print *, minexponent(x), maxexponent(x)
          print *, minexponent(y), maxexponent(y)
      end program demo_minexponent
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmin%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29min%2810%2E0%2C11%2E0%2C30%2E0%2C%2D100%2E0%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmin%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> min
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_min
      implicit none
          write(*,*)min(10.0,11.0,30.0,-100.0)
      end program demo_min
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fminloc%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20ints%283%2C5%29%3D%20reshape%28%5B%26%0D%0A%20%20%20%20%20%20%20%20%204%2C%2010%2C%20%201%2C%20%207%2C%2013%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%209%2C%2015%2C%20%206%2C%2012%2C%20%203%2C%20%26%0D%0A%20%20%20%20%20%20%20%2014%2C%20%205%2C%2011%2C%20%202%2C%20%208%20%20%26%0D%0A%20%20%20%20%20%20%5D%2Cshape%28ints%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minloc%28ints%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minloc%28ints%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minloc%28ints%2Cdim%3D2%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20where%20in%20each%20column%20is%20the%20smallest%20number%20%2Egt%2E%2010%20%3F%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minloc%28ints%2Cdim%3D2%2Cmask%3Dints%2Egt%2E10%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20one%2Ddimensional%20array%20with%20dim%3D1%20explicitly%20listed%20returns%20a%20scalar%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minloc%28pack%28ints%2C%2Etrue%2E%29%2Cdim%3D1%29%20%21%20scalar%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fminloc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> minloc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_minloc
      implicit none
      integer,save :: ints(3,5)= reshape([&
         4, 10,  1,  7, 13, &
         9, 15,  6, 12,  3, &
        14,  5, 11,  2,  8  &
      ],shape(ints),order=[2,1])
         write(*,*) minloc(ints)
         write(*,*) minloc(ints,dim=1)
         write(*,*) minloc(ints,dim=2)
         ! where in each column is the smallest number .gt. 10 ?
         write(*,*) minloc(ints,dim=2,mask=ints.gt.10)
         ! a one-dimensional array with dim=1 explicitly listed returns a scalar
         write(*,*) minloc(pack(ints,.true.),dim=1) ! scalar
      end program demo_minloc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fminval%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%283x%2C%2A%28g0%2C1x%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20ints%283%2C5%29%3D%20reshape%28%5B%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%201%2C%20%20%2D2%2C%20%20%203%2C%20%20%204%2C%20%20%205%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%2010%2C%20%2020%2C%20%2D30%2C%20%2040%2C%20%2050%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%2011%2C%20%2022%2C%20%2033%2C%20%2D44%2C%20%2055%20%20%26%0D%0A%20%20%20%20%20%20%5D%2Cshape%28ints%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20box%283%2C5%2C2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C1%29%3Dints%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C2%29%3D%2Dints%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Given%20the%20array%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2C%2A%28g4%2E4%2C1x%29%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%28ints%28i%2C%3A%29%2Cnew%5Fline%28%27a%27%29%2Ci%3D1%2Csize%28ints%2Cdim%3D1%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27What%20is%20the%20smallest%20element%20in%20the%20array%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28ints%29%2C%27at%20%3C%27%2Cminloc%28ints%29%2C%27%3E%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27What%20is%20the%20smallest%20element%20in%20each%20column%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28ints%2Cdim%3D1%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27What%20is%20the%20smallest%20element%20in%20each%20row%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28ints%2Cdim%3D2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20notice%20the%20shape%20of%20the%20output%20has%20less%20columns%0D%0A%20%20%20%20%20%20%20%20%20%21%20than%20the%20input%20in%20this%20case%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27What%20is%20the%20smallest%20element%20in%20each%20column%2C%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27considering%20only%20those%20elements%20that%20are%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27greater%20than%20zero%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28ints%2C%20dim%3D1%2C%20mask%20%3D%20ints%20%3E%200%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27if%20everything%20is%20false%20a%20zero%2Dsized%20array%20is%20NOT%20returned%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20minval%28ints%2C%20dim%3D1%2C%20mask%20%3D%20%2Efalse%2E%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27even%20for%20a%20zero%2Dsized%20input%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28%5Binteger%20%3A%3A%5D%2C%20dim%3D1%2C%20mask%20%3D%20%2Efalse%2E%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27a%20scalar%20answer%20for%20everything%20false%20is%20huge%28%29%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28ints%2C%20mask%20%3D%20%2Efalse%2E%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28%5Binteger%20%3A%3A%5D%2C%20mask%20%3D%20%2Efalse%2E%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27some%20calls%20with%20three%20dimensions%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28box%2C%20mask%20%3D%20%2Etrue%2E%20%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28box%2C%20dim%3D1%2C%20mask%20%3D%20%2Etrue%2E%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20minval%28box%2C%20dim%3D2%2C%20mask%20%3D%20%2Etrue%2E%20%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%20%27shape%20of%20answer%20is%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20shape%28minval%28box%2C%20dim%3D2%2C%20mask%20%3D%20%2Etrue%2E%20%29%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fminval%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> minval
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_minval
      implicit none
      integer :: i
      character(len=*),parameter :: g='(3x,*(g0,1x))'

      integer,save :: ints(3,5)= reshape([&
             1,  -2,   3,   4,   5,  &
            10,  20, -30,  40,  50,  &
            11,  22,  33, -44,  55  &
      ],shape(ints),order=[2,1])

      integer,save :: box(3,5,2)

         box(:,:,1)=ints
         box(:,:,2)=-ints

         write(*,*)'Given the array'
         write(*,'(1x,*(g4.4,1x))') &
         & (ints(i,:),new_line('a'),i=1,size(ints,dim=1))

         write(*,*)'What is the smallest element in the array?'
         write(*,g) minval(ints),'at <',minloc(ints),'>'

         write(*,*)'What is the smallest element in each column?'
         write(*,g) minval(ints,dim=1)

         write(*,*)'What is the smallest element in each row?'
         write(*,g) minval(ints,dim=2)

         ! notice the shape of the output has less columns
         ! than the input in this case
         write(*,*)'What is the smallest element in each column,'
         write(*,*)'considering only those elements that are'
         write(*,*)'greater than zero?'
         write(*,g) minval(ints, dim=1, mask = ints > 0)

         write(*,*)&
         & 'if everything is false a zero-sized array is NOT returned'
         write(*,*) minval(ints, dim=1, mask = .false.)
         write(*,*)'even for a zero-sized input'
         write(*,g) minval([integer ::], dim=1, mask = .false.)

         write(*,*)'a scalar answer for everything false is huge()'
         write(*,g) minval(ints, mask = .false.)
         write(*,g) minval([integer ::], mask = .false.)

         write(*,*)'some calls with three dimensions'
         write(*,g) minval(box, mask = .true. )
         write(*,g) minval(box, dim=1, mask = .true. )

         write(*,g) minval(box, dim=2, mask = .true. )
         write(*,g) 'shape of answer is ', &
         & shape(minval(box, dim=2, mask = .true. ))

      end program demo_minval
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmod%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%20%2D17%2C%20%203%20%29%2C%20modulo%28%20%2D17%2C%20%203%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%20%2017%2C%20%2D3%20%29%2C%20modulo%28%20%2017%2C%20%2D3%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%20%2017%2C%20%203%20%29%2C%20modulo%28%20%2017%2C%20%203%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%20%2D17%2C%20%2D3%20%29%2C%20modulo%28%20%2D17%2C%20%2D3%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2D17%2E5%2C%205%2E2%29%2C%20modulo%28%2D17%2E5%2C%205%2E2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2017%2E5%2C%2D5%2E2%29%2C%20modulo%28%2017%2E5%2C%2D5%2E2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2017%2E5%2C%205%2E2%29%2C%20modulo%28%2017%2E5%2C%205%2E2%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2D17%2E5%2C%2D5%2E2%29%2C%20modulo%28%2D17%2E5%2C%2D5%2E2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20with%20a%20divisor%20of%201%20the%20fractional%20part%20is%20returned%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2D17%2E5%2C%201%2E0%29%2C%20modulo%28%2D17%2E5%2C%201%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2017%2E5%2C%2D1%2E0%29%2C%20modulo%28%2017%2E5%2C%2D1%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2017%2E5%2C%201%2E0%29%2C%20modulo%28%2017%2E5%2C%201%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20mod%28%2D17%2E5%2C%2D1%2E0%29%2C%20modulo%28%2D17%2E5%2C%2D1%2E0%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmod%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> mod
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_mod
      implicit none

         ! basics
          print *, mod( -17,  3 ), modulo( -17,  3 )
          print *, mod(  17, -3 ), modulo(  17, -3 )
          print *, mod(  17,  3 ), modulo(  17,  3 )
          print *, mod( -17, -3 ), modulo( -17, -3 )

          print *, mod(-17.5, 5.2), modulo(-17.5, 5.2)
          print *, mod( 17.5,-5.2), modulo( 17.5,-5.2)
          print *, mod( 17.5, 5.2), modulo( 17.5, 5.2)
          print *, mod(-17.5,-5.2), modulo(-17.5,-5.2)

        ! with a divisor of 1 the fractional part is returned
          print *, mod(-17.5, 1.0), modulo(-17.5, 1.0)
          print *, mod( 17.5,-1.0), modulo( 17.5,-1.0)
          print *, mod( 17.5, 1.0), modulo( 17.5, 1.0)
          print *, mod(-17.5,-1.0), modulo(-17.5,-1.0)

      end program demo_mod
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmodulo%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%2817%2C3%29%20%20%20%20%20%20%20%20%21%20yields%202%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%2817%2E5%2C5%2E5%29%20%20%20%20%21%20yields%201%2E0%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%28%2D17%2C3%29%20%20%20%20%20%20%20%21%20yields%201%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%28%2D17%2E5%2C5%2E5%29%20%20%20%21%20yields%204%2E5%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%2817%2C%2D3%29%20%20%20%20%20%20%20%21%20yields%20%2D1%0D%0A%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20modulo%2817%2E5%2C%2D5%2E5%29%20%20%20%21%20yields%20%2D4%2E5%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmodulo%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> modulo
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_modulo
      implicit none
           print *, modulo(17,3)        ! yields 2
           print *, modulo(17.5,5.5)    ! yields 1.0

           print *, modulo(-17,3)       ! yields 1
           print *, modulo(-17.5,5.5)   ! yields 4.5

           print *, modulo(17,-3)       ! yields -1
           print *, modulo(17.5,-5.5)   ! yields -4.5
      end program demo_modulo
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmove%5Falloc%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%20Example%20to%20allocate%20a%20bigger%20GRID%0D%0A%20%20%20%20%20%20real%2C%20allocatable%20%3A%3A%20grid%28%3A%29%2C%20tempgrid%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20n%2C%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20initialize%20small%20GRID%0D%0A%20%20%20%20%20%20%20%20%20n%20%3D%203%0D%0A%20%20%20%20%20%20%20%20%20allocate%20%28grid%281%3An%29%29%0D%0A%20%20%20%20%20%20%20%20%20grid%20%3D%20%5B%20%28real%20%28i%29%2C%20i%3D1%2Cn%29%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20initialize%20TEMPGRID%20which%20will%20be%20used%20to%20replace%20GRID%0D%0A%20%20%20%20%20%20%20%20%20allocate%20%28tempgrid%281%3A2%2An%29%29%20%20%20%20%21%20Allocate%20bigger%20grid%0D%0A%20%20%20%20%20%20%20%20%20tempgrid%28%3A%3A2%29%20%20%3D%20grid%20%20%20%20%20%20%20%20%20%21%20Distribute%20values%20to%20new%20locations%0D%0A%20%20%20%20%20%20%20%20%20tempgrid%282%3A%3A2%29%20%3D%20grid%20%2B%200%2E5%20%20%20%21%20initialize%20other%20values%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20move%20TEMPGRID%20to%20GRID%0D%0A%20%20%20%20%20%20%20%20%20call%20MOVE%5FALLOC%20%28from%3Dtempgrid%2C%20to%3Dgrid%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20TEMPGRID%20should%20no%20longer%20be%20allocated%0D%0A%20%20%20%20%20%20%20%20%20%21%20and%20GRID%20should%20be%20the%20size%20TEMPGRID%20was%0D%0A%20%20%20%20%20%20%20%20%20if%20%28size%20%28grid%29%20%2F%3D%202%2An%20%2Eor%2E%20allocated%20%28tempgrid%29%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22Failure%20in%20move%5Falloc%21%22%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20allocated%28grid%29%2C%20allocated%28tempgrid%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%27%2899f8%2E3%29%27%2C%20grid%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fmove%5Falloc%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> move_alloc
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_move_alloc
      implicit none
      ! Example to allocate a bigger GRID
      real, allocatable :: grid(:), tempgrid(:)
      integer :: n, i

         ! initialize small GRID
         n = 3
         allocate (grid(1:n))
         grid = [ (real (i), i=1,n) ]

         ! initialize TEMPGRID which will be used to replace GRID
         allocate (tempgrid(1:2*n))    ! Allocate bigger grid
         tempgrid(::2)  = grid         ! Distribute values to new locations
         tempgrid(2::2) = grid + 0.5   ! initialize other values

         ! move TEMPGRID to GRID
         call MOVE_ALLOC (from=tempgrid, to=grid)

         ! TEMPGRID should no longer be allocated
         ! and GRID should be the size TEMPGRID was
         if (size (grid) /= 2*n .or. allocated (tempgrid)) then
            print *, "Failure in move_alloc!"
         endif
         print *, allocated(grid), allocated(tempgrid)
         print '(99f8.3)', grid
      end program demo_move_alloc
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fmvbits%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20intfrom%2C%20intto%2C%20abcd%5Fint%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20bits%3D%20%27%28g0%2Ct30%2Cb32%2E32%29%27%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20fmt%3D%20%27%28g0%2Ct30%2Ca%2Ct40%2Cb32%2E32%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20intfrom%3Dhuge%280%29%20%20%21%20all%20bits%20are%201%20accept%20the%20sign%20bit%0D%0A%20%20%20%20%20%20%20%20%20%20intto%3D0%20%20%20%20%20%20%20%20%20%20%21%20all%20bits%20are%200%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%21%20CHANGE%20BIT%200%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20show%20the%20value%20and%20bit%20pattern%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cbits%29intfrom%2Cintfrom%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cbits%29intto%2Cintto%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20copy%20bit%200%20from%20intfrom%20to%20intto%20to%20show%20the%20rightmost%20bit%20changes%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%20%20%28from%2C%20%20%20%20frompos%2C%20len%2C%20%20%20%20to%2C%20topos%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intfrom%2C%20%20%20%20%20%20%200%2C%20%20%201%2C%20intto%2C%20%20%20%20%200%29%20%21%20change%20bit%200%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cbits%29intto%2Cintto%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%21%20COPY%20PART%20OF%20A%20VALUE%20TO%20ITSELF%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20can%20copy%20bit%20from%20a%20value%20to%20itself%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intfrom%2C0%2C1%2Cintfrom%2C31%29%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cbits%29intfrom%2Cintfrom%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%21%20MOVING%20BYTES%20AT%20A%20TIME%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20make%20native%20integer%20value%20with%20bit%20patterns%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20that%20happen%20to%20be%20the%20same%20as%20the%20beginning%20of%20the%20alphabet%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20to%20make%20it%20easy%20to%20see%20the%20bytes%20are%20reversed%0D%0A%20%20%20%20%20%20%20%20%20%20abcd%5Fint%3Dtransfer%28%27abcd%27%2C0%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20show%20the%20value%20and%20bit%20pattern%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27native%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29abcd%5Fint%2Cabcd%5Fint%2Cabcd%5Fint%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20change%20endian%20of%20the%20value%0D%0A%20%20%20%20%20%20%20%20%20%20abcd%5Fint%3Dint%5Fswap32%28abcd%5Fint%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20show%20the%20values%20and%20their%20bit%20pattern%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27non%2Dnative%27%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%29abcd%5Fint%2Cabcd%5Fint%2Cabcd%5Fint%0D%0A%0D%0A%20%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20pure%20elemental%20function%20int%5Fswap32%28intin%29%20result%28intout%29%0D%0A%20%20%20%20%20%20%20%21%20Convert%20a%2032%20bit%20integer%20from%20big%20Endian%20to%20little%20Endian%2C%0D%0A%20%20%20%20%20%20%20%21%20or%20conversely%20from%20little%20Endian%20to%20big%20Endian%2E%0D%0A%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20integer%28kind%3Dint32%29%2C%20intent%28in%29%20%20%3A%3A%20intin%0D%0A%20%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20intout%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20copy%20bytes%20from%20input%20value%20to%20new%20position%20in%20output%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%20%20%28from%2C%20%20frompos%2C%20len%2C%20%20%20%20%20to%2C%20topos%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intin%2C%20%20%20%20%20%20%200%2C%20%20%208%2C%20intout%2C%20%20%20%2024%29%20%21%20byte1%20to%20byte4%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intin%2C%20%20%20%20%20%20%208%2C%20%20%208%2C%20intout%2C%20%20%20%2016%29%20%21%20byte2%20to%20byte3%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intin%2C%20%20%20%20%20%2016%2C%20%20%208%2C%20intout%2C%20%20%20%20%208%29%20%21%20byte3%20to%20byte2%0D%0A%20%20%20%20%20%20%20%20%20%20call%20mvbits%28intin%2C%20%20%20%20%20%2024%2C%20%20%208%2C%20intout%2C%20%20%20%20%200%29%20%21%20byte4%20to%20byte1%0D%0A%20%20%20%20%20%20%20end%20function%20int%5Fswap32%0D%0A%0D%0A%20%20%20%20%20%20%20end%20program%20demo%5Fmvbits%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> mvbits
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_mvbits
      use,intrinsic :: iso_fortran_env,  only : int8, int16, int32, int64
      implicit none
      integer(kind=int32) :: intfrom, intto, abcd_int
      character(len=*),parameter :: bits= '(g0,t30,b32.32)'
      character(len=*),parameter :: fmt= '(g0,t30,a,t40,b32.32)'

          intfrom=huge(0)  ! all bits are 1 accept the sign bit
          intto=0          ! all bits are 0

          !! CHANGE BIT 0
          ! show the value and bit pattern
          write(*,bits)intfrom,intfrom
          write(*,bits)intto,intto

          ! copy bit 0 from intfrom to intto to show the rightmost bit changes
          !          (from,    frompos, len,    to, topos)
          call mvbits(intfrom,       0,   1, intto,     0) ! change bit 0
          write(*,bits)intto,intto

          !! COPY PART OF A VALUE TO ITSELF
          ! can copy bit from a value to itself
          call mvbits(intfrom,0,1,intfrom,31)
          write(*,bits)intfrom,intfrom

          !! MOVING BYTES AT A TIME
          ! make native integer value with bit patterns
          ! that happen to be the same as the beginning of the alphabet
          ! to make it easy to see the bytes are reversed
          abcd_int=transfer('abcd',0)
          ! show the value and bit pattern
          write(*,*)'native'
          write(*,fmt)abcd_int,abcd_int,abcd_int

          ! change endian of the value
          abcd_int=int_swap32(abcd_int)
          ! show the values and their bit pattern
          write(*,*)'non-native'
          write(*,fmt)abcd_int,abcd_int,abcd_int

       contains

       pure elemental function int_swap32(intin) result(intout)
       ! Convert a 32 bit integer from big Endian to little Endian,
       ! or conversely from little Endian to big Endian.
       !
       integer(kind=int32), intent(in)  :: intin
       integer(kind=int32) :: intout
          ! copy bytes from input value to new position in output value
          !          (from,  frompos, len,     to, topos)
          call mvbits(intin,       0,   8, intout,    24) ! byte1 to byte4
          call mvbits(intin,       8,   8, intout,    16) ! byte2 to byte3
          call mvbits(intin,      16,   8, intout,     8) ! byte3 to byte2
          call mvbits(intin,      24,   8, intout,     0) ! byte4 to byte1
       end function int_swap32

       end program demo_mvbits
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnearest%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20real%20%3A%3A%20x%2C%20y%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20nearest%2842%2E0%2C%201%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20y%20%3D%20nearest%2842%2E0%2C%20%2D1%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%22%283%28g20%2E15%29%29%22%29%20x%2C%20y%2C%20x%20%2D%20y%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20write%20%28%2A%2C%22%283%28g20%2E15%29%29%22%29%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28tiny%280%2E0%29%2C1%2E0%29%2C%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28tiny%280%2E0%29%2C%2D1%2E0%29%2C%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28tiny%280%2E0%29%2C1%2E0%29%20%2Dnearest%28tiny%280%2E0%29%2C%2D1%2E0%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20write%20%28%2A%2C%22%283%28g20%2E15%29%29%22%29%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28huge%280%2E0%29%2C1%2E0%29%2C%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28huge%280%2E0%29%2C%2D1%2E0%29%2C%20%26%0D%0A%20%20%20%20%20%20%21%20%20%20nearest%28huge%280%2E0%29%2C1%2E0%29%2D%20nearest%28huge%280%2E0%29%2C%2D1%2E0%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnearest%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> nearest
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_nearest
      implicit none

         real :: x, y
         x = nearest(42.0, 1.0)
         y = nearest(42.0, -1.0)
         write (*,"(3(g20.15))") x, y, x - y

      !  write (*,"(3(g20.15))") &
      !   nearest(tiny(0.0),1.0), &
      !   nearest(tiny(0.0),-1.0), &
      !   nearest(tiny(0.0),1.0) -nearest(tiny(0.0),-1.0)

      !  write (*,"(3(g20.15))") &
      !   nearest(huge(0.0),1.0), &
      !   nearest(huge(0.0),-1.0), &
      !   nearest(huge(0.0),1.0)- nearest(huge(0.0),-1.0)

      end program demo_nearest
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnew%5Fline%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%2Cparameter%20%3A%3A%20nl%3Dnew%5Fline%28%27a%27%29%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20string%0D%0A%20%20%20%20%20%20real%20%3A%3A%20r%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2C%20count%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20a%20string%20with%20a%20newline%20embedded%20in%20it%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27This%20is%20record%201%2E%27%2F%2Fnl%2F%2F%27This%20is%20record%202%2E%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20string%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20a%20newline%20character%20string%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28a%29%29%27%2Cadvance%3D%27no%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20nl%2C%27This%20is%20record%201%2E%27%2Cnl%2C%27This%20is%20record%202%2E%27%2Cnl%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20output%20a%20number%20of%20words%20of%20random%20length%20as%20a%20paragraph%0D%0A%20%20%20%20%20%20%20%20%20%21%20by%20inserting%20a%20new%5Fline%20before%20line%20exceeds%2070%20characters%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20simplistic%20paragraph%20print%20using%20non%2Dadvancing%20I%2FO%0D%0A%20%20%20%20%20%20%20%20%20count%3D0%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2C100%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20make%20some%20fake%20word%20of%20random%20length%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fnumber%28r%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20string%3Drepeat%28%27x%27%2Cint%28r%2A10%29%2B1%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20count%3Dcount%2Blen%28string%29%2B1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28count%2Egt%2E70%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%2Cadvance%3D%27no%27%29nl%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count%3Dlen%28string%29%2B1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2Ca%29%27%2Cadvance%3D%27no%27%29string%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%2Cadvance%3D%27no%27%29nl%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnew%5Fline%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> new_line
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_new_line
      implicit none
      character,parameter :: nl=new_line('a')
      character(len=:),allocatable :: string
      real :: r
      integer :: i, count

        ! basics
         ! print a string with a newline embedded in it
         string='This is record 1.'//nl//'This is record 2.'
         write(*,'(a)') string

         ! print a newline character string
         write(*,'(*(a))',advance='no') &
            nl,'This is record 1.',nl,'This is record 2.',nl

         ! output a number of words of random length as a paragraph
         ! by inserting a new_line before line exceeds 70 characters

        ! simplistic paragraph print using non-advancing I/O
         count=0
         do i=1,100

            ! make some fake word of random length
            call random_number(r)
            string=repeat('x',int(r*10)+1)

            count=count+len(string)+1
            if(count.gt.70)then
               write(*,'(a)',advance='no')nl
               count=len(string)+1
            endif
            write(*,'(1x,a)',advance='no')string
         enddo
         write(*,'(a)',advance='no')nl

      end program demo_new_line
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnint%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%20%20%3A%3A%20dp%3Dkind%280%2E0d0%29%0D%0A%20%20%20%20%20%20real%2Callocatable%20%20%20%20%3A%3A%20in%28%3A%29%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20out%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20real%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20x4%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%20%20%20%20%20%20%3A%3A%20x8%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20use%0D%0A%20%20%20%20%20%20%20%20%20x4%20%3D%201%2E234E0%0D%0A%20%20%20%20%20%20%20%20%20x8%20%3D%204%2E721%5Fdp%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x4%29%2C%20nint%28%2Dx4%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x8%29%2C%20nint%28%2Dx8%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20in%20%3D%20%5B%20%2D2%2E7%2C%20%20%2D2%2E5%2C%20%2D2%2E2%2C%20%2D2%2E0%2C%20%2D1%2E5%2C%20%2D1%2E0%2C%20%2D0%2E5%2C%20%2D0%2E4%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%200%2E0%2C%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%2B0%2E04%2C%20%2B0%2E5%2C%20%2B1%2E0%2C%20%2B1%2E5%2C%20%2B2%2E0%2C%20%2B2%2E2%2C%20%2B2%2E5%2C%20%2B2%2E7%20%20%5D%0D%0A%20%20%20%20%20%20%20%20%20out%20%3D%20nint%28in%29%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28in%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29in%28i%29%2Cout%28i%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20dusty%20corners%0D%0A%20%20%20%20%20%20%20%20%20ISSUES%3A%20block%0D%0A%20%20%20%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20icheck%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20make%20sure%20input%20is%20in%20range%20for%20the%20type%20returned%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Range%20limits%20for%20typical%20KINDS%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2Cg0%2C1x%2Cg0%29%27%29%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20int8%2Chuge%280%5Fint8%29%2C%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20int16%2Chuge%280%5Fint16%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20int32%2Chuge%280%5Fint32%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20int64%2Chuge%280%5Fint64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20the%20standard%20does%20not%20require%20this%20to%20be%20an%20error%20%2E%2E%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20x8%3D12345%2E67e15%20%21%20too%20big%20of%20a%20number%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20icheck%3Dselected%5Fint%5Fkind%28ceiling%28log10%28x8%29%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Any%20KIND%20big%20enough%3F%20ICHECK%3D%27%2Cicheck%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27These%20are%20all%20wrong%20answers%20for%20%27%2Cx8%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x8%2Ckind%3Dint8%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x8%2Ckind%3Dint16%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x8%2Ckind%3Dint32%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20nint%28x8%2Ckind%3Dint64%29%0D%0A%20%20%20%20%20%20%20%20%20endblock%20ISSUES%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnint%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> nint
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_nint
      implicit none
      integer,parameter   :: dp=kind(0.0d0)
      real,allocatable    :: in(:)
      integer,allocatable :: out(:)
      integer             :: i
      real                :: x4
      real(kind=dp)       :: x8

        ! basic use
         x4 = 1.234E0
         x8 = 4.721_dp
         print *, nint(x4), nint(-x4)
         print *, nint(x8), nint(-x8)

        ! elemental
         in = [ -2.7,  -2.5, -2.2, -2.0, -1.5, -1.0, -0.5, -0.4, &
              &  0.0,   &
              & +0.04, +0.5, +1.0, +1.5, +2.0, +2.2, +2.5, +2.7  ]
         out = nint(in)
         do i=1,size(in)
            write(*,*)in(i),out(i)
         enddo

        ! dusty corners
         ISSUES: block
         use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
         integer :: icheck
            ! make sure input is in range for the type returned
            write(*,*)'Range limits for typical KINDS:'
            write(*,'(1x,g0,1x,g0)')  &
            & int8,huge(0_int8),   &
            & int16,huge(0_int16), &
            & int32,huge(0_int32), &
            & int64,huge(0_int64)

            ! the standard does not require this to be an error ...
            x8=12345.67e15 ! too big of a number
            icheck=selected_int_kind(ceiling(log10(x8)))
            write(*,*)'Any KIND big enough? ICHECK=',icheck
            print *, 'These are all wrong answers for ',x8
            print *, nint(x8,kind=int8)
            print *, nint(x8,kind=int16)
            print *, nint(x8,kind=int32)
            print *, nint(x8,kind=int64)
         endblock ISSUES

      end program demo_nint
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnorm2%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%282%2C3%29%20%3D%20reshape%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%201%2C%202%2C%203%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%204%2C%205%2C%206%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%5D%2Cshape%28x%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27input%20in%20row%2Dcolumn%20order%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27x%3D%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%27%284x%2C3f4%2E0%29%27%29transpose%28x%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27norm2%28x%29%3D%27%2Cnorm2%28x%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27which%20is%20equivalent%20to%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27sqrt%28sum%28x%2A%2A2%29%29%3D%27%2Csqrt%28sum%28x%2A%2A2%29%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27for%20reference%20the%20array%20squared%20is%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27x%2A%2A2%3D%27%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%27%284x%2C3f4%2E0%29%27%29transpose%28x%2A%2A2%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27norm2%28x%2Cdim%3D1%29%3D%27%2Cnorm2%28x%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27norm2%28x%2Cdim%3D2%29%3D%27%2Cnorm2%28x%2Cdim%3D2%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27%28sqrt%28sum%28x%28%3A%2Ci%29%2A%2A2%29%29%2Ci%3D1%2C3%29%3D%27%2C%28sqrt%28sum%28x%28%3A%2Ci%29%2A%2A2%29%29%2Ci%3D1%2C3%29%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27%28sqrt%28sum%28x%28i%2C%3A%29%2A%2A2%29%29%2Ci%3D1%2C2%29%3D%27%2C%28sqrt%28sum%28x%28i%2C%3A%29%2A%2A2%29%29%2Ci%3D1%2C2%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnorm2%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> norm2
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_norm2
      implicit none
      integer :: i
      real :: x(2,3) = reshape([ &
         1, 2, 3, &
         4, 5, 6  &
         ],shape(x),order=[2,1])

        write(*,*) 'input in row-column order'
        write(*,*) 'x='
        write(*,'(4x,3f4.0)')transpose(x)
        write(*,*)
        write(*,*) 'norm2(x)=',norm2(x)
        write(*,*) 'which is equivalent to'
        write(*,*) 'sqrt(sum(x**2))=',sqrt(sum(x**2))
        write(*,*)
        write(*,*) 'for reference the array squared is'
        write(*,*) 'x**2='
        write(*,'(4x,3f4.0)')transpose(x**2)
        write(*,*)
        write(*,*) 'norm2(x,dim=1)=',norm2(x,dim=1)
        write(*,*) 'norm2(x,dim=2)=',norm2(x,dim=2)
        write(*,*) '(sqrt(sum(x(:,i)**2)),i=1,3)=',(sqrt(sum(x(:,i)**2)),i=1,3)
        write(*,*) '(sqrt(sum(x(i,:)**2)),i=1,2)=',(sqrt(sum(x(i,:)**2)),i=1,2)

      end program demo_norm2
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnot%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20i%3D%2D13741%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27the%20input%20value%27%2Ci%2C%27represented%20in%20bits%20is%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2Cb32%2E32%2C1x%2Ci0%29%27%29%20i%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20i%3Dnot%28i%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27on%20output%20it%20is%27%2Ci%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2Cb32%2E32%2C1x%2Ci0%29%27%29%20i%2C%20i%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22%20on%20a%20two%27s%20complement%20machine%20flip%20the%20bits%20and%20add%201%22%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22%20to%20get%20the%20value%20with%20the%20sign%20changed%2C%20for%20example%2E%22%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%201234%2C%20not%281234%29%2B1%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%2D1234%2C%20not%28%2D1234%29%2B1%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22%20of%20course%20%27x%3D%2Dx%27%20works%20just%20fine%20and%20more%20generally%2E%22%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnot%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> not
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_not
      implicit none
      integer :: i
        ! basics
         i=-13741
         print *,'the input value',i,'represented in bits is'
         write(*,'(1x,b32.32,1x,i0)') i, i
         i=not(i)
         print *,'on output it is',i
         write(*,'(1x,b32.32,1x,i0)') i, i
         print *, " on a two's complement machine flip the bits and add 1"
         print *, " to get the value with the sign changed, for example."
         print *, 1234, not(1234)+1
         print *, -1234, not(-1234)+1
         print *, " of course 'x=-x' works just fine and more generally."
      end program demo_not
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%21program%20demo%5Fnull%0D%0A%20%20%20%20%20%20module%20showit%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20private%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20g%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20public%20gen%0D%0A%20%20%20%20%20%20%21%20a%20generic%20interface%20that%20only%20differs%20in%20the%0D%0A%20%20%20%20%20%20%21%20type%20of%20the%20pointer%20the%20second%20argument%20is%0D%0A%20%20%20%20%20%20interface%20gen%0D%0A%20%20%20%20%20%20%20module%20procedure%20s1%0D%0A%20%20%20%20%20%20%20module%20procedure%20s2%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20s1%20%28j%2C%20pi%29%0D%0A%20%20%20%20%20%20%20integer%20j%0D%0A%20%20%20%20%20%20%20integer%2C%20pointer%20%3A%3A%20pi%0D%0A%20%20%20%20%20%20%20%20%20if%28associated%28pi%29%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27Two%20integers%20in%20S1%3A%2C%27%2Cj%2C%27and%27%2Cpi%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27One%20integer%20in%20S1%3A%2C%27%2Cj%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20subroutine%20s1%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20s2%20%28k%2C%20pr%29%0D%0A%20%20%20%20%20%20%20integer%20k%0D%0A%20%20%20%20%20%20%20real%2C%20pointer%20%3A%3A%20pr%0D%0A%20%20%20%20%20%20%20%20%20if%28associated%28pr%29%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27integer%20and%20real%20in%20S2%3A%2C%27%2Ck%2C%27and%27%2Cpr%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cg%29%27One%20integer%20in%20S2%3A%2C%27%2Ck%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20subroutine%20s2%0D%0A%0D%0A%20%20%20%20%20%20end%20module%20showit%0D%0A%0D%0A%20%20%20%20%20%20program%20demo%5Fnull%0D%0A%20%20%20%20%20%20use%20showit%2C%20only%20%3A%20gen%0D%0A%0D%0A%20%20%20%20%20%20real%2Ctarget%20%3A%3A%20x%20%3D%20200%2E0%0D%0A%20%20%20%20%20%20integer%2Ctarget%20%3A%3A%20i%20%3D%20100%0D%0A%0D%0A%20%20%20%20%20%20real%2C%20pointer%20%3A%3A%20real%5Fptr%0D%0A%20%20%20%20%20%20integer%2C%20pointer%20%3A%3A%20integer%5Fptr%0D%0A%0D%0A%20%20%20%20%20%20%21%20so%20how%20do%20we%20call%20S1%28%29%20or%20S2%28%29%20with%20a%20disassociated%20pointer%3F%0D%0A%0D%0A%20%20%20%20%20%20%21%20the%20answer%20is%20the%20null%28%29%20function%20with%20a%20mold%20value%0D%0A%0D%0A%20%20%20%20%20%20%21%20since%20s1%28%29%20and%20s2%28%29%20both%20have%20a%20first%20integer%0D%0A%20%20%20%20%20%20%21%20argument%20the%20NULL%28%29%20pointer%20must%20be%20associated%0D%0A%20%20%20%20%20%20%21%20to%20a%20real%20or%20integer%20type%20via%20the%20mold%20option%0D%0A%20%20%20%20%20%20%21%20so%20the%20following%20can%20distinguish%20whether%20s1%281%29%0D%0A%20%20%20%20%20%20%21%20or%20s2%28%29%20is%20called%2C%20even%20though%20the%20pointers%20are%0D%0A%20%20%20%20%20%20%21%20not%20associated%20or%20defined%0D%0A%0D%0A%20%20%20%20%20%20call%20gen%20%281%2C%20null%20%28real%5Fptr%29%20%29%20%20%20%20%21%20invokes%20s2%0D%0A%20%20%20%20%20%20call%20gen%20%282%2C%20null%20%28integer%5Fptr%29%20%29%20%21%20invokes%20s1%0D%0A%20%20%20%20%20%20real%5Fptr%20%3D%3E%20x%0D%0A%20%20%20%20%20%20integer%5Fptr%20%3D%3E%20i%0D%0A%20%20%20%20%20%20call%20gen%20%283%2C%20real%5Fptr%20%29%20%21%20invokes%20s2%0D%0A%20%20%20%20%20%20call%20gen%20%284%2C%20integer%5Fptr%20%29%20%21%20invokes%20s1%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnull%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> null
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      !program demo_null
      module showit
      implicit none
      private
      character(len=*),parameter :: g='(*(g0,1x))'
      public gen
      ! a generic interface that only differs in the
      ! type of the pointer the second argument is
      interface gen
       module procedure s1
       module procedure s2
      end interface

      contains

      subroutine s1 (j, pi)
       integer j
       integer, pointer :: pi
         if(associated(pi))then
            write(*,g)'Two integers in S1:,',j,'and',pi
         else
            write(*,g)'One integer in S1:,',j
         endif
      end subroutine s1

      subroutine s2 (k, pr)
       integer k
       real, pointer :: pr
         if(associated(pr))then
            write(*,g)'integer and real in S2:,',k,'and',pr
         else
            write(*,g)'One integer in S2:,',k
         endif
      end subroutine s2

      end module showit

      program demo_null
      use showit, only : gen

      real,target :: x = 200.0
      integer,target :: i = 100

      real, pointer :: real_ptr
      integer, pointer :: integer_ptr

      ! so how do we call S1() or S2() with a disassociated pointer?

      ! the answer is the null() function with a mold value

      ! since s1() and s2() both have a first integer
      ! argument the NULL() pointer must be associated
      ! to a real or integer type via the mold option
      ! so the following can distinguish whether s1(1)
      ! or s2() is called, even though the pointers are
      ! not associated or defined

      call gen (1, null (real_ptr) )    ! invokes s2
      call gen (2, null (integer_ptr) ) ! invokes s1
      real_ptr => x
      integer_ptr => i
      call gen (3, real_ptr ) ! invokes s2
      call gen (4, integer_ptr ) ! invokes s1

      end program demo_null
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fnum%5Fimages%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20value%5B%2A%5D%0D%0A%20%20%20%20%20%20real%20%20%20%20%3A%3A%20p%5B%2A%5D%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20value%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20sync%20all%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20do%20i%20%3D%201%2C%20num%5Fimages%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%282%28a%2Ci0%29%29%27%29%20%27value%5B%27%2C%20i%2C%20%27%5D%20is%20%27%2C%20value%5Bi%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20end%20do%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20The%20following%20code%20uses%20image%201%20to%20read%20data%20and%0D%0A%20%20%20%20%20%20%20%21%20broadcast%20it%20to%20other%20images%2E%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%3D%3D1%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20p%3D1234%2E5678%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%20%3D%202%2C%20num%5Fimages%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20p%5Bi%5D%20%3D%20p%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20do%0D%0A%20%20%20%20%20%20%20%20%20end%20if%0D%0A%20%20%20%20%20%20%20%20%20sync%20all%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fnum%5Fimages%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> num_images
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_num_images
      implicit none
      integer :: value[*]
      real    :: p[*]
      integer :: i

         value = this_image()
         sync all
         if (this_image() == 1) then
           do i = 1, num_images()
             write(*,'(2(a,i0))') 'value[', i, '] is ', value[i]
           end do
         endif

       ! The following code uses image 1 to read data and
       ! broadcast it to other images.
         if (this_image()==1) then
            p=1234.5678
            do i = 2, num_images()
               p[i] = p
            end do
         end if
         sync all

      end program demo_num_images
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fopen%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20ios%0D%0A%20%20%20%20%20%20character%28len%3D256%29%20%3A%3A%20message%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20lun%0D%0A%20%20%20%20%20%20%20%20%20open%20%20%28%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20newunit%3Dlun%2C%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20file%3D%27employee%2Enames%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20action%3D%27read%27%2C%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20iostat%3Dios%2C%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20iomsg%3Dmessage%29%0D%0A%20%20%20%20%20%20%20%20%20if%20%28ios%20%3C%200%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20Perform%20end%2Dof%2Dfile%20processing%20on%20the%20file%20connected%20to%20unit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20call%20end%5Fprocessing%28%29%0D%0A%20%20%20%20%20%20%20%20%20elseif%20%28ios%20%3E%200%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20Perform%20error%20processing%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29trim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20call%20error%5Fprocessing%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27OPENED%20FILE%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20subroutine%20end%5Fprocessing%28%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27END%20OF%20FILE%3A%27%2Cios%2C%27MESSAGE%3D%27%2Ctrim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20close%28unit%3Dlun%2Ciostat%3Dios%29%0D%0A%20%20%20%20%20%20%20%20%20stop%0D%0A%20%20%20%20%20%20end%20subroutine%20end%5Fprocessing%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20subroutine%20error%5Fprocessing%28%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ERROR%3A%27%2Cios%2C%27MESSAGE%3D%27%2Ctrim%28message%29%0D%0A%20%20%20%20%20%20%20%20%20close%28unit%3Dlun%2Ciostat%3Dios%29%0D%0A%20%20%20%20%20%20%20%20%20stop%0D%0A%20%20%20%20%20%20end%20subroutine%20error%5Fprocessing%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fopen%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> open
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_open
      integer :: ios
      character(len=256) :: message
      integer :: lun
         open  (                  &
         & newunit=lun,           &
         & file='employee.names', &
         & action='read',         &
         & iostat=ios,            &
         & iomsg=message)
         if (ios < 0) then
            ! Perform end-of-file processing on the file connected to unit
            call end_processing()
         elseif (ios > 0) then
            ! Perform error processing
            write(*,'(a)')trim(message)
            call error_processing()
            stop
         else
            write(*,*)'OPENED FILE'
         endif
      contains
      !
      subroutine end_processing()
         write(*,*)'END OF FILE:',ios,'MESSAGE=',trim(message)
         close(unit=lun,iostat=ios)
         stop
      end subroutine end_processing
      !
      subroutine error_processing()
         write(*,*)'ERROR:',ios,'MESSAGE=',trim(message)
         close(unit=lun,iostat=ios)
         stop
      end subroutine error_processing
      !
      end program demo_open
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fout%5Fof%5Frange%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%3A%3A%20i8%2C%20j8%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20compilers%20are%20not%20required%20to%20produce%20an%20error%20on%20out%20of%20range%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20here%20storing%20the%20default%20integers%20into%201%2Dbyte%20integers%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20incorrectly%20can%20have%20unexpected%20results%0D%0A%20%20%20%20%20%20%20%20%20%20do%20i%3D127%2C130%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20i8%3Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20j8%3D%2Di%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20OUT%5FOF%5FRANGE%283f%29%20can%20let%20you%20check%20if%20the%20value%20will%20fit%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29i8%2Cj8%2C%27%20might%20have%20expected%27%2Ci%2C%2Di%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20out%5Fof%5Frange%28%20i%2Ci8%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20out%5Fof%5Frange%28%2Di%2Ci8%29%0D%0A%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27RANGE%20IS%20%27%2C%2D1%2Dhuge%280%5Fint8%29%2C%27TO%27%2Chuge%280%5Fint8%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20real%20%2D128%2E5%20is%20truncated%20to%20%2D128%20and%20is%20in%20range%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20out%5Fof%5Frange%20%28%20%20%2D128%2E5%2C%200%5Fint8%29%20%20%20%20%20%20%20%20%20%21%20false%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20real%20%2D128%2E5%20is%20rounded%20to%20%2D129%20and%20is%20not%20in%20range%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20out%5Fof%5Frange%20%28%20%20%2D128%2E5%2C%200%5Fint8%2C%20%2Etrue%2E%29%20%21%20true%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fout%5Fof%5Frange%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> out_of_range
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_out_of_range
      use, intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      use, intrinsic :: iso_fortran_env, only : real32, real64, real128
      implicit none
      integer            :: i
      integer(kind=int8) :: i8, j8

          ! compilers are not required to produce an error on out of range.
          ! here storing the default integers into 1-byte integers
          ! incorrectly can have unexpected results
          do i=127,130
             i8=i
             j8=-i
             ! OUT_OF_RANGE(3f) can let you check if the value will fit
             write(*,*)i8,j8,' might have expected',i,-i, &
              & out_of_range( i,i8), &
              & out_of_range(-i,i8)
          enddo
          write(*,*) 'RANGE IS ',-1-huge(0_int8),'TO',huge(0_int8)
          ! the real -128.5 is truncated to -128 and is in range
          write(*,*) out_of_range (  -128.5, 0_int8)         ! false

          ! the real -128.5 is rounded to -129 and is not in range
          write(*,*) out_of_range (  -128.5, 0_int8, .true.) ! true

      end program demo_out_of_range
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fpack%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20allocatable%20%3A%3A%20m%28%3A%29%0D%0A%20%20%20%20%20%20character%28len%3D10%29%20%3A%3A%20c%284%29%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20gathering%20nonzero%20elements%20from%20an%20array%3A%0D%0A%20%20%20%20%20%20%20%20%20m%20%3D%20%5B%201%2C%200%2C%200%2C%200%2C%205%2C%200%20%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20fmt%3D%22%28%2A%28i0%2C%20%27%20%27%29%29%22%29%20pack%28m%2C%20m%20%2F%3D%200%29%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20Gathering%20nonzero%20elements%20from%20an%20array%20and%20appending%20elements%0D%0A%20%20%20%20%20%20%20%21%20from%20VECTOR%20till%20the%20size%20of%20the%20mask%20array%20%28or%20array%20size%20if%20the%0D%0A%20%20%20%20%20%20%20%21%20mask%20is%20scalar%29%3A%0D%0A%20%20%20%20%20%20%20%20%20m%20%3D%20%5B%201%2C%200%2C%200%2C%202%20%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20fmt%3D%22%28%2A%28i0%2C%20%27%20%27%29%29%22%29%20pack%28m%2C%20m%20%2F%3D%200%2C%20%5B%200%2C%200%2C%203%2C%204%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20fmt%3D%22%28%2A%28i0%2C%20%27%20%27%29%29%22%29%20pack%28m%2C%20m%20%2F%3D%200%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20select%20strings%20whose%20second%20character%20is%20%22a%22%0D%0A%20%20%20%20%20%20%20%20%20c%20%3D%20%5B%20character%28len%3D10%29%20%3A%3A%20%27ape%27%2C%20%27bat%27%2C%20%27cat%27%2C%20%27dog%27%5D%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%20fmt%3D%22%28%2A%28g0%2C%20%27%20%27%29%29%22%29%20pack%28c%2C%20c%28%3A%29%282%3A2%29%20%3D%3D%20%27a%27%20%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fpack%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> pack
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_pack
      implicit none
      integer, allocatable :: m(:)
      character(len=10) :: c(4)

       ! gathering nonzero elements from an array:
         m = [ 1, 0, 0, 0, 5, 0 ]
         write(*, fmt="(*(i0, ' '))") pack(m, m /= 0)

       ! Gathering nonzero elements from an array and appending elements
       ! from VECTOR till the size of the mask array (or array size if the
       ! mask is scalar):
         m = [ 1, 0, 0, 2 ]
         write(*, fmt="(*(i0, ' '))") pack(m, m /= 0, [ 0, 0, 3, 4 ])
         write(*, fmt="(*(i0, ' '))") pack(m, m /= 0 )

       ! select strings whose second character is "a"
         c = [ character(len=10) :: 'ape', 'bat', 'cat', 'dog']
         write(*, fmt="(*(g0, ' '))") pack(c, c(:)(2:2) == 'a' )

      end program demo_pack
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fparity%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%2C%20parameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20x%283%2C4%29%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28%5BT%2CF%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28%5BT%2CF%2CF%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28%5BT%2CF%2CF%2CT%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28%5BT%2CF%2CF%2CT%2CT%5D%29%0D%0A%20%20%20%20%20%20%20%20%20x%281%2C%3A%29%3D%5BT%2CT%2CT%2CT%5D%0D%0A%20%20%20%20%20%20%20%20%20x%282%2C%3A%29%3D%5BT%2CT%2CT%2CT%5D%0D%0A%20%20%20%20%20%20%20%20%20x%283%2C%3A%29%3D%5BT%2CT%2CT%2CT%5D%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28x%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20parity%28x%2Cdim%3D2%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fparity%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> parity
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_parity
      implicit none
      logical, parameter :: T=.true., F=.false.
      logical :: x(3,4)
        ! basics
         print *, parity([T,F])
         print *, parity([T,F,F])
         print *, parity([T,F,F,T])
         print *, parity([T,F,F,T,T])
         x(1,:)=[T,T,T,T]
         x(2,:)=[T,T,T,T]
         x(3,:)=[T,T,T,T]
         print *, parity(x)
         print *, parity(x,dim=1)
         print *, parity(x,dim=2)
      end program demo_parity
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fpopcnt%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20integer%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20pretty%3D%27%28b64%2C1x%2Ci0%29%27%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20127%2C%20%20%20%20%20popcnt%28127%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20int%28b%2201010%22%29%2C%20popcnt%28int%28b%2201010%22%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20any%20kind%20of%20an%20integer%20can%20be%20used%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint8%29%2C%20%20popcnt%28huge%280%5Fint8%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint16%29%2C%20popcnt%28huge%280%5Fint16%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint32%29%2C%20popcnt%28huge%280%5Fint32%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint64%29%2C%20popcnt%28huge%280%5Fint64%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fpopcnt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> popcnt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_popcnt
      use, intrinsic :: iso_fortran_env, only : integer_kinds, &
         & int8, int16, int32, int64
      implicit none
      character(len=*),parameter :: pretty='(b64,1x,i0)'
        ! basic usage
         print pretty, 127,     popcnt(127)
         print pretty, int(b"01010"), popcnt(int(b"01010"))

        ! any kind of an integer can be used
         print pretty, huge(0_int8),  popcnt(huge(0_int8))
         print pretty, huge(0_int16), popcnt(huge(0_int16))
         print pretty, huge(0_int32), popcnt(huge(0_int32))
         print pretty, huge(0_int64), popcnt(huge(0_int64))
      end program demo_popcnt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fpoppar%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20integer%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20pretty%3D%27%28b64%2C1x%2Ci0%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20127%2C%20%20%20%20%20poppar%28127%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20128%2C%20%20%20%20%20poppar%28128%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20int%28b%2201010%22%29%2C%20poppar%28int%28b%2201010%22%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20any%20kind%20of%20an%20integer%20can%20be%20used%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint8%29%2C%20%20poppar%28huge%280%5Fint8%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint16%29%2C%20poppar%28huge%280%5Fint16%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint32%29%2C%20poppar%28huge%280%5Fint32%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20pretty%2C%20huge%280%5Fint64%29%2C%20poppar%28huge%280%5Fint64%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fpoppar%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> poppar
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_poppar
      use, intrinsic :: iso_fortran_env, only : integer_kinds, &
         & int8, int16, int32, int64
      implicit none
      character(len=*),parameter :: pretty='(b64,1x,i0)'
         ! basic usage
         print pretty, 127,     poppar(127)
         print pretty, 128,     poppar(128)
         print pretty, int(b"01010"), poppar(int(b"01010"))

         ! any kind of an integer can be used
         print pretty, huge(0_int8),  poppar(huge(0_int8))
         print pretty, huge(0_int16), poppar(huge(0_int16))
         print pretty, huge(0_int32), poppar(huge(0_int32))
         print pretty, huge(0_int64), poppar(huge(0_int64))
      end program demo_poppar
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fprecision%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dsp%29%20%20%20%20%3A%3A%20x%282%29%0D%0A%20%20%20%20%20%20complex%28kind%3Ddp%29%20%3A%3A%20y%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28x%29%2C%20range%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28y%29%2C%20range%28y%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fprecision%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> precision
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_precision
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=sp)    :: x(2)
      complex(kind=dp) :: y

         print *, precision(x), range(x)
         print *, precision(y), range(y)

      end program demo_precision
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fpresent%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20answer%0D%0A%20%20%20%20%20%20%20%20%20%21%20argument%20to%20func%28%29%20is%20not%20present%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dfunc%28%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20answer%0D%0A%20%20%20%20%20%20%20%20%20%21%20argument%20to%20func%28%29%20is%20present%0D%0A%20%20%20%20%20%20%20%20%20answer%3Dfunc%281492%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20answer%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20integer%20function%20func%28x%29%0D%0A%20%20%20%20%20%20%21%20the%20optional%20characteristic%20on%20this%20definition%20allows%20this%20variable%0D%0A%20%20%20%20%20%20%21%20to%20not%20be%20specified%20on%20a%20call%3B%20and%20also%20allows%20it%20to%20subsequently%0D%0A%20%20%20%20%20%20%21%20be%20passed%20to%20PRESENT%283%29%3A%0D%0A%20%20%20%20%20%20integer%2C%20intent%28in%29%2C%20optional%20%3A%3A%20x%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20x%5Flocal%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%0D%0A%20%20%20%20%20%20%20%20%20if%28present%28x%29%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%21%20if%20present%2C%20you%20can%20use%20x%20like%20any%20other%20variable%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20x%5Flocal%3Dx%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%21%20if%20not%2C%20you%20cannot%20define%20or%20reference%20x%20except%20to%0D%0A%20%20%20%20%20%20%20%20%20%20%20%21%20pass%20it%20as%20an%20optional%20parameter%20to%20another%20procedure%0D%0A%20%20%20%20%20%20%20%20%20%20%20%21%20or%20in%20a%20call%20to%20present%283f%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20x%5Flocal%3D0%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20func%3Dx%5Flocal%2A%2A2%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%21%20passing%20the%20argument%20on%20to%20other%20procedures%0D%0A%20%20%20%20%20%20%20%20%20%21%20so%20something%20like%20this%20is%20a%20bad%20idea%20because%20x%20is%20used%0D%0A%20%20%20%20%20%20%20%20%20%21%20as%20the%20first%20argument%20to%20merge%283f%29%20when%20it%20might%20not%20be%0D%0A%20%20%20%20%20%20%20%20%20%21%20present%0D%0A%20%20%20%20%20%20%20%20%20%21%20xlocal%3Dmerge%28x%2C0%2Cpresent%28x%29%29%20%21%20NO%21%21%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%21%20We%20can%20pass%20it%20to%20another%20procedure%20if%20another%0D%0A%20%20%20%20%20%20%20%20%20%21%20procedure%20declares%20the%20argument%20as%20optional%20as%20well%2C%0D%0A%20%20%20%20%20%20%20%20%20%21%20or%20we%20have%20tested%20that%20X%20is%20present%0D%0A%20%20%20%20%20%20%20%20%20call%20tattle%28%27optional%20argument%20x%27%2Cx%29%0D%0A%20%20%20%20%20%20%20%20%20if%28present%28x%29%29call%20not%5Foptional%28x%29%0D%0A%20%20%20%20%20%20end%20function%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20subroutine%20tattle%28label%2Carg%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%3A%3A%20label%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%2Coptional%20%3A%3A%20arg%0D%0A%20%20%20%20%20%20%20%20%20if%28present%28arg%29%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29label%2C%27%20is%20present%27%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29label%2C%27%20is%20not%20present%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20subroutine%20tattle%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20subroutine%20not%5Foptional%28arg%29%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arg%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27already%20tested%20X%20is%20defined%27%2Carg%0D%0A%20%20%20%20%20%20end%20subroutine%20not%5Foptional%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fpresent%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> present
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_present
      implicit none
      integer :: answer
         ! argument to func() is not present
         answer=func()
         write(*,*) answer
         ! argument to func() is present
         answer=func(1492)
         write(*,*) answer
      contains
      !
      integer function func(x)
      ! the optional characteristic on this definition allows this variable
      ! to not be specified on a call; and also allows it to subsequently
      ! be passed to PRESENT(3):
      integer, intent(in), optional :: x
      integer :: x_local
         !
         ! basic
         if(present(x))then
           ! if present, you can use x like any other variable.
           x_local=x
         else
           ! if not, you cannot define or reference x except to
           ! pass it as an optional parameter to another procedure
           ! or in a call to present(3f)
           x_local=0
         endif
         !
         func=x_local**2
         !
         ! passing the argument on to other procedures
         ! so something like this is a bad idea because x is used
         ! as the first argument to merge(3f) when it might not be
         ! present
         ! xlocal=merge(x,0,present(x)) ! NO!!
         !
         ! We can pass it to another procedure if another
         ! procedure declares the argument as optional as well,
         ! or we have tested that X is present
         call tattle('optional argument x',x)
         if(present(x))call not_optional(x)
      end function
      !
      subroutine tattle(label,arg)
      character(len=*),intent(in) :: label
      integer,intent(in),optional :: arg
         if(present(arg))then
            write(*,*)label,' is present'
         else
            write(*,*)label,' is not present'
         endif
      end subroutine tattle
      !
      subroutine not_optional(arg)
      integer,intent(in) :: arg
         write(*,*)'already tested X is defined',arg
      end subroutine not_optional
      !
      end program demo_present
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> print
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fproduct%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%20%21%20a%20handy%20format%0D%0A%20%20%20%20%20%20character%28len%3D1%29%2Cparameter%20%3A%3A%20nl%3Dnew%5Fline%28%27a%27%29%0D%0A%0D%0A%20%20%20%20%20%20NO%5FDIM%3A%20block%0D%0A%20%20%20%20%20%20%21%20%20%20%20If%20DIM%20is%20not%20specified%2C%20the%20result%20is%20the%20product%20of%20all%20the%0D%0A%20%20%20%20%20%20%21%20%20%20%20selected%20array%20elements%2E%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%2Cn%2C%20p1%2C%20p2%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20array%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20all%20elements%20are%20selected%20by%20default%0D%0A%20%20%20%20%20%20%20%20%20do%20n%3D1%2C10%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20all%2C%20%27factorial%20of%20%27%2Cn%2C%27%20is%20%27%2C%20product%28%5B%28real%28i%29%2Ci%3D1%2Cn%29%5D%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20using%20a%20mask%0D%0A%20%20%20%20%20%20%20%20%20array%3D%5B10%2C12%2C13%2C15%2C20%2C25%2C30%5D%0D%0A%20%20%20%20%20%20%20%20%20p1%3Dproduct%28array%2C%20mask%3Dmod%28array%2C%202%29%3D%3D1%29%20%21%20only%20odd%20elements%0D%0A%20%20%20%20%20%20%20%20%20p2%3Dproduct%28array%2C%20mask%3Dmod%28array%2C%202%29%2F%3D1%29%20%21%20only%20even%20elements%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20nl%2C%27product%20of%20all%20elements%27%2Cproduct%28array%29%20%21%20all%20elements%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27%20odd%20%2A%20even%20%3D%27%2Cnl%2Cp1%2C%27%2A%27%2Cp2%2C%27%3D%27%2Cp1%2Ap2%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20NOTE%3A%20If%20ARRAY%20is%20a%20zero%2Dsized%20array%2C%20the%20result%20is%20equal%20to%20one%0D%0A%20%20%20%20%20%20%20%20%20print%20all%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27zero%2Dsized%20array%3D%3E%27%2Cproduct%28%5Binteger%20%3A%3A%20%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20NOTE%3A%20If%20nothing%20in%20the%20mask%20is%20true%2C%20this%20also%20results%20in%20a%20null%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20array%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27all%20elements%20have%20a%20false%20mask%3D%3E%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20product%28array%2Cmask%3D%2Efalse%2E%29%0D%0A%0D%0A%20%20%20%20%20%20endblock%20NO%5FDIM%0D%0A%0D%0A%20%20%20%20%20%20WITH%5FDIM%3A%20block%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20rect%282%2C3%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20box%282%2C3%2C4%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20lets%20fill%20a%20few%20arrays%0D%0A%20%20%20%20%20%20%20%20%20rect%20%3D%20reshape%28%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%201%2C%202%2C%203%2C%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%204%2C%205%2C%206%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%5D%2Cshape%28rect%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27rect%27%2Crect%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20Find%20the%20product%20of%20each%20column%20in%20RECT%2E%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27product%20of%20columns%3D%27%2Cproduct%28rect%2C%20dim%20%3D%201%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20Find%20the%20product%20of%20each%20row%20in%20RECT%2E%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27product%20of%20rows%3D%27%2Cproduct%28rect%2C%20dim%20%3D%202%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20now%20lets%20try%20a%20box%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C1%29%3Drect%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C2%29%3Drect%2A%28%2B10%29%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C3%29%3Drect%2A%28%2D10%29%0D%0A%20%20%20%20%20%20%20%20%20box%28%3A%2C%3A%2C4%29%3Drect%2A2%0D%0A%20%20%20%20%20%20%20%20%20%21%20lets%20look%20at%20the%20values%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27box%201%27%2Cbox%28%3A%2C%3A%2C1%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27box%202%27%2Cbox%28%3A%2C%3A%2C2%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27box%203%27%2Cbox%28%3A%2C%3A%2C3%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27box%204%27%2Cbox%28%3A%2C%3A%2C4%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20remember%20without%20dim%3D%20even%20a%20box%20produces%20a%20scalar%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27no%20dim%20gives%20a%20scalar%27%2Cproduct%28real%28box%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20only%20one%20plane%20has%20negative%20values%2C%20so%20note%20all%20the%20%221%22%20values%0D%0A%20%20%20%20%20%20%20%20%20%21%20for%20vectors%20with%20no%20elements%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27negative%20values%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20product%28box%2Cmask%3Dbox%20%3C%200%2Cdim%3D1%29%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20%20If%20DIM%20is%20specified%20and%20ARRAY%20has%20rank%20greater%20than%20one%2C%20the%0D%0A%20%20%20%20%20%20%21%20%20%20result%20is%20a%20new%20array%20in%20which%20dimension%20DIM%20has%20been%20eliminated%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20pick%20a%20dimension%20to%20multiply%20though%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27dim%3D1%27%2Cproduct%28box%2Cdim%3D1%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27dim%3D2%27%2Cproduct%28box%2Cdim%3D2%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27dim%3D3%27%2Cproduct%28box%2Cdim%3D3%29%29%0D%0A%0D%0A%20%20%20%20%20%20endblock%20WITH%5FDIM%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20print%5Fmatrix%5Fint%28title%2Carr%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20all%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20trim%28title%29%2C%27%3A%28%27%2Cshape%28arr%29%2C%27%29%27%20%20%21%20print%20title%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20print%5Fmatrix%5Fint%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fproduct%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> product
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_product
      implicit none
      character(len=*),parameter :: all='(*(g0,1x))' ! a handy format
      character(len=1),parameter :: nl=new_line('a')

      NO_DIM: block
      !    If DIM is not specified, the result is the product of all the
      !    selected array elements.
      integer :: i,n, p1, p2
      integer,allocatable :: array(:)
         ! all elements are selected by default
         do n=1,10
            print all, 'factorial of ',n,' is ', product([(real(i),i=1,n)])
         enddo

         ! using a mask
         array=[10,12,13,15,20,25,30]
         p1=product(array, mask=mod(array, 2)==1) ! only odd elements
         p2=product(array, mask=mod(array, 2)/=1) ! only even elements
         print all, nl,'product of all elements',product(array) ! all elements
         print all, ' odd * even =',nl,p1,'*',p2,'=',p1*p2

         ! NOTE: If ARRAY is a zero-sized array, the result is equal to one
         print all
         print all, 'zero-sized array=>',product([integer :: ])
         ! NOTE: If nothing in the mask is true, this also results in a null
         !       array
         print all, 'all elements have a false mask=>', &
                  & product(array,mask=.false.)

      endblock NO_DIM

      WITH_DIM: block
      integer :: rect(2,3)
      integer :: box(2,3,4)

      !  lets fill a few arrays
         rect = reshape([ &
           1, 2, 3,       &
           4, 5, 6        &
         ],shape(rect),order=[2,1])
         call print_matrix_int('rect',rect)

      !  Find the product of each column in RECT.
         print all, 'product of columns=',product(rect, dim = 1)

      ! Find the product of each row in RECT.
         print all, 'product of rows=',product(rect, dim = 2)

      ! now lets try a box
         box(:,:,1)=rect
         box(:,:,2)=rect*(+10)
         box(:,:,3)=rect*(-10)
         box(:,:,4)=rect*2
         ! lets look at the values
         call print_matrix_int('box 1',box(:,:,1))
         call print_matrix_int('box 2',box(:,:,2))
         call print_matrix_int('box 3',box(:,:,3))
         call print_matrix_int('box 4',box(:,:,4))

         ! remember without dim= even a box produces a scalar
         print all, 'no dim gives a scalar',product(real(box))

         ! only one plane has negative values, so note all the "1" values
         ! for vectors with no elements
         call print_matrix_int('negative values', &
         & product(box,mask=box < 0,dim=1))

      !   If DIM is specified and ARRAY has rank greater than one, the
      !   result is a new array in which dimension DIM has been eliminated.

         ! pick a dimension to multiply though
         call print_matrix_int('dim=1',product(box,dim=1))

         call print_matrix_int('dim=2',product(box,dim=2))

         call print_matrix_int('dim=3',product(box,dim=3))

      endblock WITH_DIM

      contains

      subroutine print_matrix_int(title,arr)
      implicit none

      !@(#) print small 2d integer arrays in row-column format

      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest

         print all
         print all, trim(title),':(',shape(arr),')'  ! print title
         biggest='           '  ! make buffer to write integer into
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='(" > [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo

      end subroutine print_matrix_int

      end program demo_product
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fradix%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20radix%20for%20the%20default%20integer%20kind%20is%22%2C%20radix%280%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20radix%20for%20the%20default%20real%20kind%20is%22%2C%20radix%280%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%22The%20radix%20for%20the%20doubleprecision%20real%20kind%20is%22%2C%20radix%280%2E0d0%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fradix%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> radix
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_radix
      implicit none
         print *, "The radix for the default integer kind is", radix(0)
         print *, "The radix for the default real kind is", radix(0.0)
         print *, "The radix for the doubleprecision real kind is", radix(0.0d0)
      end program demo_radix
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20%20program%20demo%5Frandom%5Finit%0D%0A%20%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20real%20x%283%29%2C%20y%283%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Finit%28%2Etrue%2E%2C%20%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fnumber%28x%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Finit%28%2Etrue%2E%2C%20%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fnumber%28y%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20x%20and%20y%20should%20be%20the%20same%20sequence%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%20any%28x%20%2F%3D%20y%29%20%29%20stop%20%22x%28%3A%29%20and%20y%28%3A%29%20are%20not%20all%20equal%22%0D%0A%20%20%20%20%20%20%20%20%20%20end%20program%20demo%5Frandom%5Finit%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> random_init
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
          program demo_random_init
          implicit none
          real x(3), y(3)
             call random_init(.true., .true.)
             call random_number(x)
             call random_init(.true., .true.)
             call random_number(y)
             ! x and y should be the same sequence
             if ( any(x /= y) ) stop "x(:) and y(:) are not all equal"
          end program demo_random_init
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Frandom%5Fnumber%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20allocatable%20%3A%3A%20seed%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20n%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20first%2Clast%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20rand%5Fint%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%20%3A%3A%20count%28%3A%29%0D%0A%20%20%20%20%20%20real%28kind%3Ddp%29%20%20%20%20%20%20%20%20%3A%3A%20rand%5Fval%0D%0A%20%20%20%20%20%20%20%20%20call%20random%5Fseed%28size%20%3D%20n%29%0D%0A%20%20%20%20%20%20%20%20%20allocate%28seed%28n%29%29%0D%0A%20%20%20%20%20%20%20%20%20call%20random%5Fseed%28get%3Dseed%29%0D%0A%20%20%20%20%20%20%20%20%20first%3D1%0D%0A%20%20%20%20%20%20%20%20%20last%3D10%0D%0A%20%20%20%20%20%20%20%20%20allocate%28count%28last%2Dfirst%2B1%29%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20To%20have%20a%20discrete%20uniform%20distribution%20on%20the%20integers%0D%0A%20%20%20%20%20%20%20%20%20%21%20%5Bfirst%2C%20first%2B1%2C%20%2E%2E%2E%2C%20last%2D1%2C%20last%5D%20carve%20the%20continuous%0D%0A%20%20%20%20%20%20%20%20%20%21%20distribution%20up%20into%20last%2B1%2Dfirst%20equal%20sized%20chunks%2C%0D%0A%20%20%20%20%20%20%20%20%20%21%20mapping%20each%20chunk%20to%20an%20integer%2E%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%21%20One%20way%20is%3A%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20call%20random%5Fnumber%28rand%5Fval%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20choose%20one%20from%20last%2Dfirst%2B1%20integers%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20rand%5Fint%20%3D%20first%20%2B%20FLOOR%28%28last%2B1%2Dfirst%29%2Arand%5Fval%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20count%3D0%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20generate%20a%20lot%20of%20random%20integers%20from%201%20to%2010%20and%20count%20them%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20with%20a%20large%20number%20of%20values%20you%20should%20get%20about%20the%20same%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20number%20of%20each%20value%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2C100000000%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fnumber%28rand%5Fval%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rand%5Fint%3Dfirst%2Bfloor%28%28last%2B1%2Dfirst%29%2Arand%5Fval%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%28rand%5Fint%2Ege%2Efirst%2Eand%2Erand%5Fint%2Ele%2Elast%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20count%28rand%5Fint%29%3Dcount%28rand%5Fint%29%2B1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29rand%5Fint%2C%27%20is%20out%20of%20range%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28i0%2C1x%2Ci0%29%27%29%28i%2Ccount%28i%29%2Ci%3D1%2Csize%28count%29%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Frandom%5Fnumber%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> random_number
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_random_number
      use, intrinsic :: iso_fortran_env, only : dp=>real64
      implicit none
      integer, allocatable :: seed(:)
      integer              :: n
      integer              :: first,last
      integer              :: i
      integer              :: rand_int
      integer,allocatable  :: count(:)
      real(kind=dp)        :: rand_val
         call random_seed(size = n)
         allocate(seed(n))
         call random_seed(get=seed)
         first=1
         last=10
         allocate(count(last-first+1))
         ! To have a discrete uniform distribution on the integers
         ! [first, first+1, ..., last-1, last] carve the continuous
         ! distribution up into last+1-first equal sized chunks,
         ! mapping each chunk to an integer.
         !
         ! One way is:
         !   call random_number(rand_val)
         ! choose one from last-first+1 integers
         !   rand_int = first + FLOOR((last+1-first)*rand_val)
            count=0
            ! generate a lot of random integers from 1 to 10 and count them.
            ! with a large number of values you should get about the same
            ! number of each value
            do i=1,100000000
               call random_number(rand_val)
               rand_int=first+floor((last+1-first)*rand_val)
               if(rand_int.ge.first.and.rand_int.le.last)then
                  count(rand_int)=count(rand_int)+1
               else
                  write(*,*)rand_int,' is out of range'
               endif
            enddo
            write(*,'(i0,1x,i0)')(i,count(i),i=1,size(count))
      end program demo_random_number
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20%20program%20demo%5Frandom%5Fseed%0D%0A%20%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20integer%2C%20allocatable%20%3A%3A%20seed%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20n%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fseed%28size%20%3D%20n%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20allocate%28seed%28n%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20call%20random%5Fseed%28get%3Dseed%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%20%2A%29%20seed%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20end%20program%20demo%5Frandom%5Fseed%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> random_seed
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
          program demo_random_seed
          implicit none
          integer, allocatable :: seed(:)
          integer :: n

             call random_seed(size = n)
             allocate(seed(n))
             call random_seed(get=seed)
             write (*, *) seed

          end program demo_random_seed
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Frange%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%2Csp%3D%3Ereal32%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dsp%29%20%20%20%20%3A%3A%20x%282%29%0D%0A%20%20%20%20%20%20complex%28kind%3Ddp%29%20%3A%3A%20y%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28x%29%2C%20range%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28y%29%2C%20range%28y%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Frange%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> range
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_range
      use,intrinsic :: iso_fortran_env, only : dp=>real64,sp=>real32
      implicit none
      real(kind=sp)    :: x(2)
      complex(kind=dp) :: y
         print *, precision(x), range(x)
         print *, precision(y), range(y)
      end program demo_range
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Frank%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%20a%20bunch%20of%20data%20objects%20to%20query%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%0D%0A%20%20%20%20%20%20real%2C%20allocatable%20%3A%3A%20b%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20real%2C%20pointer%20%20%20%20%20%3A%3A%20c%28%3A%29%0D%0A%20%20%20%20%20%20complex%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20d%0D%0A%0D%0A%20%20%20%20%20%20%21%20make%20up%20a%20type%0D%0A%20%20%20%20%20%20type%20mytype%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20int%0D%0A%20%20%20%20%20%20%20%20%20real%20%3A%3A%20float%0D%0A%20%20%20%20%20%20%20%20%20character%20%3A%3A%20char%0D%0A%20%20%20%20%20%20end%20type%20mytype%0D%0A%20%20%20%20%20%20type%28mytype%29%20%3A%3A%20any%5Fthing%281%2C2%2C3%2C4%2C5%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27rank%20of%20scalar%20a%3D%27%2Crank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20you%20can%20query%20this%20array%20even%20though%20it%20is%20not%20allocated%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27rank%20of%20matrix%20b%3D%27%2Crank%28b%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27rank%20of%20vector%20pointer%20c%3D%27%2Crank%28c%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27rank%20of%20complex%20scalar%20d%3D%27%2Crank%28d%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20you%20can%20query%20any%20type%2C%20not%20just%20intrinsics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27rank%20of%20any%20arbitrary%20type%3D%27%2Crank%28any%5Fthing%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20an%20assumed%2Drank%20object%20may%20be%20queried%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fint%2810%29%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fint%28%5B20%2C30%5D%29%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fint%28%20reshape%28%5B40%2C50%2C60%2C70%5D%2C%5B2%2C2%5D%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20you%20can%20even%20query%20an%20unlimited%20polymorphic%20entity%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fanything%2810%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fanything%28%5B%2Etrue%2E%2C%2Efalse%2E%5D%29%0D%0A%20%20%20%20%20%20%20%20%20call%20query%5Fanything%28%20reshape%28%5B40%2E0%2C50%2E0%2C60%2E0%2C70%2E0%5D%2C%5B2%2C2%5D%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20query%5Fint%28data%5Fobject%29%0D%0A%20%20%20%20%20%20%21%20It%20is%20hard%20to%20do%20much%20with%20something%20dimensioned%0D%0A%20%20%20%20%20%20%21%20name%28%2E%2E%29%20if%20not%20calling%20C%20except%20inside%20of%20a%0D%0A%20%20%20%20%20%20%21%20SELECT%5FRANK%20construct%20but%20one%20thing%20you%20can%0D%0A%20%20%20%20%20%20%21%20do%20is%20call%20the%20inquiry%20functions%20%2E%2E%2E%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20data%5Fobject%28%2E%2E%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20if%28rank%28data%5Fobject%29%2Eeq%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20all%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27passed%20a%20scalar%20to%20an%20assumed%20rank%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20rank%3D%27%2Crank%28data%5Fobject%29%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20all%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27passed%20an%20array%20to%20an%20assumed%20rank%2C%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%26%20rank%3D%27%2Crank%28data%5Fobject%29%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20query%5Fint%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20query%5Fanything%28data%5Fobject%29%0D%0A%20%20%20%20%20%20class%28%2A%29%2Cintent%28in%29%20%3A%3Adata%5Fobject%28%2E%2E%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20%20%20if%28rank%28data%5Fobject%29%2Eeq%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%27passed%20a%20scalar%20to%20an%20unlimited%20polymorphic%20rank%3D%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20rank%28data%5Fobject%29%0D%0A%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20print%20all%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20%27passed%20an%20array%20to%20an%20unlimited%20polymorphic%2C%20rank%3D%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20rank%28data%5Fobject%29%0D%0A%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20subroutine%20query%5Fanything%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Frank%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> rank
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_rank
      implicit none

      ! a bunch of data objects to query
      integer           :: a
      real, allocatable :: b(:,:)
      real, pointer     :: c(:)
      complex           :: d

      ! make up a type
      type mytype
         integer :: int
         real :: float
         character :: char
      end type mytype
      type(mytype) :: any_thing(1,2,3,4,5)

        ! basics
         print *, 'rank of scalar a=',rank(a)
         ! you can query this array even though it is not allocated
         print *, 'rank of matrix b=',rank(b)
         print *, 'rank of vector pointer c=',rank(c)
         print *, 'rank of complex scalar d=',rank(d)

        ! you can query any type, not just intrinsics
         print *, 'rank of any arbitrary type=',rank(any_thing)

        ! an assumed-rank object may be queried
         call query_int(10)
         call query_int([20,30])
         call query_int( reshape([40,50,60,70],[2,2]) )

        ! you can even query an unlimited polymorphic entity
         call query_anything(10.0)
         call query_anything([.true.,.false.])
         call query_anything( reshape([40.0,50.0,60.0,70.0],[2,2]) )

      contains

      subroutine query_int(data_object)
      ! It is hard to do much with something dimensioned
      ! name(..) if not calling C except inside of a
      ! SELECT_RANK construct but one thing you can
      ! do is call the inquiry functions ...
      integer,intent(in) :: data_object(..)
      character(len=*),parameter :: all='(*(g0,1x))'

         if(rank(data_object).eq.0)then
            print all,&
            & 'passed a scalar to an assumed rank,  &
            & rank=',rank(data_object)
         else
            print all,&
            & 'passed an array to an assumed rank,  &
            & rank=',rank(data_object)
         endif

      end subroutine query_int

      subroutine query_anything(data_object)
      class(*),intent(in) ::data_object(..)
      character(len=*),parameter :: all='(*(g0,1x))'
        if(rank(data_object).eq.0)then
          print all,&
          &'passed a scalar to an unlimited polymorphic rank=', &
          & rank(data_object)
        else
          print all,&
          & 'passed an array to an unlimited polymorphic, rank=', &
          & rank(data_object)
        endif
      end subroutine query_anything

      end program demo_rank
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> read
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Freal%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20dp%3D%3Ereal64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20complex%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20zr%20%3D%20%281%2E0%2C%202%2E0%29%0D%0A%20%20%20%20%20%20doubleprecision%20%20%20%20%20%20%3A%3A%20xd%3Dhuge%283%2E0d0%29%0D%0A%20%20%20%20%20%20complex%28kind%3Ddp%29%20%3A%3A%20zd%3Dcmplx%284%2E0e0%5Fdp%2C5%2E0e0%5Fdp%2Ckind%3Ddp%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20real%28zr%29%2C%20aimag%28zr%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20dble%28zd%29%2C%20aimag%28zd%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29xd%2Creal%28xd%2Ckind%3Dkind%280%2E0d0%29%29%2Cdble%28xd%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Freal%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> real
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_real
      use,intrinsic :: iso_fortran_env, only : dp=>real64
      implicit none
      complex              :: zr = (1.0, 2.0)
      doubleprecision      :: xd=huge(3.0d0)
      complex(kind=dp) :: zd=cmplx(4.0e0_dp,5.0e0_dp,kind=dp)

         print *, real(zr), aimag(zr)
         print *, dble(zd), aimag(zd)

         write(*,*)xd,real(xd,kind=kind(0.0d0)),dble(xd)
      end program demo_real
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20program%20demo%5Freduce%0D%0A%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20f%3D%27%28%22%5B%22%2C%2A%28g0%2C%22%2C%22%2C1x%29%2C%22%5D%22%29%27%0D%0A%20%20%20%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20arr%28%3A%29%2C%20b%28%3A%2C%3A%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20Basic%20usage%3A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20the%20product%20of%20the%20elements%20of%20an%20array%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20arr%3D%5B1%2C%202%2C%203%2C%204%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20arr%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27product%3D%27%2C%20reduce%28arr%2C%20my%5Fmult%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27sum%3D%27%2C%20reduce%28arr%2C%20my%5Fsum%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20Examples%20of%20masking%3A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20the%20product%20of%20only%20the%20positive%20elements%20of%20an%20array%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20arr%3D%5B1%2C%20%2D1%2C%202%2C%20%2D2%2C%203%2C%20%2D3%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27positive%20value%20product%3D%27%2Creduce%28arr%2C%20my%5Fmult%2C%20mask%3Darr%3E0%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20sum%20values%20ignoring%20negative%20values%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27sum%20positive%20values%3D%27%2Creduce%28arr%2C%20my%5Fsum%2C%20mask%3Darr%3E0%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20single%2Dvalued%20array%20returns%20the%20single%20value%20as%20the%0D%0A%20%20%20%20%20%20%20%20%20%21%20calls%20to%20the%20operator%20stop%20when%20only%20one%20element%20remains%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20arr%3D%5B%201234%20%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27single%20value%20sum%27%2Creduce%28arr%2C%20my%5Fsum%20%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27single%20value%20product%27%2Creduce%28arr%2C%20my%5Fmult%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20Example%20of%20operations%20along%20a%20dimension%3A%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20If%20B%20is%20the%20array%20%20%201%203%205%0D%0A%20%20%20%20%20%20%20%20%20%21%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%204%206%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20b%3Dreshape%28%5B1%2C2%2C3%2C4%2C5%2C6%5D%2C%5B2%2C3%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%20REDUCE%28B%2C%20MY%5FMULT%29%2C%27should%20be%20%5B720%5D%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%20REDUCE%28B%2C%20MY%5FMULT%2C%20DIM%3D1%29%2C%27should%20be%20%5B2%2C12%2C30%5D%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cf%29%20REDUCE%28B%2C%20MY%5FMULT%2C%20DIM%3D2%29%2C%27should%20be%20%5B15%2C%2048%5D%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20pure%20function%20my%5Fmult%28a%2Cb%29%20result%28c%29%0D%0A%20%20%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20c%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20c%3Da%2Ab%0D%0A%20%20%20%20%20%20%20%20%20end%20function%20my%5Fmult%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20pure%20function%20my%5Fsum%28a%2Cb%29%20result%28c%29%0D%0A%20%20%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20a%2C%20b%0D%0A%20%20%20%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20c%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20c%3Da%2Bb%0D%0A%20%20%20%20%20%20%20%20%20end%20function%20my%5Fsum%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20end%20program%20demo%5Freduce%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> reduce
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
         program demo_reduce
         implicit none
         character(len=*),parameter :: f='("[",*(g0,",",1x),"]")'
         integer,allocatable :: arr(:), b(:,:)

         ! Basic usage:
            ! the product of the elements of an array
            arr=[1, 2, 3, 4 ]
            write(*,*) arr
            write(*,*) 'product=', reduce(arr, my_mult)
            write(*,*) 'sum=', reduce(arr, my_sum)

         ! Examples of masking:
            ! the product of only the positive elements of an array
            arr=[1, -1, 2, -2, 3, -3 ]
            write(*,*)'positive value product=',reduce(arr, my_mult, mask=arr>0)
         ! sum values ignoring negative values
            write(*,*)'sum positive values=',reduce(arr, my_sum, mask=arr>0)

         ! a single-valued array returns the single value as the
         ! calls to the operator stop when only one element remains
            arr=[ 1234 ]
            write(*,*)'single value sum',reduce(arr, my_sum )
            write(*,*)'single value product',reduce(arr, my_mult )

         ! Example of operations along a dimension:
         !  If B is the array   1 3 5
         !                      2 4 6
            b=reshape([1,2,3,4,5,6],[2,3])
            write(*,f) REDUCE(B, MY_MULT),'should be [720]'
            write(*,f) REDUCE(B, MY_MULT, DIM=1),'should be [2,12,30]'
            write(*,f) REDUCE(B, MY_MULT, DIM=2),'should be [15, 48]'

         contains

         pure function my_mult(a,b) result(c)
         integer,intent(in) :: a, b
         integer            :: c
            c=a*b
         end function my_mult

         pure function my_sum(a,b) result(c)
         integer,intent(in) :: a, b
         integer            :: c
            c=a+b
         end function my_sum

         end program demo_reduce
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Frepeat%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20repeat%28%22%5Ev%22%2C%2035%29%20%20%20%20%20%20%20%20%20%21%20line%20break%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20repeat%28%22%5F%22%2C%2070%29%20%20%20%20%20%20%20%20%20%20%21%20line%20break%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20repeat%28%221234567890%22%2C%207%29%20%20%21%20number%20line%0D%0A%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%20repeat%28%22%20%20%20%20%20%20%20%20%20%7C%22%2C%207%29%20%20%21%0D%0A%20%20%20%20%20%20end%20program%20demo%5Frepeat%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> repeat
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_repeat
      implicit none
          write(*,'(a)') repeat("^v", 35)         ! line break
          write(*,'(a)') repeat("_", 70)          ! line break
          write(*,'(a)') repeat("1234567890", 7)  ! number line
          write(*,'(a)') repeat("         |", 7)  !
      end program demo_repeat
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Freshape%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%20notice%20the%20use%20of%20%22shape%28box%29%22%20on%20the%20RHS%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20box%283%2C4%29%3Dreshape%28%5B1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%2C10%2C11%2C12%5D%2Cshape%28box%29%29%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%3A%3A%20v%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20rc%282%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20basics0%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20what%20is%20the%20current%20shape%20of%20the%20array%3F%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27shape%20of%20box%20is%20%27%2Cbox%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20change%20the%20shape%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27reshaped%20%27%2Creshape%28box%2C%5B2%2C6%5D%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27reshaped%20%27%2Creshape%28box%2C%5B4%2C3%5D%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20fill%20in%20row%20column%20order%20using%20order%0D%0A%20%20%20%20%20%20%20%20%20%20v%3Dreshape%28%5B1%2C2%2C3%2C4%2C10%2C20%2C30%2C40%2C100%2C200%2C300%2C400%5D%2C%5B1%2C12%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27here%20is%20some%20data%20to%20shape%27%2Cv%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27normally%20fills%20columns%20first%20%27%2Creshape%28%5Bv%5D%2C%5B3%2C4%5D%29%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27fill%20rows%20first%27%2C%20reshape%28%5Bv%5D%2C%5B3%2C4%5D%2Corder%3D%5B2%2C1%5D%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20if%20we%20take%20the%20data%20and%20put%20in%20back%20in%20filling%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20rows%20first%20instead%20of%20columns%2C%20and%20flipping%20the%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20height%20and%20width%20of%20the%20box%20we%20not%20only%20fill%20in%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20a%20vector%20using%20row%2Dcolumn%20order%20we%20actually%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20transpose%20it%2E%0D%0A%20%20%20%20%20%20%20%20%20%20rc%282%3A1%3A%2D1%29%3Dshape%28box%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20copy%20the%20data%20in%20changing%20column%20number%20fastest%0D%0A%20%20%20%20%20%20%20%20%20%20v%3Dreshape%28box%2Crc%2Corder%3D%5B2%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27reshaped%20and%20reordered%27%2Cv%29%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20of%20course%20we%20could%20have%20just%20done%20a%20transpose%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27transposed%27%2Ctranspose%28box%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20making%20the%20result%20bigger%20than%20source%20using%20pad%0D%0A%20%20%20%20%20%20%20%20%20%20v%3Dreshape%28box%2Crc%2A2%2Cpad%3D%5B%2D1%2C%2D2%2C%2D3%5D%2Corder%3D%5B2%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20%20call%20printi%28%27bigger%20and%20padded%20and%20reordered%27%2Cv%29%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20printi%28title%2Carr%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%20%21%20a%20handy%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20all%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20trim%28title%29%2C%27%3A%28%27%2Cshape%28arr%29%2C%27%29%27%20%20%21%20print%20title%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20printi%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Freshape%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> reshape
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_reshape
      implicit none
      ! notice the use of "shape(box)" on the RHS
      integer :: box(3,4)=reshape([1,2,3,4,5,6,7,8,9,10,11,12],shape(box))
      integer,allocatable :: v(:,:)
      integer :: rc(2)
         ! basics0
          ! what is the current shape of the array?
          call printi('shape of box is ',box)
          ! change the shape
          call printi('reshaped ',reshape(box,[2,6]))
          call printi('reshaped ',reshape(box,[4,3]))

         ! fill in row column order using order
          v=reshape([1,2,3,4,10,20,30,40,100,200,300,400],[1,12])
          call printi('here is some data to shape',v)
          call printi('normally fills columns first ',reshape([v],[3,4]))
          call printi('fill rows first', reshape([v],[3,4],order=[2,1]))

          ! if we take the data and put in back in filling
          ! rows first instead of columns, and flipping the
          ! height and width of the box we not only fill in
          ! a vector using row-column order we actually
          ! transpose it.
          rc(2:1:-1)=shape(box)
          ! copy the data in changing column number fastest
          v=reshape(box,rc,order=[2,1])
          call printi('reshaped and reordered',v)
          ! of course we could have just done a transpose
          call printi('transposed',transpose(box))

         ! making the result bigger than source using pad
          v=reshape(box,rc*2,pad=[-1,-2,-3],order=[2,1])
          call printi('bigger and padded and reordered',v)
      contains

      subroutine printi(title,arr)
      implicit none

      !@(#) print small 2d integer arrays in row-column format

      character(len=*),parameter :: all='(*(g0,1x))' ! a handy format
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest

         print all
         print all, trim(title),':(',shape(arr),')'  ! print title
         biggest='           '  ! make buffer to write integer into
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='(" > [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo

      end subroutine printi

      end program demo_reshape
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> rrspacing
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%21%20program%20demo%5Fsame%5Ftype%5Fas%0D%0A%20%20%20%20%20%20%20%20module%20M%5Fether%0D%0A%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20private%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%20%20%20%3A%3A%20dot%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20x%3D0%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20y%3D0%0D%0A%20%20%20%20%20%20%20%20end%20type%20dot%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%2C%20extends%28dot%29%20%3A%3A%20point%0D%0A%20%20%20%20%20%20%20%20%20%20real%20%3A%3A%20z%3D0%0D%0A%20%20%20%20%20%20%20%20end%20type%20point%0D%0A%0D%0A%20%20%20%20%20%20%20%20type%20something%5Felse%0D%0A%20%20%20%20%20%20%20%20end%20type%20something%5Felse%0D%0A%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20dot%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20point%0D%0A%20%20%20%20%20%20%20%20public%20%3A%3A%20something%5Felse%0D%0A%0D%0A%20%20%20%20%20%20%20%20end%20module%20M%5Fether%0D%0A%0D%0A%20%20%20%20%20%20%20%20program%20demo%5Fsame%5Ftype%5Fas%0D%0A%20%20%20%20%20%20%20%20use%20M%5Fether%2C%20only%20%3A%20dot%2C%20point%2C%20something%5Felse%0D%0A%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20type%28dot%29%20%3A%3A%20dad%2C%20mom%0D%0A%20%20%20%20%20%20%20%20type%28point%29%20%3A%3A%20me%0D%0A%20%20%20%20%20%20%20%20type%28something%5Felse%29%20%3A%3A%20alien%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29same%5Ftype%5Fas%28me%2Cdad%29%2C%27I%20am%20descended%20from%20Dad%2C%20but%20equal%3F%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29same%5Ftype%5Fas%28me%2Cme%29%20%2C%27I%20am%20what%20I%20am%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29same%5Ftype%5Fas%28dad%2Cmom%29%20%2C%27what%20a%20pair%21%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29same%5Ftype%5Fas%28dad%2Cme%29%2C%27no%20paradox%20here%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29same%5Ftype%5Fas%28dad%2Calien%29%2C%27no%20relation%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20pointers%28%29%0D%0A%20%20%20%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20pointers%28%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20Given%20the%20declarations%20and%20assignments%0D%0A%20%20%20%20%20%20%20%20%20type%20t1%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20real%20c%0D%0A%20%20%20%20%20%20%20%20%20end%20type%0D%0A%20%20%20%20%20%20%20%20%20type%2C%20extends%28t1%29%20%3A%3A%20t2%0D%0A%20%20%20%20%20%20%20%20%20end%20type%0D%0A%20%20%20%20%20%20%20%20%20class%28t1%29%2C%20pointer%20%3A%3A%20p%2C%20q%2C%20r%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20allocate%20%28p%2C%20q%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20allocate%20%28t2%20%3A%3A%20r%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20the%20result%20of%20SAME%5FTYPE%5FAS%20%28P%2C%20Q%29%20will%20be%20true%2C%20and%20the%20result%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20of%20SAME%5FTYPE%5FAS%20%28P%2C%20R%29%20will%20be%20false%2E%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27%28P%2CQ%29%27%2Csame%5Ftype%5Fas%28p%2Cq%29%2C%22mind%20your%20P%27s%20and%20Q%27s%22%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27%28P%2CR%29%27%2Csame%5Ftype%5Fas%28p%2Cr%29%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%20pointers%0D%0A%0D%0A%20%20%20%20%20%20%20%20end%20program%20demo%5Fsame%5Ftype%5Fas%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> same_type_as
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
        ! program demo_same_type_as
        module M_ether
        implicit none
        private

        type   :: dot
          real :: x=0
          real :: y=0
        end type dot

        type, extends(dot) :: point
          real :: z=0
        end type point

        type something_else
        end type something_else

        public :: dot
        public :: point
        public :: something_else

        end module M_ether

        program demo_same_type_as
        use M_ether, only : dot, point, something_else
        implicit none
        type(dot) :: dad, mom
        type(point) :: me
        type(something_else) :: alien

         write(*,*)same_type_as(me,dad),'I am descended from Dad, but equal?'
         write(*,*)same_type_as(me,me) ,'I am what I am'
         write(*,*)same_type_as(dad,mom) ,'what a pair!'

         write(*,*)same_type_as(dad,me),'no paradox here'
         write(*,*)same_type_as(dad,alien),'no relation'

         call pointers()
         contains
         subroutine pointers()
         ! Given the declarations and assignments
         type t1
            real c
         end type
         type, extends(t1) :: t2
         end type
         class(t1), pointer :: p, q, r
            allocate (p, q)
            allocate (t2 :: r)
            ! the result of SAME_TYPE_AS (P, Q) will be true, and the result
            ! of SAME_TYPE_AS (P, R) will be false.
            write(*,*)'(P,Q)',same_type_as(p,q),"mind your P's and Q's"
            write(*,*)'(P,R)',same_type_as(p,r)
         end subroutine pointers

        end program demo_same_type_as
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fscale%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20c%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%201%2E0%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%28scale%28x%2Ci%29%2Ci%3D1%2C5%29%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%203%2E0%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%28scale%28x%2Ci%29%2Ci%3D1%2C5%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%28scale%28log%281%2E0%29%2Ci%29%2Ci%3D1%2C5%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20on%20modern%20machines%20radix%28x%29%20is%20almost%20certainly%202%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%20178%2E1387e%2D4%0D%0A%20%20%20%20%20%20%20%20%20i%20%3D%205%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20x%2C%20i%2C%20scale%28x%2C%20i%29%2C%20x%2Aradix%28x%29%2A%2Ai%0D%0A%20%20%20%20%20%20%20%20%20%21%20x%2Aradix%28x%29%2A%2Ai%20is%20the%20same%20except%20roundoff%20errors%20are%20not%20restricted%0D%0A%20%20%20%20%20%20%20%20%20i%20%3D%202%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20x%2C%20i%2C%20scale%28x%2C%20i%29%2C%20x%2Aradix%28x%29%2A%2Ai%0D%0A%20%20%20%20%20%20%20%20%20%21%20relatively%20easy%20to%20do%20complex%20values%20as%20well%0D%0A%20%20%20%20%20%20%20%20%20c%3D%283%2E0%2C4%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20c%2C%20i%2C%20scale%5Fcomplex%28c%2C%20i%29%21%2C%20c%2Aradix%28c%29%2A%2Ai%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20function%20scale%5Fcomplex%28x%2C%20n%29%0D%0A%20%20%20%20%20%20%21%20example%20supporting%20complex%20value%20for%20default%20kinds%0D%0A%20%20%20%20%20%20complex%2C%20intent%28in%29%20%3A%3A%20x%0D%0A%20%20%20%20%20%20integer%2C%20intent%28in%29%20%3A%3A%20n%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20scale%5Fcomplex%0D%0A%20%20%20%20%20%20%20%20%20scale%5Fcomplex%3Dcmplx%28scale%28x%25re%2C%20n%29%2C%20scale%28x%25im%2C%20n%29%2C%20kind%3Dkind%28x%25im%29%29%0D%0A%20%20%20%20%20%20end%20function%20scale%5Fcomplex%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fscale%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> scale
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_scale
      implicit none
      real :: x
      complex :: c
      integer :: i
         x = 1.0
         print *, (scale(x,i),i=1,5)
         x = 3.0
         print *, (scale(x,i),i=1,5)
         print *, (scale(log(1.0),i),i=1,5)
         ! on modern machines radix(x) is almost certainly 2
         x = 178.1387e-4
         i = 5
         print *, x, i, scale(x, i), x*radix(x)**i
         ! x*radix(x)**i is the same except roundoff errors are not restricted
         i = 2
         print *, x, i, scale(x, i), x*radix(x)**i
         ! relatively easy to do complex values as well
         c=(3.0,4.0)
         print *, c, i, scale_complex(c, i)!, c*radix(c)**i
      contains
      function scale_complex(x, n)
      ! example supporting complex value for default kinds
      complex, intent(in) :: x
      integer, intent(in) :: n
      complex :: scale_complex
         scale_complex=cmplx(scale(x%re, n), scale(x%im, n), kind=kind(x%im))
      end function scale_complex
      end program demo_scale
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fscan%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20scan%28%22fortran%22%2C%20%22ao%22%29%20%20%20%20%20%20%20%20%20%20%21%202%2C%20found%20%27o%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20scan%28%22fortran%22%2C%20%22ao%22%2C%20%2Etrue%2E%29%20%20%21%206%2C%20found%20%27a%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20scan%28%22fortran%22%2C%20%22c%2B%2B%22%29%20%20%20%20%20%20%20%20%20%21%200%2C%20found%20none%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fscan%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> scan
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_scan
      implicit none
         write(*,*) scan("fortran", "ao")          ! 2, found 'o'
         write(*,*) scan("fortran", "ao", .true.)  ! 6, found 'a'
         write(*,*) scan("fortran", "c++")         ! 0, found none
      end program demo_scan
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fselected%5Fchar%5Fkind%0D%0A%20%20%20%20%20%20use%20iso%5Ffortran%5Fenv%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20intrinsic%20date%5Fand%5Ftime%2Cselected%5Fchar%5Fkind%0D%0A%0D%0A%20%20%20%20%20%20%21%20set%20some%20aliases%20for%20common%20character%20kinds%0D%0A%20%20%20%20%20%20%21%20as%20the%20numbers%20can%20vary%20from%20platform%20to%20platform%0D%0A%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20default%20%3D%20selected%5Fchar%5Fkind%20%28%22default%22%29%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20ascii%20%3D%20%20%20selected%5Fchar%5Fkind%20%28%22ascii%22%29%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20ucs4%20%20%3D%20%20%20selected%5Fchar%5Fkind%20%28%27ISO%5F10646%27%29%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20utf8%20%20%3D%20%20%20selected%5Fchar%5Fkind%20%28%27utf%2D8%27%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20assuming%20ASCII%20and%20UCS4%20are%20supported%20%28ie%2E%20not%20equal%20to%20%2D1%29%0D%0A%20%20%20%20%20%20%21%20define%20some%20string%20variables%0D%0A%20%20%20%20%20%20character%28len%3D26%2C%20kind%3Dascii%20%29%20%3A%3A%20alphabet%0D%0A%20%20%20%20%20%20character%28len%3D30%2C%20kind%3Ducs4%20%20%29%20%3A%3A%20hello%5Fworld%0D%0A%20%20%20%20%20%20character%28len%3D30%2C%20kind%3Ducs4%20%20%29%20%3A%3A%20string%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ASCII%20%20%20%20%20%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20merge%28%27Supported%20%20%20%20%27%2C%27Not%20Supported%27%2Cascii%20%2F%3D%20%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ISO%5F10646%20%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20merge%28%27Supported%20%20%20%20%27%2C%27Not%20Supported%27%2Cucs4%20%2F%3D%20%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27UTF%2D8%20%20%20%20%20%27%2C%26%0D%0A%20%20%20%20%20%20%20%20%20%20%26%20merge%28%27Supported%20%20%20%20%27%2C%27Not%20Supported%27%2Cutf8%20%2F%3D%20%2D1%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20if%28default%2Eeq%2Eascii%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ASCII%20is%20the%20default%20on%20this%20processor%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20for%20constants%20the%20kind%20precedes%20the%20value%2C%20somewhat%20like%20a%0D%0A%20%20%20%20%20%20%20%20%21%20BOZ%20constant%0D%0A%20%20%20%20%20%20%20%20%20alphabet%20%3D%20ascii%5F%22abcdefghijklmnopqrstuvwxyz%22%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20alphabet%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20hello%5Fworld%20%3D%20ucs4%5F%27Hello%20World%20and%20Ni%20Hao%20%2D%2D%20%27%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20char%20%28int%20%28z%274F60%27%29%2C%20ucs4%29%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20char%20%28int%20%28z%27597D%27%29%2C%20ucs4%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20an%20encoding%20option%20is%20required%20on%20OPEN%20for%20non%2Ddefault%20I%2FO%0D%0A%20%20%20%20%20%20%20%20%20if%28ucs4%20%2F%3D%20%2D1%20%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20open%20%28output%5Funit%2C%20encoding%3D%27UTF%2D8%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20trim%20%28hello%5Fworld%29%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20%27cannot%20use%20utf%2D8%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20create%5Fdate%5Fstring%28string%29%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%2A%29%20trim%20%28string%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20%21%20The%20following%20produces%20a%20Japanese%20date%20stamp%2E%0D%0A%20%20%20%20%20%20subroutine%20create%5Fdate%5Fstring%28string%29%0D%0A%20%20%20%20%20%20intrinsic%20date%5Fand%5Ftime%2Cselected%5Fchar%5Fkind%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20ucs4%20%3D%20selected%5Fchar%5Fkind%28%22ISO%5F10646%22%29%0D%0A%20%20%20%20%20%20character%28len%3D1%2Ckind%3Ducs4%29%2Cparameter%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20nen%20%3D%20%20%20char%28int%28%20z%275e74%27%20%29%2Cucs4%29%2C%20%26%20%21%20year%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20gatsu%20%3D%20char%28int%28%20z%276708%27%20%29%2Cucs4%29%2C%20%26%20%21%20month%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20nichi%20%3D%20char%28int%28%20z%2765e5%27%20%29%2Cucs4%29%20%20%20%20%21%20day%0D%0A%20%20%20%20%20%20character%28len%3D%20%2A%2C%20kind%3D%20ucs4%29%20string%0D%0A%20%20%20%20%20%20integer%20values%288%29%0D%0A%20%20%20%20%20%20%20%20%20call%20date%5Fand%5Ftime%28values%3Dvalues%29%0D%0A%20%20%20%20%20%20%20%20%20write%28string%2C101%29%20values%281%29%2Cnen%2Cvalues%282%29%2Cgatsu%2Cvalues%283%29%2Cnichi%0D%0A%20%20%20%20%20%20%20101%20format%28%2A%28i0%2Ca%29%29%0D%0A%20%20%20%20%20%20end%20subroutine%20create%5Fdate%5Fstring%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fselected%5Fchar%5Fkind%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> selected_char_kind
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_selected_char_kind
      use iso_fortran_env
      implicit none

      intrinsic date_and_time,selected_char_kind

      ! set some aliases for common character kinds
      ! as the numbers can vary from platform to platform

      integer, parameter :: default = selected_char_kind ("default")
      integer, parameter :: ascii =   selected_char_kind ("ascii")
      integer, parameter :: ucs4  =   selected_char_kind ('ISO_10646')
      integer, parameter :: utf8  =   selected_char_kind ('utf-8')

      ! assuming ASCII and UCS4 are supported (ie. not equal to -1)
      ! define some string variables
      character(len=26, kind=ascii ) :: alphabet
      character(len=30, kind=ucs4  ) :: hello_world
      character(len=30, kind=ucs4  ) :: string

         write(*,*)'ASCII     ',&
          & merge('Supported    ','Not Supported',ascii /= -1)
         write(*,*)'ISO_10646 ',&
          & merge('Supported    ','Not Supported',ucs4 /= -1)
         write(*,*)'UTF-8     ',&
          & merge('Supported    ','Not Supported',utf8 /= -1)

         if(default.eq.ascii)then
             write(*,*)'ASCII is the default on this processor'
         endif

        ! for constants the kind precedes the value, somewhat like a
        ! BOZ constant
         alphabet = ascii_"abcdefghijklmnopqrstuvwxyz"
         write (*,*) alphabet

         hello_world = ucs4_'Hello World and Ni Hao -- ' &
                       // char (int (z'4F60'), ucs4)     &
                       // char (int (z'597D'), ucs4)

        ! an encoding option is required on OPEN for non-default I/O
         if(ucs4 /= -1 )then
            open (output_unit, encoding='UTF-8')
            write (*,*) trim (hello_world)
         else
            write (*,*) 'cannot use utf-8'
         endif

         call create_date_string(string)
         write (*,*) trim (string)

      contains

      ! The following produces a Japanese date stamp.
      subroutine create_date_string(string)
      intrinsic date_and_time,selected_char_kind
      integer,parameter :: ucs4 = selected_char_kind("ISO_10646")
      character(len=1,kind=ucs4),parameter :: &
             nen =   char(int( z'5e74' ),ucs4), & ! year
             gatsu = char(int( z'6708' ),ucs4), & ! month
             nichi = char(int( z'65e5' ),ucs4)    ! day
      character(len= *, kind= ucs4) string
      integer values(8)
         call date_and_time(values=values)
         write(string,101) values(1),nen,values(2),gatsu,values(3),nichi
       101 format(*(i0,a))
      end subroutine create_date_string

      end program demo_selected_char_kind
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fselected%5Fint%5Fkind%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20k5%20%3D%20selected%5Fint%5Fkind%285%29%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20k15%20%3D%20selected%5Fint%5Fkind%2815%29%0D%0A%20%20%20%20%20%20integer%28kind%3Dk5%29%20%3A%3A%20i5%0D%0A%20%20%20%20%20%20integer%28kind%3Dk15%29%20%3A%3A%20i15%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20huge%28i5%29%2C%20huge%28i15%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%20%21%20the%20following%20inequalities%20are%20always%20true%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20huge%28i5%29%20%3E%3D%2010%5Fk5%2A%2A5%2D1%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20huge%28i15%29%20%3E%3D%2010%5Fk15%2A%2A15%2D1%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fselected%5Fint%5Fkind%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> selected_int_kind
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_selected_int_kind
      implicit none
      integer,parameter :: k5 = selected_int_kind(5)
      integer,parameter :: k15 = selected_int_kind(15)
      integer(kind=k5) :: i5
      integer(kind=k15) :: i15

          print *, huge(i5), huge(i15)

          ! the following inequalities are always true
          print *, huge(i5) >= 10_k5**5-1
          print *, huge(i15) >= 10_k15**15-1
      end program demo_selected_int_kind
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fselected%5Freal%5Fkind%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20p6%20%3D%20selected%5Freal%5Fkind%286%29%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20p10r100%20%3D%20selected%5Freal%5Fkind%2810%2C100%29%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20r400%20%3D%20selected%5Freal%5Fkind%28r%3D400%29%0D%0A%20%20%20%20%20%20real%28kind%3Dp6%29%20%3A%3A%20x%0D%0A%20%20%20%20%20%20real%28kind%3Dp10r100%29%20%3A%3A%20y%0D%0A%20%20%20%20%20%20real%28kind%3Dr400%29%20%3A%3A%20z%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28x%29%2C%20range%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28y%29%2C%20range%28y%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20precision%28z%29%2C%20range%28z%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fselected%5Freal%5Fkind%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> selected_real_kind
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_selected_real_kind
      implicit none
      integer,parameter :: p6 = selected_real_kind(6)
      integer,parameter :: p10r100 = selected_real_kind(10,100)
      integer,parameter :: r400 = selected_real_kind(r=400)
      real(kind=p6) :: x
      real(kind=p10r100) :: y
      real(kind=r400) :: z

         print *, precision(x), range(x)
         print *, precision(y), range(y)
         print *, precision(z), range(z)
      end program demo_selected_real_kind
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsetexp%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20x%20%3D%20178%2E1387e%2D4%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%20%3D%2017%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20set%5Fexponent%28x%2C%20i%29%2C%20fraction%28x%29%20%2A%20radix%28x%29%2A%2Ai%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsetexp%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> set_exponent
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_setexp
      implicit none
      real :: x = 178.1387e-4
      integer :: i = 17
         print *, set_exponent(x, i), fraction(x) * radix(x)**i
      end program demo_setexp
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fshape%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20all%3D%27%28%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20integer%2C%20dimension%28%2D1%3A1%2C%20%2D1%3A2%29%20%3A%3A%20a%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27shape%20of%20array%3D%27%2Cshape%28a%29%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27shape%20of%20constant%3D%27%2Cshape%2842%29%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27size%20of%20shape%20of%20constant%3D%27%2Csize%28shape%2842%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27ubound%20of%20array%3D%27%2Cubound%28a%29%0D%0A%20%20%20%20%20%20%20%20%20print%20all%2C%20%27lbound%20of%20array%3D%27%2Clbound%28a%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fshape%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> shape
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_shape
      implicit none
      character(len=*),parameter :: all='(*(g0,1x))'
      integer, dimension(-1:1, -1:2) :: a
         print all, 'shape of array=',shape(a)
         print all, 'shape of constant=',shape(42)
         print all, 'size of shape of constant=',size(shape(42))
         print all, 'ubound of array=',ubound(a)
         print all, 'lbound of array=',lbound(a)
      end program demo_shape
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fshifta%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20ival%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20oval%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%2Callocatable%20%3A%3A%20ivals%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20integer%28kind%3Dint8%29%20%20%3A%3A%20arr%282%2C2%29%3Dreshape%28%5B2%2C4%2C8%2C16%5D%2C%5B2%2C2%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29shifta%28100%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20loop%20through%20some%20interesting%20values%0D%0A%20%20%20%20%20%20%20%20%20shift%3D5%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20ivals%3D%5B%20%2D1%2C%20%2D0%2C%20%2B0%2C%20%2B1%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2201010101010101010101010101010101%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2210101010101010101010101010101010%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2200000000000000000000000000011111%22%29%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20does%20your%20platform%20distinguish%20between%20%2B0%20and%20%2D0%3F%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20the%20original%20leftmost%20bit%20is%20used%20to%20fill%20in%20the%20vacated%20bits%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2F%2C%22SHIFT%20%3D%20%20%22%2Ci0%29%27%29%20shift%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28ivals%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20ival%3Divals%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22I%20%3D%20%20%20%20%20%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%29%27%29%20ival%2Cival%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20oval%3Dshifta%28ival%2Cshift%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22RESULT%20%3D%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%29%27%29%20oval%2Coval%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%22characteristics%20of%20the%20result%20are%20the%20same%20as%20input%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%2C1x%29%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22kind%3D%22%2Ckind%28shifta%28arr%2C3%29%29%2C%20%22shape%3D%22%2Cshape%28shifta%28arr%2C3%29%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22size%3D%22%2Csize%28shifta%28arr%2C3%29%29%20%21%2C%20%22rank%3D%22%2Crank%28shifta%28arr%2C3%29%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fshifta%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> shifta
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_shifta
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer(kind=int32) :: ival
      integer             :: shift
      integer(kind=int32) :: oval
      integer(kind=int32),allocatable :: ivals(:)
      integer             :: i
      integer(kind=int8)  :: arr(2,2)=reshape([2,4,8,16],[2,2])

        ! basic usage
        write(*,*)shifta(100,3)

        ! loop through some interesting values
         shift=5

         ivals=[ -1, -0, +0, +1, &
         & int(b"01010101010101010101010101010101"), &
         & int(b"10101010101010101010101010101010"), &
         & int(b"00000000000000000000000000011111") ]

         ! does your platform distinguish between +0 and -0?
         ! note the original leftmost bit is used to fill in the vacated bits

         write(*,'(/,"SHIFT =  ",i0)') shift
         do i=1,size(ivals)
            ival=ivals(i)
            write(*,'(  "I =      ",b32.32," == ",i0)') ival,ival
            oval=shifta(ival,shift)
            write(*,'(  "RESULT = ",b32.32," == ",i0)') oval,oval
         enddo
         ! elemental
         write(*,*)"characteristics of the result are the same as input"
         write(*,'(*(g0,1x))') &
           & "kind=",kind(shifta(arr,3)), "shape=",shape(shifta(arr,3)), &
           & "size=",size(shifta(arr,3)) !, "rank=",rank(shifta(arr,3))

      end program demo_shifta
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fshiftl%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20oval%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20ival%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%2Callocatable%20%3A%3A%20ivals%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%20%27%20basic%20usage%27%0D%0A%20%20%20%20%20%20%20%20ival%3D100%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ival%2C%20shiftl%28ival%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20elemental%20%28input%20values%20may%20be%20conformant%20arrays%29%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%20%27%20elemental%27%0D%0A%0D%0A%20%20%20%20%20%20%20%21%20loop%20through%20some%20ivalues%0D%0A%20%20%20%20%20%20%20%20%20shift%3D9%0D%0A%20%20%20%20%20%20%20%20%20ivals%3D%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2201010101010101010101010101010101%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2210101010101010101010101010101010%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2211111111111111111111111111111111%22%29%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2F%2C%22SHIFT%20%3D%20%20%22%2Ci0%29%27%29%20shift%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28ivals%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20print%20initial%20value%20as%20binary%20and%20decimal%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22I%20%3D%20%20%20%20%20%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%29%27%29%20ivals%28i%29%2Civals%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20print%20shifted%20value%20as%20binary%20and%20decimal%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20oval%3Dshiftl%28ivals%28i%29%2Cshift%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22RESULT%20%3D%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%29%27%29%20oval%2Coval%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20more%20about%20elemental%0D%0A%20%20%20%20%20%20%20%20%20ELEM%20%3A%20block%0D%0A%20%20%20%20%20%20%20%20%20integer%28kind%3Dint8%29%20%20%3A%3A%20arr%282%2C2%29%3Dreshape%28%5B2%2C4%2C8%2C16%5D%2C%5B2%2C2%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%22characteristics%20of%20the%20result%20are%20the%20same%20as%20input%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%2C1x%29%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22kind%3D%22%2Ckind%28shiftl%28arr%2C3%29%29%2C%20%22shape%3D%22%2Cshape%28shiftl%28arr%2C3%29%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22size%3D%22%2Csize%28shiftl%28arr%2C3%29%29%20%21%2C%20%22rank%3D%22%2Crank%28shiftl%28arr%2C3%29%29%0D%0A%20%20%20%20%20%20%20%20%20endblock%20ELEM%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fshiftl%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> shiftl
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_shiftl
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer             :: shift
      integer(kind=int32) :: oval
      integer(kind=int32) :: ival
      integer(kind=int32),allocatable :: ivals(:)
      integer             :: i

        print *, ' basic usage'
        ival=100
        write(*,*)ival, shiftl(ival,3)

       ! elemental (input values may be conformant arrays)
        print *, ' elemental'

       ! loop through some ivalues
         shift=9
         ivals=[ &
         & int(b"01010101010101010101010101010101"), &
         & int(b"10101010101010101010101010101010"), &
         & int(b"11111111111111111111111111111111") ]

         write(*,'(/,"SHIFT =  ",i0)') shift
         do i=1,size(ivals)
            ! print initial value as binary and decimal
            write(*,'(  "I =      ",b32.32," == ",i0)') ivals(i),ivals(i)
            ! print shifted value as binary and decimal
            oval=shiftl(ivals(i),shift)
            write(*,'(  "RESULT = ",b32.32," == ",i0)') oval,oval
         enddo

        ! more about elemental
         ELEM : block
         integer(kind=int8)  :: arr(2,2)=reshape([2,4,8,16],[2,2])
         write(*,*)"characteristics of the result are the same as input"
         write(*,'(*(g0,1x))') &
           & "kind=",kind(shiftl(arr,3)), "shape=",shape(shiftl(arr,3)), &
           & "size=",size(shiftl(arr,3)) !, "rank=",rank(shiftl(arr,3))
         endblock ELEM

      end program demo_shiftl
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fshiftr%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20shift%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20oval%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20ival%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%2Callocatable%20%3A%3A%20ivals%28%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%27%20basic%20usage%27%0D%0A%20%20%20%20%20%20%20%20ival%3D100%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29ival%2C%20shiftr%28100%2C3%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%20%28input%20values%20may%20be%20conformant%20arrays%29%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%27%20elemental%27%0D%0A%20%20%20%20%20%20%20%20%20shift%3D9%0D%0A%20%20%20%20%20%20%20%20%20ivals%3D%5B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2201010101010101010101010101010101%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2210101010101010101010101010101010%22%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20int%28b%2211111111111111111111111111111111%22%29%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2F%2C%22SHIFT%20%3D%20%20%22%2Ci0%29%27%29%20shift%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28ivals%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20print%20initial%20value%20as%20binary%20and%20decimal%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22I%20%3D%20%20%20%20%20%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%29%27%29%20ivals%28i%29%2Civals%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20print%20shifted%20value%20as%20binary%20and%20decimal%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20oval%3Dshiftr%28ivals%28i%29%2Cshift%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%20%20%22RESULT%20%3D%20%22%2Cb32%2E32%2C%22%20%3D%3D%20%22%2Ci0%2C%2F%29%27%29%20oval%2Coval%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20more%20on%20elemental%0D%0A%20%20%20%20%20%20%20%20%20ELEM%20%3A%20block%0D%0A%20%20%20%20%20%20%20%20%20integer%28kind%3Dint8%29%20%20%3A%3A%20arr%282%2C2%29%3Dreshape%28%5B2%2C4%2C8%2C16%5D%2C%5B2%2C2%5D%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%22characteristics%20of%20the%20result%20are%20the%20same%20as%20input%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28g0%2C1x%29%29%27%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22kind%3D%22%2Ckind%28shiftr%28arr%2C3%29%29%2C%20%22shape%3D%22%2Cshape%28shiftr%28arr%2C3%29%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%26%20%22size%3D%22%2Csize%28shiftr%28arr%2C3%29%29%20%21%2C%20%22rank%3D%22%2Crank%28shiftr%28arr%2C3%29%29%0D%0A%20%20%20%20%20%20%20%20%20endblock%20ELEM%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fshiftr%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> shiftr
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_shiftr
      use,intrinsic :: iso_fortran_env, only : int8, int16, int32, int64
      implicit none
      integer             :: shift
      integer(kind=int32) :: oval
      integer(kind=int32) :: ival
      integer(kind=int32),allocatable :: ivals(:)
      integer             :: i

        print *,' basic usage'
        ival=100
        write(*,*)ival, shiftr(100,3)

        ! elemental (input values may be conformant arrays)
        print *,' elemental'
         shift=9
         ivals=[ &
         & int(b"01010101010101010101010101010101"), &
         & int(b"10101010101010101010101010101010"), &
         & int(b"11111111111111111111111111111111") ]

         write(*,'(/,"SHIFT =  ",i0)') shift
         do i=1,size(ivals)
            ! print initial value as binary and decimal
            write(*,'(  "I =      ",b32.32," == ",i0)') ivals(i),ivals(i)
            ! print shifted value as binary and decimal
            oval=shiftr(ivals(i),shift)
            write(*,'(  "RESULT = ",b32.32," == ",i0,/)') oval,oval
         enddo

         ! more on elemental
         ELEM : block
         integer(kind=int8)  :: arr(2,2)=reshape([2,4,8,16],[2,2])
         write(*,*)"characteristics of the result are the same as input"
         write(*,'(*(g0,1x))') &
           & "kind=",kind(shiftr(arr,3)), "shape=",shape(shiftr(arr,3)), &
           & "size=",size(shiftr(arr,3)) !, "rank=",rank(shiftr(arr,3))
         endblock ELEM

      end program demo_shiftr
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsign%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2D12%2C%20%201%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2D12%2C%20%200%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2D12%2C%20%2D1%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2012%2C%20%201%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2012%2C%20%200%20%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20sign%28%20%2012%2C%20%2D1%20%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20if%28sign%281%2E0%2C%2D0%2E0%29%3D%3D%20%2D1%2E0%29then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27this%20processor%20distinguishes%20%2B0%20from%20%2D0%27%0D%0A%20%20%20%20%20%20%20%20%20else%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27this%20processor%20does%20not%20distinguish%20%2B0%20from%20%2D0%27%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20%27elemental%27%2C%20sign%28%20%2D12%2E0%2C%20%5B1%2E0%2C%200%2E0%2C%20%2D1%2E0%5D%20%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsign%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> sign
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_sign
      implicit none
        ! basics
         print *,  sign( -12,  1 )
         print *,  sign( -12,  0 )
         print *,  sign( -12, -1 )
         print *,  sign(  12,  1 )
         print *,  sign(  12,  0 )
         print *,  sign(  12, -1 )

         if(sign(1.0,-0.0)== -1.0)then
            print *, 'this processor distinguishes +0 from -0'
         else
            print *, 'this processor does not distinguish +0 from -0'
         endif

         print *,  'elemental', sign( -12.0, [1.0, 0.0, -1.0] )

      end program demo_sign
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsin%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%20%3A%3A%20d%0D%0A%20%20%20%20%20%20%20%20%20%20d%20%3D%20haversine%2836%2E12%2C%2D86%2E67%2C%2033%2E94%2C%2D118%2E40%29%20%21%20BNA%20to%20LAX%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%27%28A%2CF9%2E4%2CA%29%27%2C%20%27distance%3A%20%27%2Cd%2C%27%20km%27%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20function%20haversine%28latA%2ClonA%2ClatB%2ClonB%29%20result%20%28dist%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20calculate%20great%20circle%20distance%20in%20kilometers%0D%0A%20%20%20%20%20%20%21%20given%20latitude%20and%20longitude%20in%20degrees%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20real%2Cintent%28in%29%20%3A%3A%20latA%2ClonA%2ClatB%2ClonB%0D%0A%20%20%20%20%20%20real%20%3A%3A%20a%2Cc%2Cdist%2Cdelta%5Flat%2Cdelta%5Flon%2Clat1%2Clat2%0D%0A%20%20%20%20%20%20real%2Cparameter%20%3A%3A%20radius%20%3D%206371%20%21%20mean%20earth%20radius%20in%20kilometers%2C%0D%0A%20%20%20%20%20%20%21%20recommended%20by%20the%20International%20Union%20of%20Geodesy%20and%20Geophysics%0D%0A%0D%0A%20%20%20%20%20%20%21%20generate%20constant%20pi%2F180%0D%0A%20%20%20%20%20%20real%2C%20parameter%20%3A%3A%20deg%5Fto%5Frad%20%3D%20atan%281%2E0%29%2F45%2E0%0D%0A%20%20%20%20%20%20%20%20%20delta%5Flat%20%3D%20deg%5Fto%5Frad%2A%28latB%2DlatA%29%0D%0A%20%20%20%20%20%20%20%20%20delta%5Flon%20%3D%20deg%5Fto%5Frad%2A%28lonB%2DlonA%29%0D%0A%20%20%20%20%20%20%20%20%20lat1%20%3D%20deg%5Fto%5Frad%2A%28latA%29%0D%0A%20%20%20%20%20%20%20%20%20lat2%20%3D%20deg%5Fto%5Frad%2A%28latB%29%0D%0A%20%20%20%20%20%20%20%20%20a%20%3D%20%28sin%28delta%5Flat%2F2%29%29%2A%2A2%20%2B%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20cos%28lat1%29%2Acos%28lat2%29%2A%28sin%28delta%5Flon%2F2%29%29%2A%2A2%0D%0A%20%20%20%20%20%20%20%20%20c%20%3D%202%2Aasin%28sqrt%28a%29%29%0D%0A%20%20%20%20%20%20%20%20%20dist%20%3D%20radius%2Ac%0D%0A%20%20%20%20%20%20end%20function%20haversine%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsin%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> sin
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_sin
      implicit none
      real :: d
          d = haversine(36.12,-86.67, 33.94,-118.40) ! BNA to LAX
          print '(A,F9.4,A)', 'distance: ',d,' km'
      contains
      function haversine(latA,lonA,latB,lonB) result (dist)
      !
      ! calculate great circle distance in kilometers
      ! given latitude and longitude in degrees
      !
      real,intent(in) :: latA,lonA,latB,lonB
      real :: a,c,dist,delta_lat,delta_lon,lat1,lat2
      real,parameter :: radius = 6371 ! mean earth radius in kilometers,
      ! recommended by the International Union of Geodesy and Geophysics

      ! generate constant pi/180
      real, parameter :: deg_to_rad = atan(1.0)/45.0
         delta_lat = deg_to_rad*(latB-latA)
         delta_lon = deg_to_rad*(lonB-lonA)
         lat1 = deg_to_rad*(latA)
         lat2 = deg_to_rad*(latB)
         a = (sin(delta_lat/2))**2 + &
                & cos(lat1)*cos(lat2)*(sin(delta_lon/2))**2
         c = 2*asin(sqrt(a))
         dist = radius*c
      end function haversine
      end program demo_sin
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsinh%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%26%20real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%20%2D%201%2E0%5Freal64%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20nan%2C%20inf%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%3A%3A%20line%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20sinh%28x%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%28exp%28x%29%2Dexp%28%2Dx%29%29%2F2%2E0%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20sinh%283%29%20is%20elemental%20and%20can%20handle%20an%20array%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20sinh%28%5Bx%2C2%2E0%2Ax%2Cx%2F3%2E0%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20NaN%20input%20returns%20NaN%0D%0A%20%20%20%20%20%20%20%20%20line%3D%27NAN%27%0D%0A%20%20%20%20%20%20%20%20%20read%28line%2C%2A%29%20nan%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20sinh%28nan%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20Inf%20input%20returns%20Inf%0D%0A%20%20%20%20%20%20%20%20%20line%3D%27Infinity%27%0D%0A%20%20%20%20%20%20%20%20%20read%28line%2C%2A%29%20inf%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20sinh%28inf%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20an%20overflow%20returns%20Inf%0D%0A%20%20%20%20%20%20%20%20%20x%3Dhuge%280%2E0d0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20sinh%28x%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsinh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> sinh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_sinh
      use, intrinsic :: iso_fortran_env, only : &
      & real_kinds, real32, real64, real128
      implicit none
      real(kind=real64) :: x = - 1.0_real64
      real(kind=real64) :: nan, inf
      character(len=20) :: line

        ! basics
         print *, sinh(x)
         print *, (exp(x)-exp(-x))/2.0

        ! sinh(3) is elemental and can handle an array
         print *, sinh([x,2.0*x,x/3.0])

         ! a NaN input returns NaN
         line='NAN'
         read(line,*) nan
         print *, sinh(nan)

         ! a Inf input returns Inf
         line='Infinity'
         read(line,*) inf
         print *, sinh(inf)

         ! an overflow returns Inf
         x=huge(0.0d0)
         print *, sinh(x)

      end program demo_sinh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsize%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20arr%280%3A2%2C%2D5%3A5%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%20of%20simple%20two%2Ddimensional%20array%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr%29%20%20%20%20%20%20%20%3Atotal%20count%20of%20elements%3A%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr%2CDIM%3D1%29%20%3Anumber%20of%20rows%20%20%20%20%20%20%20%20%20%3A%27%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr%2CDIM%3D2%29%20%3Anumber%20of%20columns%20%20%20%20%20%20%3A%27%2Csize%28arr%2Cdim%3D2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20pass%20the%20same%20array%20to%20a%20procedure%20that%20passes%20the%20value%20two%0D%0A%20%20%20%20%20%20%20%20%20%21%20different%20ways%0D%0A%20%20%20%20%20%20%20%20%20call%20interfaced%28arr%2Carr%29%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20interfaced%28arr1%2Carr2%29%0D%0A%20%20%20%20%20%20%21%20notice%20the%20difference%20in%20the%20array%20specification%0D%0A%20%20%20%20%20%20%21%20for%20arr1%20and%20arr2%2E%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr1%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr2%282%2C%2A%29%0D%0A%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27interfaced%20assumed%2Dshape%20array%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr1%29%20%20%20%20%20%20%20%20%3A%27%2Csize%28arr1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr1%2CDIM%3D1%29%20%20%3A%27%2Csize%28arr1%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr1%2CDIM%3D2%29%20%20%3A%27%2Csize%28arr1%2Cdim%3D2%29%0D%0A%0D%0A%20%20%20%20%20%20%21%20%20write%28%2A%2C%2A%29%27SIZE%28arr2%29%20%20%20%20%20%20%20%20%3A%27%2Csize%28arr2%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27SIZE%28arr2%2CDIM%3D1%29%20%20%3A%27%2Csize%28arr2%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%21%20CANNOT%20DETERMINE%20SIZE%20OF%20ASSUMED%20SIZE%20ARRAY%20LAST%20DIMENSION%0D%0A%20%20%20%20%20%20%21%20%20write%28%2A%2C%2A%29%27SIZE%28arr2%2CDIM%3D2%29%20%20%3A%27%2Csize%28arr2%2Cdim%3D2%29%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20interfaced%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsize%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> size
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_size
      implicit none
      integer :: arr(0:2,-5:5)
         write(*,*)'SIZE of simple two-dimensional array'
         write(*,*)'SIZE(arr)       :total count of elements:',size(arr)
         write(*,*)'SIZE(arr,DIM=1) :number of rows         :',size(arr,dim=1)
         write(*,*)'SIZE(arr,DIM=2) :number of columns      :',size(arr,dim=2)

         ! pass the same array to a procedure that passes the value two
         ! different ways
         call interfaced(arr,arr)
      contains

      subroutine interfaced(arr1,arr2)
      ! notice the difference in the array specification
      ! for arr1 and arr2.
      integer,intent(in) :: arr1(:,:)
      integer,intent(in) :: arr2(2,*)
         !
         write(*,*)'interfaced assumed-shape array'
         write(*,*)'SIZE(arr1)        :',size(arr1)
         write(*,*)'SIZE(arr1,DIM=1)  :',size(arr1,dim=1)
         write(*,*)'SIZE(arr1,DIM=2)  :',size(arr1,dim=2)

      !  write(*,*)'SIZE(arr2)        :',size(arr2)
         write(*,*)'SIZE(arr2,DIM=1)  :',size(arr2,dim=1)
      !
      ! CANNOT DETERMINE SIZE OF ASSUMED SIZE ARRAY LAST DIMENSION
      !  write(*,*)'SIZE(arr2,DIM=2)  :',size(arr2,dim=2)

      end subroutine interfaced

      end program demo_size
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fspacing%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20sgl%20%3D%20selected%5Freal%5Fkind%28p%3D6%2C%20r%3D37%29%0D%0A%20%20%20%20%20%20integer%2C%20parameter%20%3A%3A%20dbl%20%3D%20selected%5Freal%5Fkind%28p%3D13%2C%20r%3D200%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20spacing%281%2E0%5Fsgl%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20nearest%281%2E0%5Fsgl%2C%2B1%2E0%29%2Cnearest%281%2E0%5Fsgl%2C%2B1%2E0%29%2D1%2E0%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20spacing%281%2E0%5Fdbl%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fspacing%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> spacing
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_spacing
      implicit none
      integer, parameter :: sgl = selected_real_kind(p=6, r=37)
      integer, parameter :: dbl = selected_real_kind(p=13, r=200)

         write(*,*) spacing(1.0_sgl)
         write(*,*) nearest(1.0_sgl,+1.0),nearest(1.0_sgl,+1.0)-1.0

         write(*,*) spacing(1.0_dbl)
      end program demo_spacing
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fspread%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20integer%20a1%284%2C3%29%2C%20a2%283%2C4%29%2C%20v%284%29%2C%20s%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%20%29%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27TEST%20SPREAD%283%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%20SPREAD%283%29%20is%20a%20FORTRAN90%20function%20which%20replicates%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%20an%20array%20by%20adding%20a%20dimension%2E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%27%20%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20s%20%3D%2099%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27suppose%20we%20have%20a%20scalar%20S%27%2Cs%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27to%20add%20a%20new%20dimension%20%281%29%20of%20extent%204%20call%27%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27spread%28%20s%2C%20dim%3D1%2C%20ncopies%3D4%20%29%27%2Cspread%20%28%20s%2C%201%2C%204%20%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20v%20%3D%20%5B%201%2C%202%2C%203%2C%204%20%5D%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%20first%20we%20will%20set%20V%20to%27%2Cv%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%27%20and%20then%20do%20%22spread%20%28%20v%2C%20dim%3D2%2C%20ncopies%3D3%20%29%22%27%0D%0A%20%20%20%20%20%20%20%20%20a1%20%3D%20spread%20%28%20v%2C%20dim%3D2%2C%20ncopies%3D3%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27uses%20v%20as%20a%20column%20and%20makes%203%20columns%27%2Ca1%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20a2%20%3D%20spread%20%28%20v%2C%201%2C%203%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27%20spread%28v%2C1%2C3%29%20uses%20v%20as%20a%20row%20and%20makes%203%20rows%27%2Ca2%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%20CONVENIENCE%20ROUTINE%3B%20NOT%20DIRECTLY%20CONNECTED%20TO%20SPREAD%283%29%0D%0A%20%20%20%20%20%20subroutine%20printi%28title%2Ca%29%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20stderr%3D%3EERROR%5FUNIT%2C%26%0D%0A%20%20%20%20%20%20%20%26%20stdin%3D%3EINPUT%5FUNIT%2C%20stdout%3D%3EOUTPUT%5FUNIT%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20scalar%2C%20vector%2C%20matrix%20in%20row%2Dcolumn%20format%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20all%3D%27%28%22%20%22%2C%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20row%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%28%2E%2E%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%2Cadvance%3D%27no%27%29trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20select%20rank%20of%20input%0D%0A%20%20%20%20%20%20%20%20%20select%20rank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%280%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20scalar%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%3E%20%5B%20%22%2Ci0%2C%22%20%5D%22%29%27%29a%0D%0A%20%20%20%20%20%20%20%20%20rank%20%281%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20vector%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28row%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28a%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28row%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29a%28i%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20rank%20%282%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20matrix%29%20%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28row%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28a%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28row%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28a%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29a%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20rank%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28stderr%2C%2A%29%27%2Aprinti%2A%20did%20not%20expect%20rank%3D%27%2C%20rank%28a%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27shape%3D%27%2C%20shape%28a%29%2C%27size%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20stop%20%27%2Aprinti%2A%20unexpected%20rank%27%0D%0A%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%29%20%27%3Eshape%3D%27%2Cshape%28a%29%2C%27%2Crank%3D%27%2Crank%28a%29%2C%27%2Csize%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%0D%0A%20%20%20%20%20%20end%20subroutine%20printi%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fspread%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> spread
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_spread
      implicit none

      integer a1(4,3), a2(3,4), v(4), s

         write(*,'(a)' ) &
         'TEST SPREAD(3)                                      ', &
         '  SPREAD(3) is a FORTRAN90 function which replicates', &
         '  an array by adding a dimension.                   ', &
         ' '

         s = 99
         call printi('suppose we have a scalar S',s)

         write(*,*) 'to add a new dimension (1) of extent 4 call'
         call printi('spread( s, dim=1, ncopies=4 )',spread ( s, 1, 4 ))

         v = [ 1, 2, 3, 4 ]
         call printi(' first we will set V to',v)

         write(*,'(a)')' and then do "spread ( v, dim=2, ncopies=3 )"'
         a1 = spread ( v, dim=2, ncopies=3 )
         call printi('uses v as a column and makes 3 columns',a1)

         a2 = spread ( v, 1, 3 )
         call printi(' spread(v,1,3) uses v as a row and makes 3 rows',a2)

      contains
      ! CONVENIENCE ROUTINE; NOT DIRECTLY CONNECTED TO SPREAD(3)
      subroutine printi(title,a)
      use, intrinsic :: iso_fortran_env, only : stderr=>ERROR_UNIT,&
       & stdin=>INPUT_UNIT, stdout=>OUTPUT_UNIT
      implicit none

      !@(#) print small 2d integer scalar, vector, matrix in row-column format

      character(len=*),parameter   :: all='(" ",*(g0,1x))'
      character(len=*),intent(in)  :: title
      character(len=20)            :: row
      integer,intent(in)           :: a(..)
      integer                      :: i

         write(*,all,advance='no')trim(title)
         ! select rank of input
         select rank(a)
         rank (0); write(*,'(a)')' (a scalar)'
            write(*,'(" > [ ",i0," ]")')a
         rank (1); write(*,'(a)')' (a vector)'
            ! find how many characters to use for integers
            write(row,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(a))))))+2
            ! use this format to write a row
            row='(" > [",*(i'//trim(row)//':,","))'
            do i=1,size(a)
               write(*,fmt=row,advance='no')a(i)
               write(*,'(" ]")')
            enddo
         rank (2); write(*,'(a)')' (a matrix) '
            ! find how many characters to use for integers
            write(row,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(a))))))+2
            ! use this format to write a row
            row='(" > [",*(i'//trim(row)//':,","))'
            do i=1,size(a,dim=1)
               write(*,fmt=row,advance='no')a(i,:)
               write(*,'(" ]")')
            enddo
         rank default
            write(stderr,*)'*printi* did not expect rank=', rank(a), &
             & 'shape=', shape(a),'size=',size(a)
            stop '*printi* unexpected rank'
         end select
         write(*,all) '>shape=',shape(a),',rank=',rank(a),',size=',size(a)
         write(*,*)

      end subroutine printi

      end program demo_spread
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsqrt%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%2C%20x2%0D%0A%20%20%20%20%20%20complex%20%3A%3A%20z%2C%20z2%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20x%20%3D%202%2E0%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%21%20complex%0D%0A%20%20%20%20%20%20%20%20%20z%20%3D%20%281%2E0%2C%202%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27input%20values%20%27%2Cx%2Cz%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20x2%20%3D%20sqrt%28x%29%0D%0A%20%20%20%20%20%20%20%20%20z2%20%3D%20sqrt%28z%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27output%20values%20%27%2Cx2%2Cz2%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27elemental%27%2Csqrt%28%5B64%2E0%2C121%2E0%2C30%2E0%5D%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20alternatives%0D%0A%20%20%20%20%20%20%20%20%20x2%20%3D%20x%2A%2A0%2E5%0D%0A%20%20%20%20%20%20%20%20%20z2%20%3D%20z%2A%2A0%2E5%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27alternatively%27%2Cx2%2Cz2%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsqrt%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> sqrt
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_sqrt
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
       & real32, real64, real128
      implicit none
      real(kind=real64) :: x, x2
      complex :: z, z2

        ! basics
         x = 2.0_real64
         ! complex
         z = (1.0, 2.0)
         write(*,*)'input values ',x,z

         x2 = sqrt(x)
         z2 = sqrt(z)
         write(*,*)'output values ',x2,z2

        ! elemental
        write(*,*)'elemental',sqrt([64.0,121.0,30.0])

        ! alternatives
         x2 = x**0.5
         z2 = z**0.5
         write(*,*)'alternatively',x2,z2

      end program demo_sqrt
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%20%20%20program%20demo%5Fstop%0D%0A%20%20%20%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20stderr%3D%3EERROR%5FUNIT%0D%0A%20%20%20%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20integer%20%3A%3A%20stopcode%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20message%0D%0A%20%20%20%20%20%20%20%20%20character%28len%3D20%29%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20which%0D%0A%20%20%20%20%20%20%20%20%20INFINITE%3A%20do%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%21%20Normal%20terminations%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28a%29%27%29%27enter%20a%20stop%20type%3A%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27%7Bbasic%2C%20text%2C%20zero%2C%20nonzero%2C%20variable%2C%20expression%7D%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%27%7Berror%2C%20errornum%2C%20errorstring%7D%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20read%28%2A%2C%27%28a%29%27%29which%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20select%20case%28which%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20normal%20terminations%3A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20A%20STOP%20with%20no%20non%2Dzero%20numeric%20parameter%20is%20a%20normal%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20termination%20and%20generally%20returns%20a%20zero%20status%20value%20if%20the%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20system%20supports%20return%20statuses%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27basic%27%29%3B%20stop%20%20%20%20%21%20usually%20displays%20nothing%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27zero%27%29%3B%20%20stop%200%20%20%21%20sometimes%20displays%20%22STOP%200%22%20or%20%220%22%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27text%27%29%3B%20%20stop%20%27That%20is%20all%2C%20folks%21%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20All%20other%20stops%20are%20generally%20used%20to%20indicate%20an%20error%20or%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20special%20exit%20type%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27nonzero%27%29%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stop%2010%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27variable%27%29%3B%20stopcode%3D11%3B%20%20%20stop%20stopcode%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27expression%27%29%3B%20stopcode%3D11%3B%20stop%20110%2Fstopcode%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27string%27%29%3B%20message%3D%27oops%27%3B%20%20stop%20%27ERROR%3A%5B%27%2F%2Fmessage%2F%2F%27%5D%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20Error%20terminations%3A%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20ERROR%20STOP%20is%20always%20an%20error%20stop%2C%20even%20without%20a%20stop%2Dcode%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20ERROR%20STOP%20often%20displays%20a%20traceback%20but%20that%20is%20not%20required%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27error%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error%20stop%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27errornum%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20stopcode%3D10%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error%20stop%20stopcode%2B3%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%28%27errorstring%27%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20message%3D%27That%20is%20all%2C%20folks%21%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error%20stop%20%27ERROR%3A%27%2F%2Fmessage%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20default%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27try%20again%20%2E%2E%2E%27%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20enddo%20INFINITE%0D%0A%20%20%20%20%20%20%20%20%20end%20program%20demo%5Fstop%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> stop
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
         program demo_stop
         use, intrinsic :: iso_fortran_env, only : stderr=>ERROR_UNIT
         implicit none
         integer :: stopcode
         character(len=:),allocatable :: message
         character(len=20)            :: which
         INFINITE: do
            ! Normal terminations
            write(*,'(a)')'enter a stop type:', &
                    & '{basic, text, zero, nonzero, variable, expression}', &
                    & '{error, errornum, errorstring}'
            read(*,'(a)')which
            select case(which)
               ! normal terminations:
               ! A STOP with no non-zero numeric parameter is a normal
               ! termination and generally returns a zero status value if the
               ! system supports return statuses
            case('basic'); stop    ! usually displays nothing
            case('zero');  stop 0  ! sometimes displays "STOP 0" or "0"
            case('text');  stop 'That is all, folks!'
               !
               ! All other stops are generally used to indicate an error or
               ! special exit type
            case('nonzero');                 stop 10
            case('variable'); stopcode=11;   stop stopcode
            case('expression'); stopcode=11; stop 110/stopcode
            case('string'); message='oops';  stop 'ERROR:['//message//']'
               ! Error terminations:
               ! ERROR STOP is always an error stop, even without a stop-code
               ! ERROR STOP often displays a traceback but that is not required
            case('error')
               error stop
            case('errornum')
               stopcode=10
               error stop stopcode+3
            case('errorstring')
               message='That is all, folks!'
               error stop 'ERROR:'//message
            case default
               write(*,*)'try again ...'
            end select
         enddo INFINITE
         end program demo_stop
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fstorage%5Fsize%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20default%20real%2C%20integer%2C%20and%20logical%20are%20the%20same%20storage%20size%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27size%20of%20integer%20%20%20%20%20%20%20%27%2Cstorage%5Fsize%280%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27size%20of%20real%20%20%20%20%20%20%20%20%20%20%27%2Cstorage%5Fsize%280%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27size%20of%20logical%20%20%20%20%20%20%20%27%2Cstorage%5Fsize%28%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27size%20of%20complex%20%20%20%20%20%20%20%27%2Cstorage%5Fsize%28%280%2E0%2C0%2E0%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20note%20the%20size%20of%20an%20element%20of%20the%20array%2C%20not%20the%20storage%20size%20of%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20entire%20array%20is%20returned%20for%20array%20arguments%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27size%20of%20integer%20array%20%27%2Cstorage%5Fsize%28%5B0%2C1%2C2%2C3%2C4%2C5%2C6%2C7%2C8%2C9%5D%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fstorage%5Fsize%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> storage_size
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_storage_size
      implicit none

         ! a default real, integer, and logical are the same storage size
         write(*,*)'size of integer       ',storage_size(0)
         write(*,*)'size of real          ',storage_size(0.0)
         write(*,*)'size of logical       ',storage_size(.true.)
         write(*,*)'size of complex       ',storage_size((0.0,0.0))

         ! note the size of an element of the array, not the storage size of
         ! the entire array is returned for array arguments
         write(*,*)'size of integer array ',storage_size([0,1,2,3,4,5,6,7,8,9])

      end program demo_storage_size
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsum%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20vector%285%29%20%2C%20matrix%283%2C4%29%2C%20box%285%2C6%2C7%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20vector%20%3D%20%5B%201%2C%202%2C%20%2D3%2C%204%2C%205%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20matrix%281%2C%3A%29%3D%5B%20%20%2D1%2C%20%20%202%2C%20%20%20%20%2D3%2C%20%20%204%20%20%20%20%5D%0D%0A%20%20%20%20%20%20%20%20%20matrix%282%2C%3A%29%3D%5B%20%2010%2C%20%20%20%2D20%2C%20%2030%2C%20%20%20%2D40%20%20%5D%0D%0A%20%20%20%20%20%20%20%20%20matrix%283%2C%3A%29%3D%5B%20%20100%2C%20%20200%2C%20%2D300%2C%20%20400%20%20%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20box%3D11%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27sum%20all%20elements%3A%27%2Csum%28vector%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27real%20%3A%27%2Csum%28%5B11%2E0%2C%2D5%2E0%2C20%2E0%5D%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27complex%20%3A%27%2Csum%28%5B%281%2E1%2C%2D3%2E3%29%2C%284%2E0%2C5%2E0%29%2C%288%2E0%2C%2D6%2E0%29%5D%29%0D%0A%20%20%20%20%20%20%20%20%21%20with%20MASK%20option%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27sum%20odd%20elements%3A%27%2Csum%28vector%2C%20mask%3Dmod%28vector%2C%202%29%3D%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27sum%20positive%20values%3A%27%2C%20sum%28vector%2C%20mask%3Dvector%3E0%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27the%20input%20array%27%2C%20matrix%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20all%20elements%20in%20matrix%27%2C%20sum%28matrix%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20positive%20elements%27%2C%20sum%28matrix%2Cmatrix%3E%3D0%29%20%29%0D%0A%20%20%20%20%20%20%20%20%21%20along%20dimensions%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20along%20rows%27%2C%20sum%28matrix%2Cdim%3D1%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20along%20columns%27%2C%20sum%28matrix%2Cdim%3D2%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20a%20vector%20is%20always%20a%20scalar%27%2C%20sum%28vector%2Cdim%3D1%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20a%20volume%20by%20row%27%2C%20sum%28box%2Cdim%3D1%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20a%20volume%20by%20column%27%2C%20sum%28box%2Cdim%3D2%29%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20printi%28%27sum%20of%20a%20volume%20by%20depth%27%2C%20sum%28box%2Cdim%3D3%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20%21%20CONVENIENCE%20ROUTINE%3B%20NOT%20DIRECTLY%20CONNECTED%20TO%20SPREAD%283%29%0D%0A%20%20%20%20%20%20subroutine%20printi%28title%2Ca%29%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20stderr%3D%3EERROR%5FUNIT%2C%26%0D%0A%20%20%20%20%20%20%20%26%20stdin%3D%3EINPUT%5FUNIT%2C%20stdout%3D%3EOUTPUT%5FUNIT%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%40%28%23%29%20print%20small%202d%20integer%20scalar%2C%20vector%2C%20matrix%20in%20row%2Dcolumn%20format%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20a%28%2E%2E%29%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%20%20%3A%3A%20all%3D%27%28%22%20%22%2C%2A%28g0%2C1x%29%29%27%0D%0A%20%20%20%20%20%20character%28len%3D20%29%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20row%0D%0A%20%20%20%20%20%20integer%2Callocatable%20%20%20%20%20%20%20%20%20%20%3A%3A%20b%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%2Cadvance%3D%27no%27%29trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20copy%20everything%20to%20a%20matrix%20to%20keep%20code%20simple%0D%0A%20%20%20%20%20%20%20%20%20select%20rank%28a%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%280%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20scalar%29%27%3B%20b%3Dreshape%28%5Ba%5D%2C%5B1%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%281%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20vector%29%27%3B%20b%3Dreshape%28a%2C%5Bsize%28a%29%2C1%5D%29%0D%0A%20%20%20%20%20%20%20%20%20rank%20%282%29%3B%20write%28%2A%2C%27%28a%29%27%29%27%20%28a%20matrix%29%27%3B%20b%3Da%0D%0A%20%20%20%20%20%20%20%20%20rank%20default%3B%20stop%20%27%2Aprinti%2A%20unexpected%20rank%27%0D%0A%20%20%20%20%20%20%20%20%20end%20select%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28row%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28b%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20row%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28row%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28b%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Drow%2Cadvance%3D%27no%27%29b%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2Call%29%20%27%3Eshape%3D%27%2Cshape%28a%29%2C%27%2Crank%3D%27%2Crank%28a%29%2C%27%2Csize%3D%27%2Csize%28a%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%0D%0A%20%20%20%20%20%20end%20subroutine%20printi%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsum%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> sum
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_sum
      implicit none
      integer :: vector(5) , matrix(3,4), box(5,6,7)

         vector = [ 1, 2, -3, 4, 5 ]

         matrix(1,:)=[  -1,   2,    -3,   4    ]
         matrix(2,:)=[  10,   -20,  30,   -40  ]
         matrix(3,:)=[  100,  200, -300,  400  ]

         box=11

        ! basics
         print *, 'sum all elements:',sum(vector)
         print *, 'real :',sum([11.0,-5.0,20.0])
         print *, 'complex :',sum([(1.1,-3.3),(4.0,5.0),(8.0,-6.0)])
        ! with MASK option
         print *, 'sum odd elements:',sum(vector, mask=mod(vector, 2)==1)
         print *, 'sum positive values:', sum(vector, mask=vector>0)

         call printi('the input array', matrix )
         call printi('sum of all elements in matrix', sum(matrix) )
         call printi('sum of positive elements', sum(matrix,matrix>=0) )
        ! along dimensions
         call printi('sum along rows', sum(matrix,dim=1) )
         call printi('sum along columns', sum(matrix,dim=2) )
         call printi('sum of a vector is always a scalar', sum(vector,dim=1) )
         call printi('sum of a volume by row', sum(box,dim=1) )
         call printi('sum of a volume by column', sum(box,dim=2) )
         call printi('sum of a volume by depth', sum(box,dim=3) )

      contains
      ! CONVENIENCE ROUTINE; NOT DIRECTLY CONNECTED TO SPREAD(3)
      subroutine printi(title,a)
      use, intrinsic :: iso_fortran_env, only : stderr=>ERROR_UNIT,&
       & stdin=>INPUT_UNIT, stdout=>OUTPUT_UNIT
      implicit none

      !@(#) print small 2d integer scalar, vector, matrix in row-column format

      character(len=*),intent(in)  :: title
      integer,intent(in)           :: a(..)

      character(len=*),parameter   :: all='(" ",*(g0,1x))'
      character(len=20)            :: row
      integer,allocatable          :: b(:,:)
      integer                      :: i
         write(*,all,advance='no')trim(title)
         ! copy everything to a matrix to keep code simple
         select rank(a)
         rank (0); write(*,'(a)')' (a scalar)'; b=reshape([a],[1,1])
         rank (1); write(*,'(a)')' (a vector)'; b=reshape(a,[size(a),1])
         rank (2); write(*,'(a)')' (a matrix)'; b=a
         rank default; stop '*printi* unexpected rank'
         end select
         ! find how many characters to use for integers
         write(row,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(b))))))+2
         ! use this format to write a row
         row='(" > [",*(i'//trim(row)//':,","))'
         do i=1,size(b,dim=1)
            write(*,fmt=row,advance='no')b(i,:)
            write(*,'(" ]")')
         enddo
         write(*,all) '>shape=',shape(a),',rank=',rank(a),',size=',size(a)
         write(*,*)
      end subroutine printi
      end program demo_sum
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fsystem%5Fclock%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%3A%20wp%20%3D%3E%20real64%2C%20int32%2C%20int64%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2C%20parameter%20%3A%3A%20g%20%3D%20%27%281x%2C%2A%28g0%2C1x%29%29%27%0D%0A%0D%0A%20%20%20%20%20%20integer%28kind%3Dint64%29%20%3A%3A%20count64%2C%20count%5Frate64%2C%20count%5Fmax64%0D%0A%20%20%20%20%20%20integer%28kind%3Dint64%29%20%3A%3A%20start64%2C%20finish64%0D%0A%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20count32%2C%20count%5Frate32%2C%20count%5Fmax32%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20start32%2C%20finish32%0D%0A%0D%0A%20%20%20%20%20%20real%28kind%3Dwp%29%20%20%20%20%20%20%20%3A%3A%20time%5Fread%0D%0A%20%20%20%20%20%20real%28kind%3Dwp%29%20%20%20%20%20%20%20%3A%3A%20sum%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27accuracy%20may%20vary%20with%20argument%20type%21%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27query%20all%20arguments%27%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20system%5Fclock%28count64%2C%20count%5Frate64%2C%20count%5Fmax64%29%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27COUNT%5FMAX%2864bit%29%3D%27%2C%20count%5Fmax64%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27COUNT%5FRATE%2864bit%29%3D%27%2C%20count%5Frate64%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27CURRENT%20COUNT%2864bit%29%3D%27%2C%20count64%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20system%5Fclock%28count32%2C%20count%5Frate32%2C%20count%5Fmax32%29%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27COUNT%5FMAX%2832bit%29%3D%27%2C%20count%5Fmax32%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27COUNT%5FRATE%2832bit%29%3D%27%2C%20count%5Frate32%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27CURRENT%20COUNT%2832bit%29%3D%27%2C%20count32%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27time%20some%20computation%27%0D%0A%20%20%20%20%20%20%20%20%20call%20system%5Fclock%28start64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20some%20code%20to%20time%0D%0A%20%20%20%20%20%20%20%20%20sum%20%3D%200%2E0%5Fwp%0D%0A%20%20%20%20%20%20%20%20%20do%20i%20%3D%20%2D0%2C%20huge%280%29%20%2D%201%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20sum%20%3D%20sum%20%2B%20sqrt%28real%28i%29%29%0D%0A%20%20%20%20%20%20%20%20%20end%20do%0D%0A%20%20%20%20%20%20%20%20%20print%20g%2C%20%27SUM%3D%27%2C%20sum%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20call%20system%5Fclock%28finish64%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20time%5Fread%20%3D%20%28finish64%20%2D%20start64%29%2Freal%28count%5Frate64%2C%20wp%29%0D%0A%20%20%20%20%20%20%20%20%20write%20%28%2A%2C%20%27%281x%2Ca%2C1x%2Cg0%2C1x%2Ca%29%27%29%20%27time%20%3A%20%27%2C%20time%5Fread%2C%20%27%20seconds%27%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fsystem%5Fclock%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> system_clock
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_system_clock
      use, intrinsic :: iso_fortran_env, only: wp => real64, int32, int64
      implicit none
      character(len=*), parameter :: g = '(1x,*(g0,1x))'

      integer(kind=int64) :: count64, count_rate64, count_max64
      integer(kind=int64) :: start64, finish64

      integer(kind=int32) :: count32, count_rate32, count_max32
      integer(kind=int32) :: start32, finish32

      real(kind=wp)       :: time_read
      real(kind=wp)       :: sum
      integer             :: i

         print g, 'accuracy may vary with argument type!'

         print g, 'query all arguments'

         call system_clock(count64, count_rate64, count_max64)
         print g, 'COUNT_MAX(64bit)=', count_max64
         print g, 'COUNT_RATE(64bit)=', count_rate64
         print g, 'CURRENT COUNT(64bit)=', count64

         call system_clock(count32, count_rate32, count_max32)
         print g, 'COUNT_MAX(32bit)=', count_max32
         print g, 'COUNT_RATE(32bit)=', count_rate32
         print g, 'CURRENT COUNT(32bit)=', count32

         print g, 'time some computation'
         call system_clock(start64)

         ! some code to time
         sum = 0.0_wp
         do i = -0, huge(0) - 1
            sum = sum + sqrt(real(i))
         end do
         print g, 'SUM=', sum

         call system_clock(finish64)

         time_read = (finish64 - start64)/real(count_rate64, wp)
         write (*, '(1x,a,1x,g0,1x,a)') 'time : ', time_read, ' seconds'

      end program demo_system_clock
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftan%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20real%5Fkinds%2C%20%26%0D%0A%20%20%20%20%20%20%26%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%200%2E165%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2C%20tan%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftan%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> tan
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_tan
      use, intrinsic :: iso_fortran_env, only : real_kinds, &
      & real32, real64, real128
      implicit none
      real(kind=real64) :: x = 0.165_real64
           write(*,*)x, tan(x)
      end program demo_tan
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftanh%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%26%20real%5Fkinds%2C%20real32%2C%20real64%2C%20real128%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20real%28kind%3Dreal64%29%20%3A%3A%20x%20%3D%202%2E1%5Freal64%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29x%2C%20tanh%28x%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftanh%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> tanh
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_tanh
      use, intrinsic :: iso_fortran_env, only : &
      & real_kinds, real32, real64, real128
      implicit none
      real(kind=real64) :: x = 2.1_real64
         write(*,*)x, tanh(x)
      end program demo_tanh
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fthis%5Fimage%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20value%5B%2A%5D%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20value%20%3D%20this%5Fimage%28%29%0D%0A%20%20%20%20%20%20%20%20%20sync%20all%0D%0A%20%20%20%20%20%20%20%20%20if%20%28this%5Fimage%28%29%20%3D%3D%201%29%20then%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20do%20i%20%3D%201%2C%20num%5Fimages%28%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%282%28a%2Ci0%29%29%27%29%20%27value%5B%27%2C%20i%2C%20%27%5D%20is%20%27%2C%20value%5Bi%5D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20end%20do%0D%0A%20%20%20%20%20%20%20%20%20endif%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fthis%5Fimage%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> this_image
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_this_image
      implicit none
      integer :: value[*]
      integer :: i
         value = this_image()
         sync all
         if (this_image() == 1) then
            do i = 1, num_images()
               write(*,'(2(a,i0))') 'value[', i, '] is ', value[i]
            end do
         endif
      end program demo_this_image
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftiny%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27default%20real%20is%20from%27%2C%20tiny%280%2E0%29%2C%20%27to%27%2Chuge%280%2E0%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27doubleprecision%20is%20from%20%27%2C%20tiny%280%2E0d0%29%2C%20%27to%27%2Chuge%280%2E0d0%29%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftiny%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> tiny
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_tiny
      implicit none
         print *, 'default real is from', tiny(0.0), 'to',huge(0.0)
         print *, 'doubleprecision is from ', tiny(0.0d0), 'to',huge(0.0d0)
      end program demo_tiny
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftrailz%0D%0A%0D%0A%20%20%20%20%20%20%21%20some%20common%20integer%20kinds%0D%0A%20%20%20%20%20%20use%2C%20intrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20integer%5Fkinds%2C%20int8%2C%20int16%2C%20int32%2C%20int64%0D%0A%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20%21%20a%20handy%20format%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20show%20%3D%20%27%281x%2C%22value%3D%22%2Ci4%2C%22%2C%20value%28bits%29%3D%22%2Cb32%2E32%2C1x%2C%22%2C%20trailz%3D%22%2Ci3%29%27%0D%0A%0D%0A%20%20%20%20%20%20integer%28kind%3Dint64%29%20%3A%3A%20bigi%0D%0A%20%20%20%20%20%20%20%20%21%20basics%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27Note%20default%20integer%20is%27%2Cbit%5Fsize%280%29%2C%27bits%27%0D%0A%20%20%20%20%20%20%20%20%20print%20%20show%2C%20%20%2D1%2C%20%2D1%2C%20%20trailz%28%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%20show%2C%20%20%200%2C%20%200%2C%20%20trailz%280%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%20show%2C%20%20%201%2C%20%201%2C%20%20trailz%281%29%0D%0A%20%20%20%20%20%20%20%20%20print%20%20show%2C%20%2096%2C%2096%2C%20%20trailz%2896%29%0D%0A%20%20%20%20%20%20%20%20%21%20elemental%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27elemental%20and%20any%20integer%20kind%3A%27%0D%0A%20%20%20%20%20%20%20%20%20bigi%3D2%2A%2A5%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20trailz%28%20%5B%20bigi%2C%20bigi%2A256%2C%20bigi%2F2%20%5D%20%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%281x%2Cb64%2E64%29%27%29%5B%20bigi%2C%20bigi%2A256%2C%20bigi%2F2%20%5D%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftrailz%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> trailz
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_trailz

      ! some common integer kinds
      use, intrinsic :: iso_fortran_env, only : &
       & integer_kinds, int8, int16, int32, int64

      implicit none

      ! a handy format
      character(len=*),parameter :: &
       & show = '(1x,"value=",i4,", value(bits)=",b32.32,1x,", trailz=",i3)'

      integer(kind=int64) :: bigi
        ! basics
         write(*,*)'Note default integer is',bit_size(0),'bits'
         print  show,  -1, -1,  trailz(-1)
         print  show,   0,  0,  trailz(0)
         print  show,   1,  1,  trailz(1)
         print  show,  96, 96,  trailz(96)
        ! elemental
         print *, 'elemental and any integer kind:'
         bigi=2**5
         write(*,*) trailz( [ bigi, bigi*256, bigi/2 ] )
         write(*,'(1x,b64.64)')[ bigi, bigi*256, bigi/2 ]

      end program demo_trailz
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftransfer%0D%0A%20%20%20%20%20%20use%2Cintrinsic%20%3A%3A%20iso%5Ffortran%5Fenv%2C%20only%20%3A%20int32%2C%20real32%0D%0A%20%20%20%20%20%20integer%28kind%3Dint32%29%20%3A%3A%20i%20%3D%202143289344%0D%0A%20%20%20%20%20%20real%28kind%3Dreal32%29%20%20%20%3A%3A%20x%0D%0A%20%20%20%20%20%20character%28len%3D10%29%20%20%20%3A%3A%20string%0D%0A%20%20%20%20%20%20character%28len%3D1%29%20%20%20%20%3A%3A%20chars%2810%29%0D%0A%20%20%20%20%20%20%20%20%20x%3Dtransfer%28i%2C%201%2E0%29%20%20%20%20%21%20prints%20%22nan%22%20on%20i686%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20bit%20patterns%20are%20the%20same%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b0%2C1x%2Cg0%29%27%29x%2Cx%20%21%20create%20a%20NaN%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28b0%2C1x%2Cg0%29%27%29i%2Ci%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20a%20string%20to%20an%20array%20of%20characters%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27abcdefghij%27%0D%0A%20%20%20%20%20%20%20%20%20chars%3Dtransfer%28string%2Cchars%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28%22%5B%22%2Ca%2C%22%5D%22%3A%2C1x%29%29%27%29string%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%2A%28%22%5B%22%2Ca%2C%22%5D%22%3A%2C1x%29%29%27%29chars%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftransfer%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> transfer
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_transfer
      use,intrinsic :: iso_fortran_env, only : int32, real32
      integer(kind=int32) :: i = 2143289344
      real(kind=real32)   :: x
      character(len=10)   :: string
      character(len=1)    :: chars(10)
         x=transfer(i, 1.0)    ! prints "nan" on i686
         ! the bit patterns are the same
         write(*,'(b0,1x,g0)')x,x ! create a NaN
         write(*,'(b0,1x,g0)')i,i

         ! a string to an array of characters
         string='abcdefghij'
         chars=transfer(string,chars)
         write(*,'(*("[",a,"]":,1x))')string
         write(*,'(*("[",a,"]":,1x))')chars
      end program demo_transfer
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftranspose%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Csave%20%3A%3A%20xx%283%2C5%29%3D%20reshape%28%5B%26%0D%0A%20%20%20%20%20%20%20%20%20%201%2C%20%202%2C%20%203%2C%20%204%2C%20%205%2C%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%2010%2C%2020%2C%2030%2C%2040%2C%2050%2C%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%2011%2C%2022%2C%2033%2C%2044%2C%20%2D1055%20%20%26%0D%0A%20%20%20%20%20%20%20%5D%2Cshape%28xx%29%2Corder%3D%5B2%2C1%5D%29%0D%0A%0D%0A%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27xx%20array%3A%27%2Cxx%29%0D%0A%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27xx%20array%20transposed%3A%27%2Ctranspose%28xx%29%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20print%5Fmatrix%5Fint%28title%2Carr%29%0D%0A%20%20%20%20%20%20%21%20print%20small%202d%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29trim%28title%29%20%20%21%20print%20title%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%3E%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20end%20subroutine%20print%5Fmatrix%5Fint%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftranspose%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> transpose
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_transpose
      implicit none
      integer,save :: xx(3,5)= reshape([&
          1,  2,  3,  4,  5,    &
         10, 20, 30, 40, 50,    &
         11, 22, 33, 44, -1055  &
       ],shape(xx),order=[2,1])

      call print_matrix_int('xx array:',xx)
      call print_matrix_int('xx array transposed:',transpose(xx))

      contains

      subroutine print_matrix_int(title,arr)
      ! print small 2d integer arrays in row-column format
      implicit none
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest
         write(*,*)trim(title)  ! print title
         biggest='           '  ! make buffer to write integer into
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='(" > [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo
      end subroutine print_matrix_int

      end program demo_transpose
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Ftrim%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2C%20allocatable%20%3A%3A%20str%2C%20strs%28%3A%29%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cparameter%20%3A%3A%20brackets%3D%27%28%20%2A%28%22%5B%22%2Ca%2C%22%5D%22%3A%2C1x%29%20%29%27%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20str%3D%27%20%20%20trailing%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20str%2Ctrim%28str%29%20%21%20trims%20it%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20str%3D%27%20%20%20leading%27%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20str%2Ctrim%28str%29%20%21%20no%20effect%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20str%3D%27%20%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20str%2Ctrim%28str%29%20%21%20becomes%20zero%20length%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%20len%28str%29%2C%20len%28trim%28%27%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%27%29%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20array%20elements%20are%20all%20the%20same%20length%2C%20so%20you%20often%0D%0A%20%20%20%20%20%20%20%20%21%20want%20to%20print%20them%0D%0A%20%20%20%20%20%20%20%20%20strs%3D%5Bcharacter%28len%3D10%29%20%3A%3A%20%22Z%22%2C%22%20a%20b%20c%22%2C%22ABC%22%2C%22%22%5D%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27untrimmed%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20everything%20prints%20as%20ten%20characters%3B%20nice%20for%20neat%20columns%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20%28strs%28i%29%2C%20i%3D1%2Csize%28strs%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20%28strs%28i%29%2C%20i%3Dsize%28strs%29%2C1%2C%2D1%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27trimmed%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20everything%20prints%20trimmed%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20%28trim%28strs%28i%29%29%2C%20i%3D1%2Csize%28strs%29%29%0D%0A%20%20%20%20%20%20%20%20%20print%20brackets%2C%20%28trim%28strs%28i%29%29%2C%20i%3Dsize%28strs%29%2C1%2C%2D1%29%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Ftrim%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> trim
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_trim
      implicit none
      character(len=:), allocatable :: str, strs(:)
      character(len=*),parameter :: brackets='( *("[",a,"]":,1x) )'
      integer :: i

         str='   trailing    '
         print brackets, str,trim(str) ! trims it

         str='   leading'
         print brackets, str,trim(str) ! no effect

         str='            '
         print brackets, str,trim(str) ! becomes zero length
         print *,  len(str), len(trim('               '))

        ! array elements are all the same length, so you often
        ! want to print them
         strs=[character(len=10) :: "Z"," a b c","ABC",""]

         write(*,*)'untrimmed:'
         ! everything prints as ten characters; nice for neat columns
         print brackets, (strs(i), i=1,size(strs))
         print brackets, (strs(i), i=size(strs),1,-1)
         write(*,*)'trimmed:'
         ! everything prints trimmed
         print brackets, (trim(strs(i)), i=1,size(strs))
         print brackets, (trim(strs(i)), i=size(strs),1,-1)

      end program demo_trim
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20%21%20program%20demo%5Fubound%0D%0A%20%20%20%20%20%20module%20m2%5Fbounds%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20msub%28arr%29%0D%0A%20%20%20%20%20%20%21%21integer%2Cintent%28in%29%20%3A%3A%20arr%28%2A%29%20%20%21%20cannot%20be%20assumed%2Dsize%20array%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27MSUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20end%20subroutine%20msub%0D%0A%0D%0A%20%20%20%20%20%20end%20module%20m2%5Fbounds%0D%0A%20%20%20%20%20%20%21%0D%0A%20%20%20%20%20%20program%20demo%5Fubound%0D%0A%20%20%20%20%20%20use%20m2%5Fbounds%2C%20only%20%3A%20msub%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20interface%0D%0A%20%20%20%20%20%20%20%20%20subroutine%20esub%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20end%20subroutine%20esub%0D%0A%20%20%20%20%20%20end%20interface%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20arr%28%2D10%3A10%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27MAIN%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20call%20csub%28%29%0D%0A%20%20%20%20%20%20%20%20%20call%20msub%28arr%29%0D%0A%20%20%20%20%20%20%20%20%20call%20esub%28arr%29%0D%0A%20%20%20%20%20%20contains%0D%0A%20%20%20%20%20%20subroutine%20csub%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27CSUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20end%20subroutine%20csub%0D%0A%0D%0A%20%20%20%20%20%20end%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20esub%28arr%29%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%3A%3A%20arr%28%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20WARNING%3A%20IF%20CALLED%20WITHOUT%20AN%20EXPLICIT%20INTERFACE%0D%0A%20%20%20%20%20%20%20%20%20%21%20THIS%20WILL%20GIVE%20UNDEFINED%20ANSWERS%20%28like%200%2C0%2C0%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27ESUB%3A%20LOWER%3D%27%2Clbound%28arr%29%2C%27UPPER%3D%27%2Cubound%28arr%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20%27SIZE%3D%27%2Csize%28arr%29%0D%0A%20%20%20%20%20%20end%20subroutine%20esub%0D%0A%20%20%20%20%20%20%21end%20program%20demo%5Fubound%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ubound
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      ! program demo_ubound
      module m2_bounds
      implicit none

      contains

      subroutine msub(arr)
      !!integer,intent(in) :: arr(*)  ! cannot be assumed-size array
      integer,intent(in) :: arr(:)
         write(*,*)'MSUB: LOWER=',lbound(arr),'UPPER=',ubound(arr), &
         & 'SIZE=',size(arr)
      end subroutine msub

      end module m2_bounds
      !
      program demo_ubound
      use m2_bounds, only : msub
      implicit none
      interface
         subroutine esub(arr)
         integer,intent(in) :: arr(:)
         end subroutine esub
      end interface
      integer :: arr(-10:10)
         write(*,*)'MAIN: LOWER=',lbound(arr),'UPPER=',ubound(arr), &
         & 'SIZE=',size(arr)
         call csub()
         call msub(arr)
         call esub(arr)
      contains
      subroutine csub
         write(*,*)'CSUB: LOWER=',lbound(arr),'UPPER=',ubound(arr), &
         & 'SIZE=',size(arr)
      end subroutine csub

      end

      subroutine esub(arr)
      implicit none
      integer,intent(in) :: arr(:)
         ! WARNING: IF CALLED WITHOUT AN EXPLICIT INTERFACE
         ! THIS WILL GIVE UNDEFINED ANSWERS (like 0,0,0)
         write(*,*)'ESUB: LOWER=',lbound(arr),'UPPER=',ubound(arr), &
         & 'SIZE=',size(arr)
      end subroutine esub
      !end program demo_ubound
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> ucobound
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Funpack%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20logical%2Cparameter%20%3A%3A%20T%3D%2Etrue%2E%2C%20F%3D%2Efalse%2E%0D%0A%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20vector%282%29%20%20%3D%20%5B1%2C1%5D%0D%0A%0D%0A%20%20%20%20%20%20%21%20mask%20and%20field%20must%20conform%0D%0A%20%20%20%20%20%20integer%2Cparameter%20%3A%3A%20r%3D2%2C%20c%3D2%0D%0A%20%20%20%20%20%20logical%20%3A%3A%20mask%28r%2Cc%29%20%20%3D%20reshape%28%5B%20T%2CF%2CF%2CT%20%5D%2C%5B2%2C2%5D%29%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20field%28r%2Cc%29%20%3D%200%2C%20unity%282%2C2%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20basic%20usage%0D%0A%20%20%20%20%20%20%20%20%20unity%20%3D%20unpack%28%20vector%2C%20mask%2C%20field%20%29%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27unity%3D%27%2C%20unity%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20if%20FIELD%20is%20a%20scalar%20it%20is%20used%20to%20fill%20all%20the%20elements%0D%0A%20%20%20%20%20%20%20%20%20%21%20not%20assigned%20to%20by%20the%20vector%20and%20mask%2E%0D%0A%20%20%20%20%20%20%20%20%20call%20print%5Fmatrix%5Fint%28%27scalar%20field%27%2C%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20unpack%28%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20vector%3D%5B%201%2C%202%2C%203%2C%204%20%5D%2C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20mask%3Dreshape%28%5B%20T%2CF%2CT%2CF%2CF%2CF%2CT%2CF%2CT%20%5D%2C%20%5B3%2C3%5D%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20field%3D0%29%20%29%0D%0A%0D%0A%20%20%20%20%20%20contains%0D%0A%0D%0A%20%20%20%20%20%20subroutine%20print%5Fmatrix%5Fint%28title%2Carr%29%0D%0A%20%20%20%20%20%20%21%20convenience%20routine%3A%0D%0A%20%20%20%20%20%20%21%20just%20prints%20small%20integer%20arrays%20in%20row%2Dcolumn%20format%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20character%28len%3D%2A%29%2Cintent%28in%29%20%20%3A%3A%20title%0D%0A%20%20%20%20%20%20integer%2Cintent%28in%29%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20arr%28%3A%2C%3A%29%0D%0A%20%20%20%20%20%20integer%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3A%3A%20i%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20biggest%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29trim%28title%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20make%20buffer%20to%20write%20integer%20into%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%20%20%20%20%20%20%20%20%20%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20find%20how%20many%20characters%20to%20use%20for%20integers%0D%0A%20%20%20%20%20%20%20%20%20write%28biggest%2C%27%28i0%29%27%29ceiling%28log10%28max%281%2E0%2Creal%28maxval%28abs%28arr%29%29%29%29%29%29%2B2%0D%0A%20%20%20%20%20%20%20%20%20%21%20use%20this%20format%20to%20write%20a%20row%0D%0A%20%20%20%20%20%20%20%20%20biggest%3D%27%28%22%20%20%5B%22%2C%2A%28i%27%2F%2Ftrim%28biggest%29%2F%2F%27%3A%2C%22%2C%22%29%29%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20print%20one%20row%20of%20array%20at%20a%20time%0D%0A%20%20%20%20%20%20%20%20%20do%20i%3D1%2Csize%28arr%2Cdim%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2Cfmt%3Dbiggest%2Cadvance%3D%27no%27%29arr%28i%2C%3A%29%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20write%28%2A%2C%27%28%22%20%5D%22%29%27%29%0D%0A%20%20%20%20%20%20%20%20%20enddo%0D%0A%20%20%20%20%20%20end%20subroutine%20print%5Fmatrix%5Fint%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Funpack%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> unpack
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_unpack
      implicit none
      logical,parameter :: T=.true., F=.false.

      integer :: vector(2)  = [1,1]

      ! mask and field must conform
      integer,parameter :: r=2, c=2
      logical :: mask(r,c)  = reshape([ T,F,F,T ],[2,2])
      integer :: field(r,c) = 0, unity(2,2)

         ! basic usage
         unity = unpack( vector, mask, field )
         call print_matrix_int('unity=', unity)

         ! if FIELD is a scalar it is used to fill all the elements
         ! not assigned to by the vector and mask.
         call print_matrix_int('scalar field',         &
         & unpack(                                     &
         & vector=[ 1, 2, 3, 4 ],                      &
         & mask=reshape([ T,F,T,F,F,F,T,F,T ], [3,3]), &
         & field=0) )

      contains

      subroutine print_matrix_int(title,arr)
      ! convenience routine:
      ! just prints small integer arrays in row-column format
      implicit none
      character(len=*),intent(in)  :: title
      integer,intent(in)           :: arr(:,:)
      integer                      :: i
      character(len=:),allocatable :: biggest

         write(*,*)trim(title)
         ! make buffer to write integer into
         biggest='           '
         ! find how many characters to use for integers
         write(biggest,'(i0)')ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
         ! use this format to write a row
         biggest='("  [",*(i'//trim(biggest)//':,","))'
         ! print one row of array at a time
         do i=1,size(arr,dim=1)
            write(*,fmt=biggest,advance='no')arr(i,:)
            write(*,'(" ]")')
         enddo
      end subroutine print_matrix_int

      end program demo_unpack
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code=%20%20%20%20%20%20program%20demo%5Fverify%0D%0A%20%20%20%20%20%20implicit%20none%0D%0A%20%20%20%20%20%20%21%20some%20useful%20character%20sets%0D%0A%20%20%20%20%20%20character%2Cparameter%20%3A%3A%20%26%0D%0A%20%20%20%20%20%20%20%26%20int%2A%28%2A%29%20%20%20%3D%20%271234567890%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20low%2A%28%2A%29%20%20%20%3D%20%27abcdefghijklmnopqrstuvwxyz%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20upp%2A%28%2A%29%20%20%20%3D%20%27ABCDEFGHIJKLMNOPQRSTUVWXYZ%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20punc%2A%28%2A%29%20%20%3D%20%22%21%22%22%23%24%25%26%27%28%29%2A%2B%2C%2D%2E%2F%3A%3B%3C%3D%3E%3F%40%5B%5D%5E%5F%60%7B%7C%7D%7E%22%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20blank%2A%28%2A%29%20%3D%20%27%20%27%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20tab%20%20%20%20%20%20%20%3D%20char%2811%29%2C%20%26%0D%0A%20%20%20%20%20%20%20%26%20prnt%2A%28%2A%29%20%3D%20int%2F%2Flow%2F%2Fupp%2F%2Fblank%2F%2Fpunc%0D%0A%0D%0A%20%20%20%20%20%20character%28len%3D%3A%29%2Callocatable%20%3A%3A%20string%0D%0A%20%20%20%20%20%20integer%20%3A%3A%20i%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27basics%3A%27%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20VERIFY%20%28%27ABBA%27%2C%20%27A%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20has%20the%20value%202%2E%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20VERIFY%20%28%27ABBA%27%2C%20%27A%27%2C%20BACK%20%3D%20%2ETRUE%2E%29%20%21%20has%20the%20value%203%2E%0D%0A%20%20%20%20%20%20%20%20%20%20print%20%2A%2C%20VERIFY%20%28%27ABBA%27%2C%20%27AB%27%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%21%20has%20the%20value%200%2E%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27find%20first%20non%2Duppercase%20letter%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20will%20produce%20the%20location%20of%20%22d%22%2C%20because%20there%20is%20no%20match%20in%20UPP%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27something%20unmatched%27%2Cverify%28%22ABCdEFG%22%2C%20upp%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27if%20everything%20is%20matched%20return%20zero%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20will%20produce%200%20as%20all%20letters%20have%20a%20match%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27everything%20matched%27%2Cverify%28%22ffoorrttrraann%22%2C%20%22nartrof%22%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27easily%20categorize%20strings%20as%20uppercase%2C%20lowercase%2C%20%2E%2E%2E%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20easy%20C%2Dlike%20functionality%20but%20does%20entire%20strings%20not%20just%20characters%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isdigit%20123%3F%27%2Cverify%28%22123%22%2C%20int%29%20%3D%3D%200%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27islower%20abc%3F%27%2Cverify%28%22abc%22%2C%20low%29%20%3D%3D%200%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isalpha%20aBc%3F%27%2Cverify%28%22aBc%22%2C%20low%2F%2Fupp%29%20%3D%3D%200%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isblank%20aBc%20dEf%3F%27%2Cverify%28%22aBc%20dEf%22%2C%20blank%2F%2Ftab%20%29%20%2F%3D%200%0D%0A%20%20%20%20%20%20%20%20%20%21%20check%20if%20all%20printable%20characters%0D%0A%20%20%20%20%20%20%20%20%20string%3D%22aB%3Bcde%2CfgHI%21Jklmno%20PQRSTU%20vwxyz%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isprint%3F%27%2Cverify%28string%2Cprnt%29%20%3D%3D%200%0D%0A%20%20%20%20%20%20%20%20%20%21%20this%20now%20has%20a%20nonprintable%20tab%20character%20in%20it%0D%0A%20%20%20%20%20%20%20%20%20string%2810%3A10%29%3Dchar%2811%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isprint%3F%27%2Cverify%28string%2Cprnt%29%20%3D%3D%200%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%27VERIFY%283%29%20is%20very%20powerful%20using%20expressions%20as%20masks%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20verify%283f%29%20is%20often%20used%20in%20a%20logical%20expression%0D%0A%20%20%20%20%20%20%20%20%20string%3D%22%20This%20is%20NOT%20all%20UPPERCASE%20%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27all%20uppercase%2Fspaces%3F%27%2Cverify%28string%2C%20blank%2F%2Fupp%29%20%3D%3D%200%0D%0A%20%20%20%20%20%20%20%20%20string%3D%22%20This%20IS%20all%20uppercase%20%22%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27string%3D%5B%27%2F%2Fstring%2F%2F%27%5D%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27all%20uppercase%2Fspaces%3F%27%2Cverify%28string%2C%20blank%2F%2Fupp%29%20%3D%3D%200%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21%20set%20and%20show%20complex%20string%20to%20be%20tested%0D%0A%20%20%20%20%20%20%20%20%20string%3D%27%20%20Check%20this%20out%2E%20Let%20me%20know%20%20%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20show%20the%20string%20being%20examined%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27string%3D%5B%27%2F%2Fstring%2F%2F%27%5D%27%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27%20%20%20%20%20%20%20%20%27%2F%2Frepeat%28int%2C4%29%20%21%20number%20line%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20the%20Fortran%20functions%20returns%20a%20position%20just%20not%20a%20logical%20like%20C%0D%0A%20%20%20%20%20%20%20%20%20print%20%2A%2C%20%27returning%20a%20position%20not%20just%20a%20logical%20is%20useful%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20which%20can%20be%20very%20useful%20for%20parsing%20strings%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27first%20non%2Dblank%20character%27%2Cverify%28string%2C%20blank%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27last%20non%2Dblank%20character%27%2Cverify%28string%2C%20blank%2Cback%3D%2Etrue%2E%29%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27first%20non%2Dletter%20non%2Dblank%27%2Cverify%28string%2Clow%2F%2Fupp%2F%2Fblank%29%0D%0A%0D%0A%20%20%20%20%20%20%20%20%21VERIFY%283%29%20is%20elemental%20so%20you%20can%20check%20an%20array%20of%20strings%20in%20one%20call%0D%0A%20%20%20%20%20%20%20%20print%20%2A%2C%20%27elemental%27%0D%0A%20%20%20%20%20%20%20%20%20%21%20are%20strings%20all%20letters%20%28or%20blanks%29%3F%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%20%27array%20of%20strings%27%2Cverify%28%20%26%0D%0A%20%20%20%20%20%20%20%20%20%21%20strings%20must%20all%20be%20same%20length%2C%20so%20force%20to%20length%2010%0D%0A%20%20%20%20%20%20%20%20%20%26%20%5Bcharacter%28len%3D10%29%20%3A%3A%20%22YES%22%2C%22ok%22%2C%22000%22%2C%22good%20one%22%2C%22Nope%21%22%5D%2C%20%26%0D%0A%20%20%20%20%20%20%20%20%20%26%20low%2F%2Fupp%2F%2Fblank%29%20%3D%3D%200%0D%0A%0D%0A%20%20%20%20%20%20%20%20%20%21%20rarer%2C%20but%20the%20set%20can%20be%20an%20array%2C%20not%20just%20the%20strings%20to%20test%0D%0A%20%20%20%20%20%20%20%20%20%21%20you%20could%20do%20ISPRINT%28%29%20this%20%28harder%29%20way%20%3A%3E%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isprint%3F%27%2C%2Enot%2Eall%28verify%28%22aBc%22%2C%20%5B%28char%28i%29%2Ci%3D32%2C126%29%5D%29%3D%3D1%29%0D%0A%20%20%20%20%20%20%20%20%20%21%20instead%20of%20this%20way%0D%0A%20%20%20%20%20%20%20%20%20write%28%2A%2C%2A%29%27isprint%3F%27%2Cverify%28%22aBc%22%2Cprnt%29%20%3D%3D%200%0D%0A%0D%0A%20%20%20%20%20%20end%20program%20demo%5Fverify%0D%0A"
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> verify
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
      program demo_verify
      implicit none
      ! some useful character sets
      character,parameter :: &
       & int*(*)   = '1234567890', &
       & low*(*)   = 'abcdefghijklmnopqrstuvwxyz', &
       & upp*(*)   = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', &
       & punc*(*)  = "!""#$%&'()*+,-./:;<=>?@[\]^_`{|}~", &
       & blank*(*) = ' ', &
       & tab       = char(11), &
       & prnt*(*) = int//low//upp//blank//punc

      character(len=:),allocatable :: string
      integer :: i
          print *, 'basics:'
          print *, VERIFY ('ABBA', 'A')                ! has the value 2.
          print *, VERIFY ('ABBA', 'A', BACK = .TRUE.) ! has the value 3.
          print *, VERIFY ('ABBA', 'AB')               ! has the value 0.

         print *,'find first non-uppercase letter'
         ! will produce the location of "d", because there is no match in UPP
         write(*,*) 'something unmatched',verify("ABCdEFG", upp)

         print *,'if everything is matched return zero'
         ! will produce 0 as all letters have a match
         write(*,*) 'everything matched',verify("ffoorrttrraann", "nartrof")

         print *,'easily categorize strings as uppercase, lowercase, ...'
         ! easy C-like functionality but does entire strings not just characters
         write(*,*)'isdigit 123?',verify("123", int) == 0
         write(*,*)'islower abc?',verify("abc", low) == 0
         write(*,*)'isalpha aBc?',verify("aBc", low//upp) == 0
         write(*,*)'isblank aBc dEf?',verify("aBc dEf", blank//tab ) /= 0
         ! check if all printable characters
         string="aB;cde,fgHI!Jklmno PQRSTU vwxyz"
         write(*,*)'isprint?',verify(string,prnt) == 0
         ! this now has a nonprintable tab character in it
         string(10:10)=char(11)
         write(*,*)'isprint?',verify(string,prnt) == 0

         print *,'VERIFY(3) is very powerful using expressions as masks'
         ! verify(3f) is often used in a logical expression
         string=" This is NOT all UPPERCASE "
         write(*,*)'all uppercase/spaces?',verify(string, blank//upp) == 0
         string=" This IS all uppercase "
         write(*,*) 'string=['//string//']'
         write(*,*)'all uppercase/spaces?',verify(string, blank//upp) == 0

        ! set and show complex string to be tested
         string='  Check this out. Let me know  '
         ! show the string being examined
         write(*,*) 'string=['//string//']'
         write(*,*) '        '//repeat(int,4) ! number line

         ! the Fortran functions returns a position just not a logical like C
         print *, 'returning a position not just a logical is useful'
         ! which can be very useful for parsing strings
         write(*,*)'first non-blank character',verify(string, blank)
         write(*,*)'last non-blank character',verify(string, blank,back=.true.)
         write(*,*)'first non-letter non-blank',verify(string,low//upp//blank)

        !VERIFY(3) is elemental so you can check an array of strings in one call
        print *, 'elemental'
         ! are strings all letters (or blanks)?
         write(*,*) 'array of strings',verify( &
         ! strings must all be same length, so force to length 10
         & [character(len=10) :: "YES","ok","000","good one","Nope!"], &
         & low//upp//blank) == 0

         ! rarer, but the set can be an array, not just the strings to test
         ! you could do ISPRINT() this (harder) way :>
         write(*,*)'isprint?',.not.all(verify("aBc", [(char(i),i=32,126)])==1)
         ! instead of this way
         write(*,*)'isprint?',verify("aBc",prnt) == 0

      end program demo_verify
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> wait
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
  <a href="https://play.fortran-lang.org/?code="
  target="_blank" title="Open in Fortran Playground">
  <img src="https://raw.githubusercontent.com/fortran-lang/playground/main/frontend/src/fortran-logo.png"
  alt="Fortran logo" class="align-text-bottom" height="15.5" /> write
  </a>
  <details>
    <summary>Source</summary>
  <xmp>
  </xmp>
  </details>
</body>
</html>
